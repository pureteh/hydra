<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /><title>Hydra.Ledger.Cardano.Evaluate</title><link href="linuwial.css" rel="stylesheet" type="text/css" title="Linuwial" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400i,700" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({ tex2jax: { processClass: "mathjax", ignoreClass: ".*" } });</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><span class="caption">hydra-node-0.11.0: The Hydra node</span><ul class="links" id="page-menu"><li><a href="src/Hydra.Ledger.Cardano.Evaluate.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>Safe-Inferred</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">Hydra.Ledger.Cardano.Evaluate</p></div><div id="table-of-contents"><div id="contents-list"><p class="caption" onclick="window.scrollTo(0,0)">Contents</p><ul><li><a href="#g:1">Evaluate transactions</a></li><li><a href="#g:2">Profile transactions</a></li><li><a href="#g:3">Fixtures</a></li></ul></div></div><div id="description"><p class="caption">Description</p><div class="doc"><p>Simplified interface to phase-2 validation of transactions, eg. evaluation
 of Plutus scripts.</p><p>The <code><a href="Hydra-Ledger-Cardano-Evaluate.html#v:evaluateTx" title="Hydra.Ledger.Cardano.Evaluate">evaluateTx</a></code> function simplifies the call to ledger and plutus providing
 an <code><a href="Hydra-Ledger-Cardano-Evaluate.html#t:EvaluationReport" title="Hydra.Ledger.Cardano.Evaluate">EvaluationReport</a></code> using pre-canned <code>ProtocolParameters</code>. This should only
 be used for <em>testing</em> or <em>benchmarking</em> purpose as the real evaluation
 parameters are set when the Hydra node starts.</p><p><strong>NOTE</strong>: The reason this module is here instead of part of `test/` directory
 is to be used in <code>tx-cost</code> executable.</p></div></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><a href="#v:evaluateTx">evaluateTx</a> :: <a href="Hydra-Ledger-Cardano.html#t:Tx" title="Hydra.Ledger.Cardano">Tx</a> -&gt; UTxO -&gt; <a href="file:///nix/store/bsq0l6l46al1xy42xf3gvwwyys8vdbz1-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/Data-Either.html#t:Either" title="Data.Either">Either</a> <a href="Hydra-Ledger-Cardano-Evaluate.html#t:EvaluationError" title="Hydra.Ledger.Cardano.Evaluate">EvaluationError</a> <a href="Hydra-Ledger-Cardano-Evaluate.html#t:EvaluationReport" title="Hydra.Ledger.Cardano.Evaluate">EvaluationReport</a></li><li class="src short"><a href="#v:evaluateTx-39-">evaluateTx'</a> :: ExecutionUnits -&gt; <a href="Hydra-Ledger-Cardano.html#t:Tx" title="Hydra.Ledger.Cardano">Tx</a> -&gt; UTxO -&gt; <a href="file:///nix/store/bsq0l6l46al1xy42xf3gvwwyys8vdbz1-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/Data-Either.html#t:Either" title="Data.Either">Either</a> <a href="Hydra-Ledger-Cardano-Evaluate.html#t:EvaluationError" title="Hydra.Ledger.Cardano.Evaluate">EvaluationError</a> <a href="Hydra-Ledger-Cardano-Evaluate.html#t:EvaluationReport" title="Hydra.Ledger.Cardano.Evaluate">EvaluationReport</a></li><li class="src short"><a href="#v:checkBudget">checkBudget</a> :: ExecutionUnits -&gt; <a href="Hydra-Ledger-Cardano-Evaluate.html#t:EvaluationReport" title="Hydra.Ledger.Cardano.Evaluate">EvaluationReport</a> -&gt; <a href="file:///nix/store/bsq0l6l46al1xy42xf3gvwwyys8vdbz1-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/Data-Either.html#t:Either" title="Data.Either">Either</a> <a href="Hydra-Ledger-Cardano-Evaluate.html#t:EvaluationError" title="Hydra.Ledger.Cardano.Evaluate">EvaluationError</a> <a href="Hydra-Ledger-Cardano-Evaluate.html#t:EvaluationReport" title="Hydra.Ledger.Cardano.Evaluate">EvaluationReport</a></li><li class="src short"><span class="keyword">data</span> <a href="#t:EvaluationError">EvaluationError</a><ul class="subs"><li>= <a href="#v:TransactionBudgetOverspent">TransactionBudgetOverspent</a> { <ul class="subs"><li><a href="#v:used">used</a> :: ExecutionUnits</li><li><a href="#v:available">available</a> :: ExecutionUnits</li></ul> }</li><li>| <a href="#v:TransactionInvalid">TransactionInvalid</a> TransactionValidityError</li></ul></li><li class="src short"><span class="keyword">type</span> <a href="#t:EvaluationReport">EvaluationReport</a> = Map ScriptWitnessIndex (<a href="file:///nix/store/bsq0l6l46al1xy42xf3gvwwyys8vdbz1-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/Data-Either.html#t:Either" title="Data.Either">Either</a> ScriptExecutionError ExecutionUnits)</li><li class="src short"><a href="#v:renderEvaluationReportFailures">renderEvaluationReportFailures</a> :: <a href="Hydra-Ledger-Cardano-Evaluate.html#t:EvaluationReport" title="Hydra.Ledger.Cardano.Evaluate">EvaluationReport</a> -&gt; Text</li><li class="src short"><a href="#v:usedExecutionUnits">usedExecutionUnits</a> :: <a href="Hydra-Ledger-Cardano-Evaluate.html#t:EvaluationReport" title="Hydra.Ledger.Cardano.Evaluate">EvaluationReport</a> -&gt; ExecutionUnits</li><li class="src short"><a href="#v:estimateMinFee">estimateMinFee</a> :: <a href="Hydra-Ledger-Cardano.html#t:Tx" title="Hydra.Ledger.Cardano">Tx</a> -&gt; <a href="Hydra-Ledger-Cardano-Evaluate.html#t:EvaluationReport" title="Hydra.Ledger.Cardano.Evaluate">EvaluationReport</a> -&gt; Lovelace</li><li class="src short"><a href="#v:prepareTxScripts">prepareTxScripts</a> :: <a href="Hydra-Ledger-Cardano.html#t:Tx" title="Hydra.Ledger.Cardano">Tx</a> -&gt; UTxO -&gt; <a href="file:///nix/store/bsq0l6l46al1xy42xf3gvwwyys8vdbz1-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/Data-Either.html#t:Either" title="Data.Either">Either</a> <a href="file:///nix/store/bsq0l6l46al1xy42xf3gvwwyys8vdbz1-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/Data-String.html#t:String" title="Data.String">String</a> [ByteString]</li><li class="src short"><a href="#v:pparams">pparams</a> :: ProtocolParameters</li><li class="src short"><a href="#v:maxTxSize">maxTxSize</a> :: <a href="file:///nix/store/bsq0l6l46al1xy42xf3gvwwyys8vdbz1-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/Numeric-Natural.html#t:Natural" title="Numeric.Natural">Natural</a></li><li class="src short"><a href="#v:maxTxExecutionUnits">maxTxExecutionUnits</a> :: ExecutionUnits</li><li class="src short"><a href="#v:maxMem">maxMem</a> :: <a href="file:///nix/store/bsq0l6l46al1xy42xf3gvwwyys8vdbz1-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/Numeric-Natural.html#t:Natural" title="Numeric.Natural">Natural</a></li><li class="src short"><a href="#v:maxCpu">maxCpu</a> :: <a href="file:///nix/store/bsq0l6l46al1xy42xf3gvwwyys8vdbz1-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/Numeric-Natural.html#t:Natural" title="Numeric.Natural">Natural</a></li><li class="src short"><a href="#v:epochInfo">epochInfo</a> :: <a href="file:///nix/store/bsq0l6l46al1xy42xf3gvwwyys8vdbz1-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; EpochInfo m</li><li class="src short"><a href="#v:eraHistoryWithHorizonAt">eraHistoryWithHorizonAt</a> :: SlotNo -&gt; EraHistory CardanoMode</li><li class="src short"><a href="#v:epochSize">epochSize</a> :: EpochSize</li><li class="src short"><a href="#v:slotLength">slotLength</a> :: SlotLength</li><li class="src short"><a href="#v:systemStart">systemStart</a> :: SystemStart</li><li class="src short"><a href="#v:genPointInTime">genPointInTime</a> :: Gen (SlotNo, UTCTime)</li><li class="src short"><a href="#v:genValidityBoundsFromContestationPeriod">genValidityBoundsFromContestationPeriod</a> :: <a href="Hydra-ContestationPeriod.html#t:ContestationPeriod" title="Hydra.ContestationPeriod">ContestationPeriod</a> -&gt; Gen (SlotNo, (SlotNo, UTCTime))</li><li class="src short"><a href="#v:genPointInTimeBefore">genPointInTimeBefore</a> :: UTCTime -&gt; Gen (SlotNo, UTCTime)</li><li class="src short"><a href="#v:genPointInTimeAfter">genPointInTimeAfter</a> :: UTCTime -&gt; Gen (SlotNo, UTCTime)</li><li class="src short"><a href="#v:slotNoFromUTCTime">slotNoFromUTCTime</a> :: UTCTime -&gt; SlotNo</li><li class="src short"><a href="#v:slotNoToUTCTime">slotNoToUTCTime</a> :: <a href="file:///nix/store/bsq0l6l46al1xy42xf3gvwwyys8vdbz1-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/GHC-Stack.html#t:HasCallStack" title="GHC.Stack">HasCallStack</a> =&gt; SlotNo -&gt; UTCTime</li></ul></details></div><div id="interface"><a href="#g:1" id="g:1"><h1>Evaluate transactions</h1></a><div class="top"><p class="src"><a id="v:evaluateTx" class="def">evaluateTx</a> :: <a href="Hydra-Ledger-Cardano.html#t:Tx" title="Hydra.Ledger.Cardano">Tx</a> -&gt; UTxO -&gt; <a href="file:///nix/store/bsq0l6l46al1xy42xf3gvwwyys8vdbz1-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/Data-Either.html#t:Either" title="Data.Either">Either</a> <a href="Hydra-Ledger-Cardano-Evaluate.html#t:EvaluationError" title="Hydra.Ledger.Cardano.Evaluate">EvaluationError</a> <a href="Hydra-Ledger-Cardano-Evaluate.html#t:EvaluationReport" title="Hydra.Ledger.Cardano.Evaluate">EvaluationReport</a> <a href="src/Hydra.Ledger.Cardano.Evaluate.html#evaluateTx" class="link">Source</a> <a href="#v:evaluateTx" class="selflink">#</a></p><div class="doc"><p>Thin wrapper around <code>evaluateTransactionExecutionUnits</code>, using fixtures
 from this module for <code><a href="Hydra-Ledger-Cardano-Evaluate.html#v:systemStart" title="Hydra.Ledger.Cardano.Evaluate">systemStart</a></code>, <code>eraHistory</code> and <code><a href="Hydra-Ledger-Cardano-Evaluate.html#v:pparams" title="Hydra.Ledger.Cardano.Evaluate">pparams</a></code>.</p><p>Additionally, this function checks the overall execution units are not
 exceeding <code><a href="Hydra-Ledger-Cardano-Evaluate.html#v:maxTxExecutionUnits" title="Hydra.Ledger.Cardano.Evaluate">maxTxExecutionUnits</a></code>.</p></div></div><div class="top"><p class="src"><a id="v:evaluateTx-39-" class="def">evaluateTx'</a> <a href="src/Hydra.Ledger.Cardano.Evaluate.html#evaluateTx%27" class="link">Source</a> <a href="#v:evaluateTx-39-" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: ExecutionUnits</td><td class="doc"><p>Max tx execution units.</p></td></tr><tr><td class="src">-&gt; <a href="Hydra-Ledger-Cardano.html#t:Tx" title="Hydra.Ledger.Cardano">Tx</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">-&gt; UTxO</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">-&gt; <a href="file:///nix/store/bsq0l6l46al1xy42xf3gvwwyys8vdbz1-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/Data-Either.html#t:Either" title="Data.Either">Either</a> <a href="Hydra-Ledger-Cardano-Evaluate.html#t:EvaluationError" title="Hydra.Ledger.Cardano.Evaluate">EvaluationError</a> <a href="Hydra-Ledger-Cardano-Evaluate.html#t:EvaluationReport" title="Hydra.Ledger.Cardano.Evaluate">EvaluationReport</a></td><td class="doc empty">&nbsp;</td></tr></table></div><div class="doc"><p>Like <code><a href="Hydra-Ledger-Cardano-Evaluate.html#v:evaluateTx" title="Hydra.Ledger.Cardano.Evaluate">evaluateTx</a></code>, but with a configurable maximum transaction
 <code>ExecutionUnits</code>.</p></div></div><div class="top"><p class="src"><a id="v:checkBudget" class="def">checkBudget</a> :: ExecutionUnits -&gt; <a href="Hydra-Ledger-Cardano-Evaluate.html#t:EvaluationReport" title="Hydra.Ledger.Cardano.Evaluate">EvaluationReport</a> -&gt; <a href="file:///nix/store/bsq0l6l46al1xy42xf3gvwwyys8vdbz1-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/Data-Either.html#t:Either" title="Data.Either">Either</a> <a href="Hydra-Ledger-Cardano-Evaluate.html#t:EvaluationError" title="Hydra.Ledger.Cardano.Evaluate">EvaluationError</a> <a href="Hydra-Ledger-Cardano-Evaluate.html#t:EvaluationReport" title="Hydra.Ledger.Cardano.Evaluate">EvaluationReport</a> <a href="src/Hydra.Ledger.Cardano.Evaluate.html#checkBudget" class="link">Source</a> <a href="#v:checkBudget" class="selflink">#</a></p><div class="doc"><p>Check the budget used by provided <code><a href="Hydra-Ledger-Cardano-Evaluate.html#t:EvaluationReport" title="Hydra.Ledger.Cardano.Evaluate">EvaluationReport</a></code> does not exceed given
 maximum <code>ExecutionUnits</code>.</p></div></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:EvaluationError" class="def">EvaluationError</a> <a href="src/Hydra.Ledger.Cardano.Evaluate.html#EvaluationError" class="link">Source</a> <a href="#t:EvaluationError" class="selflink">#</a></p><div class="doc"><p>Errors returned by <code><a href="Hydra-Ledger-Cardano-Evaluate.html#v:evaluateTx" title="Hydra.Ledger.Cardano.Evaluate">evaluateTx</a></code> extending the upstream
 <code>TransactionValidityError</code> with additional cases.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:TransactionBudgetOverspent" class="def">TransactionBudgetOverspent</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><ul><li><dfn class="src"><a id="v:used" class="def">used</a> :: ExecutionUnits</dfn><div class="doc empty">&nbsp;</div></li><li><dfn class="src"><a id="v:available" class="def">available</a> :: ExecutionUnits</dfn><div class="doc empty">&nbsp;</div></li></ul></div></td></tr><tr><td class="src"><a id="v:TransactionInvalid" class="def">TransactionInvalid</a> TransactionValidityError</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="subs instances"><h4 class="instances details-toggle-control details-toggle" data-details-id="i:EvaluationError">Instances</h4><details id="i:EvaluationError" open="open"><summary class="hide-when-js-enabled">Instances details</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:EvaluationError:Show:1"></span> <a href="file:///nix/store/bsq0l6l46al1xy42xf3gvwwyys8vdbz1-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/Text-Show.html#t:Show" title="Text.Show">Show</a> <a href="Hydra-Ledger-Cardano-Evaluate.html#t:EvaluationError" title="Hydra.Ledger.Cardano.Evaluate">EvaluationError</a></span> <a href="src/Hydra.Ledger.Cardano.Evaluate.html#line-150" class="link">Source</a> <a href="#t:EvaluationError" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:EvaluationError:Show:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Hydra-Ledger-Cardano-Evaluate.html">Hydra.Ledger.Cardano.Evaluate</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> :: <a href="file:///nix/store/bsq0l6l46al1xy42xf3gvwwyys8vdbz1-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/Data-Int.html#t:Int" title="Data.Int">Int</a> -&gt; <a href="Hydra-Ledger-Cardano-Evaluate.html#t:EvaluationError" title="Hydra.Ledger.Cardano.Evaluate">EvaluationError</a> -&gt; <a href="file:///nix/store/bsq0l6l46al1xy42xf3gvwwyys8vdbz1-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/Text-Show.html#t:ShowS" title="Text.Show">ShowS</a> <a href="file:///nix/store/bsq0l6l46al1xy42xf3gvwwyys8vdbz1-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src" class="link">Source</a> <a href="#v:showsPrec" class="selflink">#</a></p><p class="src"><a href="#v:show">show</a> :: <a href="Hydra-Ledger-Cardano-Evaluate.html#t:EvaluationError" title="Hydra.Ledger.Cardano.Evaluate">EvaluationError</a> -&gt; <a href="file:///nix/store/bsq0l6l46al1xy42xf3gvwwyys8vdbz1-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/Data-String.html#t:String" title="Data.String">String</a> <a href="file:///nix/store/bsq0l6l46al1xy42xf3gvwwyys8vdbz1-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src" class="link">Source</a> <a href="#v:show" class="selflink">#</a></p><p class="src"><a href="#v:showList">showList</a> :: [<a href="Hydra-Ledger-Cardano-Evaluate.html#t:EvaluationError" title="Hydra.Ledger.Cardano.Evaluate">EvaluationError</a>] -&gt; <a href="file:///nix/store/bsq0l6l46al1xy42xf3gvwwyys8vdbz1-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/Text-Show.html#t:ShowS" title="Text.Show">ShowS</a> <a href="file:///nix/store/bsq0l6l46al1xy42xf3gvwwyys8vdbz1-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/src" class="link">Source</a> <a href="#v:showList" class="selflink">#</a></p></div></details></td></tr></table></details></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a id="t:EvaluationReport" class="def">EvaluationReport</a> = Map ScriptWitnessIndex (<a href="file:///nix/store/bsq0l6l46al1xy42xf3gvwwyys8vdbz1-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/Data-Either.html#t:Either" title="Data.Either">Either</a> ScriptExecutionError ExecutionUnits) <a href="src/Hydra.Ledger.Cardano.Evaluate.html#EvaluationReport" class="link">Source</a> <a href="#t:EvaluationReport" class="selflink">#</a></p><div class="doc"><p>Evaluation result for each of the included scripts. Either they failed
 evaluation or used a number of <code>ExecutionUnits</code>.</p></div></div><div class="top"><p class="src"><a id="v:renderEvaluationReportFailures" class="def">renderEvaluationReportFailures</a> :: <a href="Hydra-Ledger-Cardano-Evaluate.html#t:EvaluationReport" title="Hydra.Ledger.Cardano.Evaluate">EvaluationReport</a> -&gt; Text <a href="src/Hydra.Ledger.Cardano.Evaluate.html#renderEvaluationReportFailures" class="link">Source</a> <a href="#v:renderEvaluationReportFailures" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:usedExecutionUnits" class="def">usedExecutionUnits</a> :: <a href="Hydra-Ledger-Cardano-Evaluate.html#t:EvaluationReport" title="Hydra.Ledger.Cardano.Evaluate">EvaluationReport</a> -&gt; ExecutionUnits <a href="src/Hydra.Ledger.Cardano.Evaluate.html#usedExecutionUnits" class="link">Source</a> <a href="#v:usedExecutionUnits" class="selflink">#</a></p><div class="doc"><p>Get the total used <code>ExecutionUnits</code> from an <code><a href="Hydra-Ledger-Cardano-Evaluate.html#t:EvaluationReport" title="Hydra.Ledger.Cardano.Evaluate">EvaluationReport</a></code>. Useful to
 further process the result of <code><a href="Hydra-Ledger-Cardano-Evaluate.html#v:evaluateTx" title="Hydra.Ledger.Cardano.Evaluate">evaluateTx</a></code>.</p></div></div><div class="top"><p class="src"><a id="v:estimateMinFee" class="def">estimateMinFee</a> :: <a href="Hydra-Ledger-Cardano.html#t:Tx" title="Hydra.Ledger.Cardano">Tx</a> -&gt; <a href="Hydra-Ledger-Cardano-Evaluate.html#t:EvaluationReport" title="Hydra.Ledger.Cardano.Evaluate">EvaluationReport</a> -&gt; Lovelace <a href="src/Hydra.Ledger.Cardano.Evaluate.html#estimateMinFee" class="link">Source</a> <a href="#v:estimateMinFee" class="selflink">#</a></p><div class="doc"><p>Estimate minimum fee for given transaction and evaluated redeemers. Instead
 of using the budgets from the transaction (which are usually set to 0 until
 balancing), this directly computes the fee from transaction size and the
 units of the <code><a href="Hydra-Ledger-Cardano-Evaluate.html#t:EvaluationReport" title="Hydra.Ledger.Cardano.Evaluate">EvaluationReport</a></code>. Note that this function only provides a
 rough estimate using this modules' <code><a href="Hydra-Ledger-Cardano-Evaluate.html#v:pparams" title="Hydra.Ledger.Cardano.Evaluate">pparams</a></code> and likely under-estimates cost
 as we have no witnesses on this <code><a href="Hydra-Ledger-Cardano.html#t:Tx" title="Hydra.Ledger.Cardano">Tx</a></code>.</p></div></div><a href="#g:2" id="g:2"><h1>Profile transactions</h1></a><div class="top"><p class="src"><a id="v:prepareTxScripts" class="def">prepareTxScripts</a> :: <a href="Hydra-Ledger-Cardano.html#t:Tx" title="Hydra.Ledger.Cardano">Tx</a> -&gt; UTxO -&gt; <a href="file:///nix/store/bsq0l6l46al1xy42xf3gvwwyys8vdbz1-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/Data-Either.html#t:Either" title="Data.Either">Either</a> <a href="file:///nix/store/bsq0l6l46al1xy42xf3gvwwyys8vdbz1-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/Data-String.html#t:String" title="Data.String">String</a> [ByteString] <a href="src/Hydra.Ledger.Cardano.Evaluate.html#prepareTxScripts" class="link">Source</a> <a href="#v:prepareTxScripts" class="selflink">#</a></p><div class="doc"><p>Like <code><a href="Hydra-Ledger-Cardano-Evaluate.html#v:evaluateTx" title="Hydra.Ledger.Cardano.Evaluate">evaluateTx</a></code>, but instead of actual evaluation, return the
 flat-encoded, fully applied scripts for each redeemer to be evaluated
 externally by <code>uplc</code>. Use input format &quot;flat-namedDeBruijn&quot;. This can be used
 to gather profiling information.</p><p>NOTE: This assumes we use <code>Babbage</code> and only <code>PlutusV2</code> scripts are used.</p></div></div><a href="#g:3" id="g:3"><h1>Fixtures</h1></a><div class="top"><p class="src"><a id="v:pparams" class="def">pparams</a> :: ProtocolParameters <a href="src/Hydra.Ledger.Cardano.Evaluate.html#pparams" class="link">Source</a> <a href="#v:pparams" class="selflink">#</a></p><div class="doc"><p>Current (2023-04-12) mainchain protocol parameters.
 XXX: Avoid specifiying not required parameters here (e.g. max block units
 should not matter).
 XXX: Load and use mainnet parameters from a file which we can easily review
 to be in sync with mainnet.</p></div></div><div class="top"><p class="src"><a id="v:maxTxSize" class="def">maxTxSize</a> :: <a href="file:///nix/store/bsq0l6l46al1xy42xf3gvwwyys8vdbz1-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/Numeric-Natural.html#t:Natural" title="Numeric.Natural">Natural</a> <a href="src/Hydra.Ledger.Cardano.Evaluate.html#maxTxSize" class="link">Source</a> <a href="#v:maxTxSize" class="selflink">#</a></p><div class="doc"><p>Max transaction size of the current <code><a href="Hydra-Ledger-Cardano-Evaluate.html#v:pparams" title="Hydra.Ledger.Cardano.Evaluate">pparams</a></code>.</p></div></div><div class="top"><p class="src"><a id="v:maxTxExecutionUnits" class="def">maxTxExecutionUnits</a> :: ExecutionUnits <a href="src/Hydra.Ledger.Cardano.Evaluate.html#maxTxExecutionUnits" class="link">Source</a> <a href="#v:maxTxExecutionUnits" class="selflink">#</a></p><div class="doc"><p>Max transaction execution unit budget of the current <code><a href="Hydra-Ledger-Cardano-Evaluate.html#v:pparams" title="Hydra.Ledger.Cardano.Evaluate">pparams</a></code>.</p></div></div><div class="top"><p class="src"><a id="v:maxMem" class="def">maxMem</a> :: <a href="file:///nix/store/bsq0l6l46al1xy42xf3gvwwyys8vdbz1-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/Numeric-Natural.html#t:Natural" title="Numeric.Natural">Natural</a> <a href="src/Hydra.Ledger.Cardano.Evaluate.html#maxMem" class="link">Source</a> <a href="#v:maxMem" class="selflink">#</a></p><div class="doc"><p>Max memory and cpu units of the current <code><a href="Hydra-Ledger-Cardano-Evaluate.html#v:pparams" title="Hydra.Ledger.Cardano.Evaluate">pparams</a></code>.</p></div></div><div class="top"><p class="src"><a id="v:maxCpu" class="def">maxCpu</a> :: <a href="file:///nix/store/bsq0l6l46al1xy42xf3gvwwyys8vdbz1-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/Numeric-Natural.html#t:Natural" title="Numeric.Natural">Natural</a> <a href="src/Hydra.Ledger.Cardano.Evaluate.html#maxCpu" class="link">Source</a> <a href="#v:maxCpu" class="selflink">#</a></p><div class="doc"><p>Max memory and cpu units of the current <code><a href="Hydra-Ledger-Cardano-Evaluate.html#v:pparams" title="Hydra.Ledger.Cardano.Evaluate">pparams</a></code>.</p></div></div><div class="top"><p class="src"><a id="v:epochInfo" class="def">epochInfo</a> :: <a href="file:///nix/store/bsq0l6l46al1xy42xf3gvwwyys8vdbz1-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/Control-Monad.html#t:Monad" title="Control.Monad">Monad</a> m =&gt; EpochInfo m <a href="src/Hydra.Ledger.Cardano.Evaluate.html#epochInfo" class="link">Source</a> <a href="#v:epochInfo" class="selflink">#</a></p><div class="doc"><p>An artifical <code>EpochInfo</code> comprised by a single never ending (forking) era,
 with fixed <code><a href="Hydra-Ledger-Cardano-Evaluate.html#v:epochSize" title="Hydra.Ledger.Cardano.Evaluate">epochSize</a></code> and <code><a href="Hydra-Ledger-Cardano-Evaluate.html#v:slotLength" title="Hydra.Ledger.Cardano.Evaluate">slotLength</a></code>.</p></div></div><div class="top"><p class="src"><a id="v:eraHistoryWithHorizonAt" class="def">eraHistoryWithHorizonAt</a> :: SlotNo -&gt; EraHistory CardanoMode <a href="src/Hydra.Ledger.Cardano.Evaluate.html#eraHistoryWithHorizonAt" class="link">Source</a> <a href="#v:eraHistoryWithHorizonAt" class="selflink">#</a></p><div class="doc"><p>An era history with a single era which will end at some point.</p><p>A &quot;real&quot; <code>EraHistory</code> received from the cardano-node will have the <code>eraEnd</code>
 at a known or earliest possible end of the current era + a safe zone.</p><p>See <code>EraParams</code> for details.</p><p>NOTE: This era is using not so realistic epoch sizes of 1 and sets a slot
 length of 1</p></div></div><div class="top"><p class="src"><a id="v:epochSize" class="def">epochSize</a> :: EpochSize <a href="src/Hydra.Ledger.Cardano.Evaluate.html#epochSize" class="link">Source</a> <a href="#v:epochSize" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:slotLength" class="def">slotLength</a> :: SlotLength <a href="src/Hydra.Ledger.Cardano.Evaluate.html#slotLength" class="link">Source</a> <a href="#v:slotLength" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:systemStart" class="def">systemStart</a> :: SystemStart <a href="src/Hydra.Ledger.Cardano.Evaluate.html#systemStart" class="link">Source</a> <a href="#v:systemStart" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:genPointInTime" class="def">genPointInTime</a> :: Gen (SlotNo, UTCTime) <a href="src/Hydra.Ledger.Cardano.Evaluate.html#genPointInTime" class="link">Source</a> <a href="#v:genPointInTime" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:genValidityBoundsFromContestationPeriod" class="def">genValidityBoundsFromContestationPeriod</a> :: <a href="Hydra-ContestationPeriod.html#t:ContestationPeriod" title="Hydra.ContestationPeriod">ContestationPeriod</a> -&gt; Gen (SlotNo, (SlotNo, UTCTime)) <a href="src/Hydra.Ledger.Cardano.Evaluate.html#genValidityBoundsFromContestationPeriod" class="link">Source</a> <a href="#v:genValidityBoundsFromContestationPeriod" class="selflink">#</a></p><div class="doc"><p>Parameter here is the contestation period (cp) so we need to generate
 start (tMin) and end (tMax) tx validity bound such that their difference
 is not higher than the cp.
 Returned slots are tx validity bounds</p></div></div><div class="top"><p class="src"><a id="v:genPointInTimeBefore" class="def">genPointInTimeBefore</a> :: UTCTime -&gt; Gen (SlotNo, UTCTime) <a href="src/Hydra.Ledger.Cardano.Evaluate.html#genPointInTimeBefore" class="link">Source</a> <a href="#v:genPointInTimeBefore" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:genPointInTimeAfter" class="def">genPointInTimeAfter</a> :: UTCTime -&gt; Gen (SlotNo, UTCTime) <a href="src/Hydra.Ledger.Cardano.Evaluate.html#genPointInTimeAfter" class="link">Source</a> <a href="#v:genPointInTimeAfter" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:slotNoFromUTCTime" class="def">slotNoFromUTCTime</a> :: UTCTime -&gt; SlotNo <a href="src/Hydra.Ledger.Cardano.Evaluate.html#slotNoFromUTCTime" class="link">Source</a> <a href="#v:slotNoFromUTCTime" class="selflink">#</a></p><div class="doc"><p>Using hard-coded systemStart and slotLength, do not use in production!</p></div></div><div class="top"><p class="src"><a id="v:slotNoToUTCTime" class="def">slotNoToUTCTime</a> :: <a href="file:///nix/store/bsq0l6l46al1xy42xf3gvwwyys8vdbz1-ghc-9.2.7-doc/share/doc/ghc/html/libraries/base-4.16.4.0/GHC-Stack.html#t:HasCallStack" title="GHC.Stack">HasCallStack</a> =&gt; SlotNo -&gt; UTCTime <a href="src/Hydra.Ledger.Cardano.Evaluate.html#slotNoToUTCTime" class="link">Source</a> <a href="#v:slotNoToUTCTime" class="selflink">#</a></p><div class="doc"><p>Using hard-coded defaults above. Fails for slots past epoch boundaries.</p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.26.0</p></div></body></html>