<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE DeriveAnyClass #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE DerivingStrategies #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE DuplicateRecordFields #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE GeneralizedNewtypeDeriving #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE TypeApplications #-}</span><span>
</span><span id="line-6"></span><span>
</span><span id="line-7"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">CardanoNode</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-8"></span><span>
</span><span id="line-9"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Hydra.Prelude</span></span><span>
</span><span id="line-10"></span><span>
</span><span id="line-11"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Lens</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">(^?!)</span></span><span class="hs-special">)</span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Tracer</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Tracer</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">traceWith</span></span><span class="hs-special">)</span><span>
</span><span id="line-13"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Aeson</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">(.=)</span></span><span class="hs-special">)</span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Aeson</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Aeson</span></span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Aeson.KeyMap</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Aeson.KeyMap</span></span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Aeson.Lens</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">key</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">_Number</span></span><span class="hs-special">)</span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Data.Fixed</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">Centi</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Time.Clock.POSIX</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">posixSecondsToUTCTime</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">utcTimeToPOSIXSeconds</span></span><span class="hs-special">)</span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Hydra.Cardano.Api</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">AsType</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">AsPaymentKey</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">NetworkId</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">PaymentKey</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">SigningKey</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">VerificationKey</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">generateSigningKey</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">getVerificationKey</span></span><span class="hs-special">)</span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Hydra.Cardano.Api</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Api</span></span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hydra.Cluster.Fixture.html"><span class="hs-identifier">Hydra.Cluster.Fixture</span></a></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-22"></span><span>  </span><span class="annot"><a href="Hydra.Cluster.Fixture.html#KnownNetwork"><span class="hs-identifier">KnownNetwork</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hydra.Cluster.Fixture.html#Mainnet"><span class="hs-identifier">Mainnet</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hydra.Cluster.Fixture.html#Preproduction"><span class="hs-identifier">Preproduction</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hydra.Cluster.Fixture.html#Preview"><span class="hs-identifier">Preview</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-23"></span><span>  </span><span class="annot"><a href="Hydra.Cluster.Fixture.html#defaultNetworkId"><span class="hs-identifier">defaultNetworkId</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-24"></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Hydra.Cluster.Util.html"><span class="hs-identifier">Hydra.Cluster.Util</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Hydra.Cluster.Util.html#readConfigFile"><span class="hs-identifier">readConfigFile</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.Directory</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">createDirectoryIfMissing</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">doesFileExist</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">removeFile</span></span><span class="hs-special">)</span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">System.Exit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier">ExitCode</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.FilePath</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">takeDirectory</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(&lt;/&gt;)</span></span><span class="hs-special">)</span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.Posix</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ownerReadMode</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">setFileMode</span></span><span class="hs-special">)</span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.Process</span></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-31"></span><span>  </span><span class="annot"><span class="hs-identifier">CreateProcess</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-32"></span><span>  </span><span class="annot"><span class="hs-identifier">StdStream</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">UseHandle</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-33"></span><span>  </span><span class="annot"><span class="hs-identifier">proc</span></span><span class="hs-special">,</span><span>
</span><span id="line-34"></span><span>  </span><span class="annot"><span class="hs-identifier">readProcess</span></span><span class="hs-special">,</span><span>
</span><span id="line-35"></span><span>  </span><span class="annot"><span class="hs-identifier">withCreateProcess</span></span><span class="hs-special">,</span><span>
</span><span id="line-36"></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Test.Hydra.Prelude</span></span><span>
</span><span id="line-38"></span><span>
</span><span id="line-39"></span><span class="hs-keyword">type</span><span> </span><span id="Port"><span class="annot"><a href="CardanoNode.html#Port"><span class="hs-identifier hs-var">Port</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-40"></span><span>
</span><span id="line-41"></span><span class="hs-keyword">newtype</span><span> </span><span id="NodeId"><span class="annot"><a href="CardanoNode.html#NodeId"><span class="hs-identifier hs-var">NodeId</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="NodeId"><span class="annot"><a href="CardanoNode.html#NodeId"><span class="hs-identifier hs-var">NodeId</span></a></span></span><span> </span><span class="annot"><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-42"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">newtype</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679328076"><span id="local-6989586621679328078"><span class="annot"><span class="annottext">NodeId -&gt; NodeId -&gt; Bool
(NodeId -&gt; NodeId -&gt; Bool)
-&gt; (NodeId -&gt; NodeId -&gt; Bool) -&gt; Eq NodeId
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: NodeId -&gt; NodeId -&gt; Bool
$c/= :: NodeId -&gt; NodeId -&gt; Bool
== :: NodeId -&gt; NodeId -&gt; Bool
$c== :: NodeId -&gt; NodeId -&gt; Bool
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679328069"><span id="local-6989586621679328071"><span id="local-6989586621679328073"><span class="annot"><span class="annottext">Int -&gt; NodeId -&gt; ShowS
[NodeId] -&gt; ShowS
NodeId -&gt; String
(Int -&gt; NodeId -&gt; ShowS)
-&gt; (NodeId -&gt; String) -&gt; ([NodeId] -&gt; ShowS) -&gt; Show NodeId
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [NodeId] -&gt; ShowS
$cshowList :: [NodeId] -&gt; ShowS
show :: NodeId -&gt; String
$cshow :: NodeId -&gt; String
showsPrec :: Int -&gt; NodeId -&gt; ShowS
$cshowsPrec :: Int -&gt; NodeId -&gt; ShowS
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679328054"><span id="local-6989586621679328056"><span id="local-6989586621679328058"><span id="local-6989586621679328060"><span id="local-6989586621679328062"><span id="local-6989586621679328064"><span id="local-6989586621679328066"><span class="annot"><span class="annottext">Integer -&gt; NodeId
NodeId -&gt; NodeId
NodeId -&gt; NodeId -&gt; NodeId
(NodeId -&gt; NodeId -&gt; NodeId)
-&gt; (NodeId -&gt; NodeId -&gt; NodeId)
-&gt; (NodeId -&gt; NodeId -&gt; NodeId)
-&gt; (NodeId -&gt; NodeId)
-&gt; (NodeId -&gt; NodeId)
-&gt; (NodeId -&gt; NodeId)
-&gt; (Integer -&gt; NodeId)
-&gt; Num NodeId
forall a.
(a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (Integer -&gt; a)
-&gt; Num a
fromInteger :: Integer -&gt; NodeId
$cfromInteger :: Integer -&gt; NodeId
signum :: NodeId -&gt; NodeId
$csignum :: NodeId -&gt; NodeId
abs :: NodeId -&gt; NodeId
$cabs :: NodeId -&gt; NodeId
negate :: NodeId -&gt; NodeId
$cnegate :: NodeId -&gt; NodeId
* :: NodeId -&gt; NodeId -&gt; NodeId
$c* :: NodeId -&gt; NodeId -&gt; NodeId
- :: NodeId -&gt; NodeId -&gt; NodeId
$c- :: NodeId -&gt; NodeId -&gt; NodeId
+ :: NodeId -&gt; NodeId -&gt; NodeId
$c+ :: NodeId -&gt; NodeId -&gt; NodeId
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Num</span></a></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679328045"><span id="local-6989586621679328047"><span id="local-6989586621679328049"><span id="local-6989586621679328051"><span class="annot"><span class="annottext">[NodeId] -&gt; Value
[NodeId] -&gt; Encoding
NodeId -&gt; Value
NodeId -&gt; Encoding
(NodeId -&gt; Value)
-&gt; (NodeId -&gt; Encoding)
-&gt; ([NodeId] -&gt; Value)
-&gt; ([NodeId] -&gt; Encoding)
-&gt; ToJSON NodeId
forall a.
(a -&gt; Value)
-&gt; (a -&gt; Encoding)
-&gt; ([a] -&gt; Value)
-&gt; ([a] -&gt; Encoding)
-&gt; ToJSON a
toEncodingList :: [NodeId] -&gt; Encoding
$ctoEncodingList :: [NodeId] -&gt; Encoding
toJSONList :: [NodeId] -&gt; Value
$ctoJSONList :: [NodeId] -&gt; Value
toEncoding :: NodeId -&gt; Encoding
$ctoEncoding :: NodeId -&gt; Encoding
toJSON :: NodeId -&gt; Value
$ctoJSON :: NodeId -&gt; Value
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">ToJSON</span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679328040"><span id="local-6989586621679328042"><span class="annot"><span class="annottext">Value -&gt; Parser [NodeId]
Value -&gt; Parser NodeId
(Value -&gt; Parser NodeId)
-&gt; (Value -&gt; Parser [NodeId]) -&gt; FromJSON NodeId
forall a.
(Value -&gt; Parser a) -&gt; (Value -&gt; Parser [a]) -&gt; FromJSON a
parseJSONList :: Value -&gt; Parser [NodeId]
$cparseJSONList :: Value -&gt; Parser [NodeId]
parseJSON :: Value -&gt; Parser NodeId
$cparseJSON :: Value -&gt; Parser NodeId
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">FromJSON</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-43"></span><span>
</span><span id="line-44"></span><span class="hs-keyword">data</span><span> </span><span id="RunningNode"><span class="annot"><a href="CardanoNode.html#RunningNode"><span class="hs-identifier hs-var">RunningNode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="RunningNode"><span class="annot"><a href="CardanoNode.html#RunningNode"><span class="hs-identifier hs-var">RunningNode</span></a></span></span><span>
</span><span id="line-45"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="%24sel%3AnodeSocket%3ARunningNode"><span class="annot"><span class="annottext">RunningNode -&gt; String
</span><a href="CardanoNode.html#%24sel%3AnodeSocket%3ARunningNode"><span class="hs-identifier hs-var hs-var">nodeSocket</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">FilePath</span></a></span><span>
</span><span id="line-46"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="%24sel%3AnetworkId%3ARunningNode"><span class="annot"><span class="annottext">RunningNode -&gt; NetworkId
</span><a href="CardanoNode.html#%24sel%3AnetworkId%3ARunningNode"><span class="hs-identifier hs-var hs-var">networkId</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NetworkId</span></span><span>
</span><span id="line-47"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-48"></span><span>
</span><span id="line-49"></span><span class="hs-comment">-- | Configuration parameters for a single node devnet</span><span>
</span><span id="line-50"></span><span id="local-6989586621679328033"><span id="local-6989586621679328034"></span></span><span class="hs-keyword">data</span><span> </span><span id="DevnetConfig"><span class="annot"><a href="CardanoNode.html#DevnetConfig"><span class="hs-identifier hs-var">DevnetConfig</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="DevnetConfig"><span class="annot"><a href="CardanoNode.html#DevnetConfig"><span class="hs-identifier hs-var">DevnetConfig</span></a></span></span><span>
</span><span id="line-51"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="%24sel%3AstateDirectory%3ADevnetConfig"><span class="annot"><span class="annottext">DevnetConfig -&gt; String
</span><a href="CardanoNode.html#%24sel%3AstateDirectory%3ADevnetConfig"><span class="hs-identifier hs-var hs-var">stateDirectory</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">FilePath</span></a></span><span>
</span><span id="line-52"></span><span>  </span><span class="hs-comment">-- ^ Parent state directory</span><span>
</span><span id="line-53"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="%24sel%3AsystemStart%3ADevnetConfig"><span class="annot"><span class="annottext">DevnetConfig -&gt; UTCTime
</span><a href="CardanoNode.html#%24sel%3AsystemStart%3ADevnetConfig"><span class="hs-identifier hs-var hs-var">systemStart</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">UTCTime</span></span><span>
</span><span id="line-54"></span><span>  </span><span class="hs-comment">-- ^ Blockchain start time</span><span>
</span><span id="line-55"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="%24sel%3Aports%3ADevnetConfig"><span class="annot"><span class="annottext">DevnetConfig -&gt; PortsConfig
</span><a href="CardanoNode.html#%24sel%3Aports%3ADevnetConfig"><span class="hs-identifier hs-var hs-var">ports</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="CardanoNode.html#PortsConfig"><span class="hs-identifier hs-type">PortsConfig</span></a></span><span>
</span><span id="line-56"></span><span>  </span><span class="hs-comment">-- ^ A list of port</span><span>
</span><span id="line-57"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-58"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">stock</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679328025"><span id="local-6989586621679328027"><span class="annot"><span class="annottext">DevnetConfig -&gt; DevnetConfig -&gt; Bool
(DevnetConfig -&gt; DevnetConfig -&gt; Bool)
-&gt; (DevnetConfig -&gt; DevnetConfig -&gt; Bool) -&gt; Eq DevnetConfig
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: DevnetConfig -&gt; DevnetConfig -&gt; Bool
$c/= :: DevnetConfig -&gt; DevnetConfig -&gt; Bool
== :: DevnetConfig -&gt; DevnetConfig -&gt; Bool
$c== :: DevnetConfig -&gt; DevnetConfig -&gt; Bool
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679328019"><span id="local-6989586621679328021"><span id="local-6989586621679328023"><span class="annot"><span class="annottext">Int -&gt; DevnetConfig -&gt; ShowS
[DevnetConfig] -&gt; ShowS
DevnetConfig -&gt; String
(Int -&gt; DevnetConfig -&gt; ShowS)
-&gt; (DevnetConfig -&gt; String)
-&gt; ([DevnetConfig] -&gt; ShowS)
-&gt; Show DevnetConfig
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [DevnetConfig] -&gt; ShowS
$cshowList :: [DevnetConfig] -&gt; ShowS
show :: DevnetConfig -&gt; String
$cshow :: DevnetConfig -&gt; String
showsPrec :: Int -&gt; DevnetConfig -&gt; ShowS
$cshowsPrec :: Int -&gt; DevnetConfig -&gt; ShowS
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(forall x. DevnetConfig -&gt; Rep DevnetConfig x)
-&gt; (forall x. Rep DevnetConfig x -&gt; DevnetConfig)
-&gt; Generic DevnetConfig
forall x. Rep DevnetConfig x -&gt; DevnetConfig
forall x. DevnetConfig -&gt; Rep DevnetConfig x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cto :: forall x. Rep DevnetConfig x -&gt; DevnetConfig
$cfrom :: forall x. DevnetConfig -&gt; Rep DevnetConfig x
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-59"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">anyclass</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679328008"><span id="local-6989586621679328010"><span id="local-6989586621679328012"><span id="local-6989586621679328014"><span class="annot"><span class="annottext">[DevnetConfig] -&gt; Value
[DevnetConfig] -&gt; Encoding
DevnetConfig -&gt; Value
DevnetConfig -&gt; Encoding
(DevnetConfig -&gt; Value)
-&gt; (DevnetConfig -&gt; Encoding)
-&gt; ([DevnetConfig] -&gt; Value)
-&gt; ([DevnetConfig] -&gt; Encoding)
-&gt; ToJSON DevnetConfig
forall a.
(a -&gt; Value)
-&gt; (a -&gt; Encoding)
-&gt; ([a] -&gt; Value)
-&gt; ([a] -&gt; Encoding)
-&gt; ToJSON a
toEncodingList :: [DevnetConfig] -&gt; Encoding
$ctoEncodingList :: [DevnetConfig] -&gt; Encoding
toJSONList :: [DevnetConfig] -&gt; Value
$ctoJSONList :: [DevnetConfig] -&gt; Value
toEncoding :: DevnetConfig -&gt; Encoding
$ctoEncoding :: DevnetConfig -&gt; Encoding
toJSON :: DevnetConfig -&gt; Value
$ctoJSON :: DevnetConfig -&gt; Value
</span><a href="#local-6989586621679328008"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">ToJSON</span></a></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679328004"><span id="local-6989586621679328006"><span class="annot"><span class="annottext">Value -&gt; Parser [DevnetConfig]
Value -&gt; Parser DevnetConfig
(Value -&gt; Parser DevnetConfig)
-&gt; (Value -&gt; Parser [DevnetConfig]) -&gt; FromJSON DevnetConfig
forall a.
(Value -&gt; Parser a) -&gt; (Value -&gt; Parser [a]) -&gt; FromJSON a
parseJSONList :: Value -&gt; Parser [DevnetConfig]
$cparseJSONList :: Value -&gt; Parser [DevnetConfig]
parseJSON :: Value -&gt; Parser DevnetConfig
$cparseJSON :: Value -&gt; Parser DevnetConfig
</span><a href="#local-6989586621679328004"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">FromJSON</span></a></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-60"></span><span>
</span><span id="line-61"></span><span class="hs-comment">-- | Arguments given to the 'cardano-node' command-line to run a node.</span><span>
</span><span id="line-62"></span><span class="hs-keyword">data</span><span> </span><span id="CardanoNodeArgs"><span class="annot"><a href="CardanoNode.html#CardanoNodeArgs"><span class="hs-identifier hs-var">CardanoNodeArgs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="CardanoNodeArgs"><span class="annot"><a href="CardanoNode.html#CardanoNodeArgs"><span class="hs-identifier hs-var">CardanoNodeArgs</span></a></span></span><span>
</span><span id="line-63"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="%24sel%3AnodeSocket%3ACardanoNodeArgs"><span class="annot"><span class="annottext">CardanoNodeArgs -&gt; String
</span><a href="CardanoNode.html#%24sel%3AnodeSocket%3ACardanoNodeArgs"><span class="hs-identifier hs-var hs-var">nodeSocket</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">FilePath</span></a></span><span>
</span><span id="line-64"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="%24sel%3AnodeConfigFile%3ACardanoNodeArgs"><span class="annot"><span class="annottext">CardanoNodeArgs -&gt; String
</span><a href="CardanoNode.html#%24sel%3AnodeConfigFile%3ACardanoNodeArgs"><span class="hs-identifier hs-var hs-var">nodeConfigFile</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">FilePath</span></a></span><span>
</span><span id="line-65"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="%24sel%3AnodeByronGenesisFile%3ACardanoNodeArgs"><span class="annot"><span class="annottext">CardanoNodeArgs -&gt; String
</span><a href="CardanoNode.html#%24sel%3AnodeByronGenesisFile%3ACardanoNodeArgs"><span class="hs-identifier hs-var hs-var">nodeByronGenesisFile</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">FilePath</span></a></span><span>
</span><span id="line-66"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="%24sel%3AnodeShelleyGenesisFile%3ACardanoNodeArgs"><span class="annot"><span class="annottext">CardanoNodeArgs -&gt; String
</span><a href="CardanoNode.html#%24sel%3AnodeShelleyGenesisFile%3ACardanoNodeArgs"><span class="hs-identifier hs-var hs-var">nodeShelleyGenesisFile</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">FilePath</span></a></span><span>
</span><span id="line-67"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="%24sel%3AnodeAlonzoGenesisFile%3ACardanoNodeArgs"><span class="annot"><span class="annottext">CardanoNodeArgs -&gt; String
</span><a href="CardanoNode.html#%24sel%3AnodeAlonzoGenesisFile%3ACardanoNodeArgs"><span class="hs-identifier hs-var hs-var">nodeAlonzoGenesisFile</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">FilePath</span></a></span><span>
</span><span id="line-68"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="%24sel%3AnodeTopologyFile%3ACardanoNodeArgs"><span class="annot"><span class="annottext">CardanoNodeArgs -&gt; String
</span><a href="CardanoNode.html#%24sel%3AnodeTopologyFile%3ACardanoNodeArgs"><span class="hs-identifier hs-var hs-var">nodeTopologyFile</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">FilePath</span></a></span><span>
</span><span id="line-69"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="%24sel%3AnodeDatabaseDir%3ACardanoNodeArgs"><span class="annot"><span class="annottext">CardanoNodeArgs -&gt; String
</span><a href="CardanoNode.html#%24sel%3AnodeDatabaseDir%3ACardanoNodeArgs"><span class="hs-identifier hs-var hs-var">nodeDatabaseDir</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">FilePath</span></a></span><span>
</span><span id="line-70"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="%24sel%3AnodeDlgCertFile%3ACardanoNodeArgs"><span class="annot"><span class="annottext">CardanoNodeArgs -&gt; Maybe String
</span><a href="CardanoNode.html#%24sel%3AnodeDlgCertFile%3ACardanoNodeArgs"><span class="hs-identifier hs-var hs-var">nodeDlgCertFile</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">FilePath</span></a></span><span>
</span><span id="line-71"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="%24sel%3AnodeSignKeyFile%3ACardanoNodeArgs"><span class="annot"><span class="annottext">CardanoNodeArgs -&gt; Maybe String
</span><a href="CardanoNode.html#%24sel%3AnodeSignKeyFile%3ACardanoNodeArgs"><span class="hs-identifier hs-var hs-var">nodeSignKeyFile</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">FilePath</span></a></span><span>
</span><span id="line-72"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="%24sel%3AnodeOpCertFile%3ACardanoNodeArgs"><span class="annot"><span class="annottext">CardanoNodeArgs -&gt; Maybe String
</span><a href="CardanoNode.html#%24sel%3AnodeOpCertFile%3ACardanoNodeArgs"><span class="hs-identifier hs-var hs-var">nodeOpCertFile</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">FilePath</span></a></span><span>
</span><span id="line-73"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="%24sel%3AnodeKesKeyFile%3ACardanoNodeArgs"><span class="annot"><span class="annottext">CardanoNodeArgs -&gt; Maybe String
</span><a href="CardanoNode.html#%24sel%3AnodeKesKeyFile%3ACardanoNodeArgs"><span class="hs-identifier hs-var hs-var">nodeKesKeyFile</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">FilePath</span></a></span><span>
</span><span id="line-74"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="%24sel%3AnodeVrfKeyFile%3ACardanoNodeArgs"><span class="annot"><span class="annottext">CardanoNodeArgs -&gt; Maybe String
</span><a href="CardanoNode.html#%24sel%3AnodeVrfKeyFile%3ACardanoNodeArgs"><span class="hs-identifier hs-var hs-var">nodeVrfKeyFile</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">FilePath</span></a></span><span>
</span><span id="line-75"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="%24sel%3AnodePort%3ACardanoNodeArgs"><span class="annot"><span class="annottext">CardanoNodeArgs -&gt; Maybe Int
</span><a href="CardanoNode.html#%24sel%3AnodePort%3ACardanoNodeArgs"><span class="hs-identifier hs-var hs-var">nodePort</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="CardanoNode.html#Port"><span class="hs-identifier hs-type">Port</span></a></span><span>
</span><span id="line-76"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-77"></span><span>
</span><span id="line-78"></span><span class="annot"><a href="CardanoNode.html#defaultCardanoNodeArgs"><span class="hs-identifier hs-type">defaultCardanoNodeArgs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="CardanoNode.html#CardanoNodeArgs"><span class="hs-identifier hs-type">CardanoNodeArgs</span></a></span><span>
</span><span id="line-79"></span><span id="defaultCardanoNodeArgs"><span class="annot"><span class="annottext">defaultCardanoNodeArgs :: CardanoNodeArgs
</span><a href="CardanoNode.html#defaultCardanoNodeArgs"><span class="hs-identifier hs-var hs-var">defaultCardanoNodeArgs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-80"></span><span>  </span><span class="annot"><span class="annottext">CardanoNodeArgs :: String
-&gt; String
-&gt; String
-&gt; String
-&gt; String
-&gt; String
-&gt; String
-&gt; Maybe String
-&gt; Maybe String
-&gt; Maybe String
-&gt; Maybe String
-&gt; Maybe String
-&gt; Maybe Int
-&gt; CardanoNodeArgs
</span><a href="CardanoNode.html#CardanoNodeArgs"><span class="hs-identifier hs-type">CardanoNodeArgs</span></a></span><span>
</span><span id="line-81"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">$sel:nodeSocket:CardanoNodeArgs :: String
</span><a href="CardanoNode.html#%24sel%3AnodeSocket%3ACardanoNodeArgs"><span class="hs-identifier hs-var">nodeSocket</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;node.socket&quot;</span></span><span>
</span><span id="line-82"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:nodeConfigFile:CardanoNodeArgs :: String
</span><a href="CardanoNode.html#%24sel%3AnodeConfigFile%3ACardanoNodeArgs"><span class="hs-identifier hs-var">nodeConfigFile</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;configuration.json&quot;</span></span><span>
</span><span id="line-83"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:nodeByronGenesisFile:CardanoNodeArgs :: String
</span><a href="CardanoNode.html#%24sel%3AnodeByronGenesisFile%3ACardanoNodeArgs"><span class="hs-identifier hs-var">nodeByronGenesisFile</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;genesis-byron.json&quot;</span></span><span>
</span><span id="line-84"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:nodeShelleyGenesisFile:CardanoNodeArgs :: String
</span><a href="CardanoNode.html#%24sel%3AnodeShelleyGenesisFile%3ACardanoNodeArgs"><span class="hs-identifier hs-var">nodeShelleyGenesisFile</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;genesis-shelley.json&quot;</span></span><span>
</span><span id="line-85"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:nodeAlonzoGenesisFile:CardanoNodeArgs :: String
</span><a href="CardanoNode.html#%24sel%3AnodeAlonzoGenesisFile%3ACardanoNodeArgs"><span class="hs-identifier hs-var">nodeAlonzoGenesisFile</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;genesis-alonzo.json&quot;</span></span><span>
</span><span id="line-86"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:nodeTopologyFile:CardanoNodeArgs :: String
</span><a href="CardanoNode.html#%24sel%3AnodeTopologyFile%3ACardanoNodeArgs"><span class="hs-identifier hs-var">nodeTopologyFile</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;topology.json&quot;</span></span><span>
</span><span id="line-87"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:nodeDatabaseDir:CardanoNodeArgs :: String
</span><a href="CardanoNode.html#%24sel%3AnodeDatabaseDir%3ACardanoNodeArgs"><span class="hs-identifier hs-var">nodeDatabaseDir</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;db&quot;</span></span><span>
</span><span id="line-88"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:nodeDlgCertFile:CardanoNodeArgs :: Maybe String
</span><a href="CardanoNode.html#%24sel%3AnodeDlgCertFile%3ACardanoNodeArgs"><span class="hs-identifier hs-var">nodeDlgCertFile</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe String
forall a. Maybe a
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-89"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:nodeSignKeyFile:CardanoNodeArgs :: Maybe String
</span><a href="CardanoNode.html#%24sel%3AnodeSignKeyFile%3ACardanoNodeArgs"><span class="hs-identifier hs-var">nodeSignKeyFile</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe String
forall a. Maybe a
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-90"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:nodeOpCertFile:CardanoNodeArgs :: Maybe String
</span><a href="CardanoNode.html#%24sel%3AnodeOpCertFile%3ACardanoNodeArgs"><span class="hs-identifier hs-var">nodeOpCertFile</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe String
forall a. Maybe a
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-91"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:nodeKesKeyFile:CardanoNodeArgs :: Maybe String
</span><a href="CardanoNode.html#%24sel%3AnodeKesKeyFile%3ACardanoNodeArgs"><span class="hs-identifier hs-var">nodeKesKeyFile</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe String
forall a. Maybe a
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-92"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:nodeVrfKeyFile:CardanoNodeArgs :: Maybe String
</span><a href="CardanoNode.html#%24sel%3AnodeVrfKeyFile%3ACardanoNodeArgs"><span class="hs-identifier hs-var">nodeVrfKeyFile</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe String
forall a. Maybe a
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-93"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:nodePort:CardanoNodeArgs :: Maybe Int
</span><a href="CardanoNode.html#%24sel%3AnodePort%3ACardanoNodeArgs"><span class="hs-identifier hs-var">nodePort</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe Int
forall a. Maybe a
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-94"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-95"></span><span>
</span><span id="line-96"></span><span class="hs-comment">-- | Configuration of ports from the perspective of a peer in the context of a</span><span>
</span><span id="line-97"></span><span class="hs-comment">-- fully sockected topology.</span><span>
</span><span id="line-98"></span><span id="local-6989586621679327987"><span id="local-6989586621679327988"></span></span><span class="hs-keyword">data</span><span> </span><span id="PortsConfig"><span class="annot"><a href="CardanoNode.html#PortsConfig"><span class="hs-identifier hs-var">PortsConfig</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="PortsConfig"><span class="annot"><a href="CardanoNode.html#PortsConfig"><span class="hs-identifier hs-var">PortsConfig</span></a></span></span><span>
</span><span id="line-99"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="%24sel%3Aours%3APortsConfig"><span class="annot"><span class="annottext">PortsConfig -&gt; Int
</span><a href="CardanoNode.html#%24sel%3Aours%3APortsConfig"><span class="hs-identifier hs-var hs-var">ours</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="CardanoNode.html#Port"><span class="hs-identifier hs-type">Port</span></a></span><span>
</span><span id="line-100"></span><span>  </span><span class="hs-comment">-- ^ Our node TCP port.</span><span>
</span><span id="line-101"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="%24sel%3Apeers%3APortsConfig"><span class="annot"><span class="annottext">PortsConfig -&gt; [Int]
</span><a href="CardanoNode.html#%24sel%3Apeers%3APortsConfig"><span class="hs-identifier hs-var hs-var">peers</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="CardanoNode.html#Port"><span class="hs-identifier hs-type">Port</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-102"></span><span>  </span><span class="hs-comment">-- ^ Other peers TCP ports.</span><span>
</span><span id="line-103"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-104"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">stock</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679327978"><span id="local-6989586621679327980"><span id="local-6989586621679327982"><span class="annot"><span class="annottext">Int -&gt; PortsConfig -&gt; ShowS
[PortsConfig] -&gt; ShowS
PortsConfig -&gt; String
(Int -&gt; PortsConfig -&gt; ShowS)
-&gt; (PortsConfig -&gt; String)
-&gt; ([PortsConfig] -&gt; ShowS)
-&gt; Show PortsConfig
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [PortsConfig] -&gt; ShowS
$cshowList :: [PortsConfig] -&gt; ShowS
show :: PortsConfig -&gt; String
$cshow :: PortsConfig -&gt; String
showsPrec :: Int -&gt; PortsConfig -&gt; ShowS
$cshowsPrec :: Int -&gt; PortsConfig -&gt; ShowS
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679327974"><span id="local-6989586621679327976"><span class="annot"><span class="annottext">PortsConfig -&gt; PortsConfig -&gt; Bool
(PortsConfig -&gt; PortsConfig -&gt; Bool)
-&gt; (PortsConfig -&gt; PortsConfig -&gt; Bool) -&gt; Eq PortsConfig
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: PortsConfig -&gt; PortsConfig -&gt; Bool
$c/= :: PortsConfig -&gt; PortsConfig -&gt; Bool
== :: PortsConfig -&gt; PortsConfig -&gt; Bool
$c== :: PortsConfig -&gt; PortsConfig -&gt; Bool
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(forall x. PortsConfig -&gt; Rep PortsConfig x)
-&gt; (forall x. Rep PortsConfig x -&gt; PortsConfig)
-&gt; Generic PortsConfig
forall x. Rep PortsConfig x -&gt; PortsConfig
forall x. PortsConfig -&gt; Rep PortsConfig x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cto :: forall x. Rep PortsConfig x -&gt; PortsConfig
$cfrom :: forall x. PortsConfig -&gt; Rep PortsConfig x
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-105"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">anyclass</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679327964"><span id="local-6989586621679327966"><span id="local-6989586621679327968"><span id="local-6989586621679327970"><span class="annot"><span class="annottext">[PortsConfig] -&gt; Value
[PortsConfig] -&gt; Encoding
PortsConfig -&gt; Value
PortsConfig -&gt; Encoding
(PortsConfig -&gt; Value)
-&gt; (PortsConfig -&gt; Encoding)
-&gt; ([PortsConfig] -&gt; Value)
-&gt; ([PortsConfig] -&gt; Encoding)
-&gt; ToJSON PortsConfig
forall a.
(a -&gt; Value)
-&gt; (a -&gt; Encoding)
-&gt; ([a] -&gt; Value)
-&gt; ([a] -&gt; Encoding)
-&gt; ToJSON a
toEncodingList :: [PortsConfig] -&gt; Encoding
$ctoEncodingList :: [PortsConfig] -&gt; Encoding
toJSONList :: [PortsConfig] -&gt; Value
$ctoJSONList :: [PortsConfig] -&gt; Value
toEncoding :: PortsConfig -&gt; Encoding
$ctoEncoding :: PortsConfig -&gt; Encoding
toJSON :: PortsConfig -&gt; Value
$ctoJSON :: PortsConfig -&gt; Value
</span><a href="#local-6989586621679327964"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">ToJSON</span></a></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679327960"><span id="local-6989586621679327962"><span class="annot"><span class="annottext">Value -&gt; Parser [PortsConfig]
Value -&gt; Parser PortsConfig
(Value -&gt; Parser PortsConfig)
-&gt; (Value -&gt; Parser [PortsConfig]) -&gt; FromJSON PortsConfig
forall a.
(Value -&gt; Parser a) -&gt; (Value -&gt; Parser [a]) -&gt; FromJSON a
parseJSONList :: Value -&gt; Parser [PortsConfig]
$cparseJSONList :: Value -&gt; Parser [PortsConfig]
parseJSON :: Value -&gt; Parser PortsConfig
$cparseJSON :: Value -&gt; Parser PortsConfig
</span><a href="#local-6989586621679327960"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">FromJSON</span></a></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-106"></span><span>
</span><span id="line-107"></span><span class="annot"><a href="CardanoNode.html#getCardanoNodeVersion"><span class="hs-identifier hs-type">getCardanoNodeVersion</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">String</span></a></span><span>
</span><span id="line-108"></span><span id="getCardanoNodeVersion"><span class="annot"><span class="annottext">getCardanoNodeVersion :: IO String
</span><a href="CardanoNode.html#getCardanoNodeVersion"><span class="hs-identifier hs-var hs-var">getCardanoNodeVersion</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-109"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; [String] -&gt; String -&gt; IO String
</span><span class="hs-identifier hs-var">readProcess</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;cardano-node&quot;</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;--version&quot;</span></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span>
</span><span id="line-110"></span><span>
</span><span id="line-111"></span><span class="hs-comment">-- | Start a single cardano-node devnet using the config from config/ and</span><span>
</span><span id="line-112"></span><span class="hs-comment">-- credentials from config/credentials/. Only the 'Faucet' actor will receive</span><span>
</span><span id="line-113"></span><span class="hs-comment">-- &quot;initialFunds&quot;. Use 'seedFromFaucet' to distribute funds other wallets.</span><span>
</span><span id="line-114"></span><span id="local-6989586621679327958"><span class="annot"><a href="CardanoNode.html#withCardanoNodeDevnet"><span class="hs-identifier hs-type">withCardanoNodeDevnet</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-115"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Tracer</span></span><span> </span><span class="annot"><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="CardanoNode.html#NodeLog"><span class="hs-identifier hs-type">NodeLog</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-116"></span><span>  </span><span class="hs-comment">-- | State directory in which credentials, db &amp; logs are persisted.</span><span>
</span><span id="line-117"></span><span>  </span><span class="annot"><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">FilePath</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-118"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="CardanoNode.html#RunningNode"><span class="hs-identifier hs-type">RunningNode</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679327958"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-119"></span><span>  </span><span class="annot"><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679327958"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-120"></span><span id="withCardanoNodeDevnet"><span class="annot"><span class="annottext">withCardanoNodeDevnet :: Tracer IO NodeLog -&gt; String -&gt; (RunningNode -&gt; IO a) -&gt; IO a
</span><a href="CardanoNode.html#withCardanoNodeDevnet"><span class="hs-identifier hs-var hs-var">withCardanoNodeDevnet</span></a></span></span><span> </span><span id="local-6989586621679327956"><span class="annot"><span class="annottext">Tracer IO NodeLog
</span><a href="#local-6989586621679327956"><span class="hs-identifier hs-var">tracer</span></a></span></span><span> </span><span id="local-6989586621679327955"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679327955"><span class="hs-identifier hs-var">stateDirectory</span></a></span></span><span> </span><span id="local-6989586621679327954"><span class="annot"><span class="annottext">RunningNode -&gt; IO a
</span><a href="#local-6989586621679327954"><span class="hs-identifier hs-var">action</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-121"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; String -&gt; IO ()
</span><span class="hs-identifier hs-var">createDirectoryIfMissing</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">True</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679327955"><span class="hs-identifier hs-var">stateDirectory</span></a></span><span>
</span><span id="line-122"></span><span>  </span><span class="hs-special">[</span><span id="local-6989586621679327953"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679327953"><span class="hs-identifier hs-var">dlgCert</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679327952"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679327952"><span class="hs-identifier hs-var">signKey</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679327951"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679327951"><span class="hs-identifier hs-var">vrfKey</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679327950"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679327950"><span class="hs-identifier hs-var">kesKey</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679327949"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679327949"><span class="hs-identifier hs-var">opCert</span></a></span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-123"></span><span>    </span><span class="annot"><span class="annottext">(String -&gt; IO String) -&gt; [String] -&gt; IO [String]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m (t b)
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mapM</span></a></span><span>
</span><span id="line-124"></span><span>      </span><span class="annot"><span class="annottext">String -&gt; IO String
</span><a href="#local-6989586621679327947"><span class="hs-identifier hs-var">copyDevnetCredential</span></a></span><span>
</span><span id="line-125"></span><span>      </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;byron-delegation.cert&quot;</span></span><span>
</span><span id="line-126"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;byron-delegate.key&quot;</span></span><span>
</span><span id="line-127"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;vrf.skey&quot;</span></span><span>
</span><span id="line-128"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;kes.skey&quot;</span></span><span>
</span><span id="line-129"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;opcert.cert&quot;</span></span><span>
</span><span id="line-130"></span><span>      </span><span class="hs-special">]</span><span>
</span><span id="line-131"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679327946"><span class="annot"><span class="annottext">args :: CardanoNodeArgs
</span><a href="#local-6989586621679327946"><span class="hs-identifier hs-var hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-132"></span><span>        </span><span class="annot"><span class="annottext">CardanoNodeArgs
</span><a href="CardanoNode.html#defaultCardanoNodeArgs"><span class="hs-identifier hs-var">defaultCardanoNodeArgs</span></a></span><span>
</span><span id="line-133"></span><span>          </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">$sel:nodeDlgCertFile:CardanoNodeArgs :: Maybe String
</span><a href="CardanoNode.html#%24sel%3AnodeDlgCertFile%3ACardanoNodeArgs"><span class="hs-identifier hs-var">nodeDlgCertFile</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Maybe String
forall a. a -&gt; Maybe a
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679327953"><span class="hs-identifier hs-var">dlgCert</span></a></span><span>
</span><span id="line-134"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:nodeSignKeyFile:CardanoNodeArgs :: Maybe String
</span><a href="CardanoNode.html#%24sel%3AnodeSignKeyFile%3ACardanoNodeArgs"><span class="hs-identifier hs-var">nodeSignKeyFile</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Maybe String
forall a. a -&gt; Maybe a
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679327952"><span class="hs-identifier hs-var">signKey</span></a></span><span>
</span><span id="line-135"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:nodeVrfKeyFile:CardanoNodeArgs :: Maybe String
</span><a href="CardanoNode.html#%24sel%3AnodeVrfKeyFile%3ACardanoNodeArgs"><span class="hs-identifier hs-var">nodeVrfKeyFile</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Maybe String
forall a. a -&gt; Maybe a
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679327951"><span class="hs-identifier hs-var">vrfKey</span></a></span><span>
</span><span id="line-136"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:nodeKesKeyFile:CardanoNodeArgs :: Maybe String
</span><a href="CardanoNode.html#%24sel%3AnodeKesKeyFile%3ACardanoNodeArgs"><span class="hs-identifier hs-var">nodeKesKeyFile</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Maybe String
forall a. a -&gt; Maybe a
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679327950"><span class="hs-identifier hs-var">kesKey</span></a></span><span>
</span><span id="line-137"></span><span>          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:nodeOpCertFile:CardanoNodeArgs :: Maybe String
</span><a href="CardanoNode.html#%24sel%3AnodeOpCertFile%3ACardanoNodeArgs"><span class="hs-identifier hs-var">nodeOpCertFile</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Maybe String
forall a. a -&gt; Maybe a
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679327949"><span class="hs-identifier hs-var">opCert</span></a></span><span>
</span><span id="line-138"></span><span>          </span><span class="hs-special">}</span><span>
</span><span id="line-139"></span><span>  </span><span class="annot"><span class="annottext">CardanoNodeArgs -&gt; IO ()
</span><a href="#local-6989586621679327945"><span class="hs-identifier hs-var">copyDevnetFiles</span></a></span><span> </span><span class="annot"><span class="annottext">CardanoNodeArgs
</span><a href="#local-6989586621679327946"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-140"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; CardanoNodeArgs -&gt; IO ()
</span><a href="CardanoNode.html#refreshSystemStart"><span class="hs-identifier hs-var">refreshSystemStart</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679327955"><span class="hs-identifier hs-var">stateDirectory</span></a></span><span> </span><span class="annot"><span class="annottext">CardanoNodeArgs
</span><a href="#local-6989586621679327946"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-141"></span><span>  </span><span class="annot"><span class="annottext">[Int] -&gt; CardanoNodeArgs -&gt; IO ()
</span><a href="#local-6989586621679327943"><span class="hs-identifier hs-var">writeTopology</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">CardanoNodeArgs
</span><a href="#local-6989586621679327946"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-142"></span><span>
</span><span id="line-143"></span><span>  </span><span class="annot"><span class="annottext">Tracer IO NodeLog
-&gt; NetworkId
-&gt; String
-&gt; CardanoNodeArgs
-&gt; (RunningNode -&gt; IO a)
-&gt; IO a
forall a.
Tracer IO NodeLog
-&gt; NetworkId
-&gt; String
-&gt; CardanoNodeArgs
-&gt; (RunningNode -&gt; IO a)
-&gt; IO a
</span><a href="CardanoNode.html#withCardanoNode"><span class="hs-identifier hs-var">withCardanoNode</span></a></span><span> </span><span class="annot"><span class="annottext">Tracer IO NodeLog
</span><a href="#local-6989586621679327956"><span class="hs-identifier hs-var">tracer</span></a></span><span> </span><span class="annot"><span class="annottext">NetworkId
</span><a href="#local-6989586621679327941"><span class="hs-identifier hs-var">networkId</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679327955"><span class="hs-identifier hs-var">stateDirectory</span></a></span><span> </span><span class="annot"><span class="annottext">CardanoNodeArgs
</span><a href="#local-6989586621679327946"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="annot"><span class="annottext">((RunningNode -&gt; IO a) -&gt; IO a) -&gt; (RunningNode -&gt; IO a) -&gt; IO a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679327940"><span class="annot"><span class="annottext">RunningNode
</span><a href="#local-6989586621679327940"><span class="hs-identifier hs-var">rn</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-144"></span><span>    </span><span class="annot"><span class="annottext">Tracer IO NodeLog -&gt; NodeLog -&gt; IO ()
forall (m :: * -&gt; *) a. Tracer m a -&gt; a -&gt; m ()
</span><span class="hs-identifier hs-var">traceWith</span></span><span> </span><span class="annot"><span class="annottext">Tracer IO NodeLog
</span><a href="#local-6989586621679327956"><span class="hs-identifier hs-var">tracer</span></a></span><span> </span><span class="annot"><span class="annottext">NodeLog
</span><a href="CardanoNode.html#MsgNodeIsReady"><span class="hs-identifier hs-var">MsgNodeIsReady</span></a></span><span>
</span><span id="line-145"></span><span>    </span><span class="annot"><span class="annottext">RunningNode -&gt; IO a
</span><a href="#local-6989586621679327954"><span class="hs-identifier hs-var">action</span></a></span><span> </span><span class="annot"><span class="annottext">RunningNode
</span><a href="#local-6989586621679327940"><span class="hs-identifier hs-var">rn</span></a></span><span>
</span><span id="line-146"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-147"></span><span>  </span><span class="hs-comment">-- NOTE: This needs to match what's in config/genesis-shelley.json</span><span>
</span><span id="line-148"></span><span>  </span><span id="local-6989586621679327941"><span class="annot"><span class="annottext">networkId :: NetworkId
</span><a href="#local-6989586621679327941"><span class="hs-identifier hs-var hs-var">networkId</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NetworkId
</span><a href="Hydra.Cluster.Fixture.html#defaultNetworkId"><span class="hs-identifier hs-var">defaultNetworkId</span></a></span><span>
</span><span id="line-149"></span><span>
</span><span id="line-150"></span><span>  </span><span id="local-6989586621679327947"><span class="annot"><span class="annottext">copyDevnetCredential :: String -&gt; IO String
</span><a href="#local-6989586621679327947"><span class="hs-identifier hs-var hs-var">copyDevnetCredential</span></a></span></span><span> </span><span id="local-6989586621679327938"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679327938"><span class="hs-identifier hs-var">file</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-151"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679327937"><span class="annot"><span class="annottext">destination :: String
</span><a href="#local-6989586621679327937"><span class="hs-identifier hs-var hs-var">destination</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679327955"><span class="hs-identifier hs-var">stateDirectory</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
</span><span class="hs-operator hs-var">&lt;/&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679327938"><span class="hs-identifier hs-var">file</span></a></span><span>
</span><span id="line-152"></span><span>    </span><span class="annot"><span class="annottext">IO Bool -&gt; IO () -&gt; IO ()
forall (m :: * -&gt; *). Monad m =&gt; m Bool -&gt; m () -&gt; m ()
</span><span class="hs-identifier hs-var">unlessM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; IO Bool
</span><span class="hs-identifier hs-var">doesFileExist</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679327937"><span class="hs-identifier hs-var">destination</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ()) -&gt; IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-153"></span><span>      </span><span class="annot"><span class="annottext">String -&gt; IO ByteString
</span><a href="Hydra.Cluster.Util.html#readConfigFile"><span class="hs-identifier hs-var">readConfigFile</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;devnet&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
</span><span class="hs-operator hs-var">&lt;/&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679327938"><span class="hs-identifier hs-var">file</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-154"></span><span>        </span><span class="annot"><span class="annottext">IO ByteString -&gt; (ByteString -&gt; IO ()) -&gt; IO ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ByteString -&gt; IO ()
forall (m :: * -&gt; *). MonadIO m =&gt; String -&gt; ByteString -&gt; m ()
</span><span class="hs-identifier hs-var">writeFileBS</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679327937"><span class="hs-identifier hs-var">destination</span></a></span><span>
</span><span id="line-155"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; FileMode -&gt; IO ()
</span><span class="hs-identifier hs-var">setFileMode</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679327937"><span class="hs-identifier hs-var">destination</span></a></span><span> </span><span class="annot"><span class="annottext">FileMode
</span><span class="hs-identifier hs-var">ownerReadMode</span></span><span>
</span><span id="line-156"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; IO String
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679327938"><span class="hs-identifier hs-var">file</span></a></span><span>
</span><span id="line-157"></span><span>
</span><span id="line-158"></span><span>  </span><span id="local-6989586621679327945"><span class="annot"><span class="annottext">copyDevnetFiles :: CardanoNodeArgs -&gt; IO ()
</span><a href="#local-6989586621679327945"><span class="hs-identifier hs-var hs-var">copyDevnetFiles</span></a></span></span><span> </span><span id="local-6989586621679327934"><span class="annot"><span class="annottext">CardanoNodeArgs
</span><a href="#local-6989586621679327934"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-159"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; IO ByteString
</span><a href="Hydra.Cluster.Util.html#readConfigFile"><span class="hs-identifier hs-var">readConfigFile</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;devnet&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
</span><span class="hs-operator hs-var">&lt;/&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;cardano-node.json&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-160"></span><span>      </span><span class="annot"><span class="annottext">IO ByteString -&gt; (ByteString -&gt; IO ()) -&gt; IO ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ByteString -&gt; IO ()
forall (m :: * -&gt; *). MonadIO m =&gt; String -&gt; ByteString -&gt; m ()
</span><span class="hs-identifier hs-var">writeFileBS</span></span><span>
</span><span id="line-161"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679327955"><span class="hs-identifier hs-var">stateDirectory</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
</span><span class="hs-operator hs-var">&lt;/&gt;</span></span><span> </span><span class="annot"><span class="annottext">CardanoNodeArgs -&gt; String
</span><a href="CardanoNode.html#%24sel%3AnodeConfigFile%3ACardanoNodeArgs"><span class="hs-identifier hs-var hs-var">nodeConfigFile</span></a></span><span> </span><span class="annot"><span class="annottext">CardanoNodeArgs
</span><a href="#local-6989586621679327934"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-162"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; IO ByteString
</span><a href="Hydra.Cluster.Util.html#readConfigFile"><span class="hs-identifier hs-var">readConfigFile</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;devnet&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
</span><span class="hs-operator hs-var">&lt;/&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;genesis-byron.json&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-163"></span><span>      </span><span class="annot"><span class="annottext">IO ByteString -&gt; (ByteString -&gt; IO ()) -&gt; IO ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ByteString -&gt; IO ()
forall (m :: * -&gt; *). MonadIO m =&gt; String -&gt; ByteString -&gt; m ()
</span><span class="hs-identifier hs-var">writeFileBS</span></span><span>
</span><span id="line-164"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679327955"><span class="hs-identifier hs-var">stateDirectory</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
</span><span class="hs-operator hs-var">&lt;/&gt;</span></span><span> </span><span class="annot"><span class="annottext">CardanoNodeArgs -&gt; String
</span><a href="CardanoNode.html#%24sel%3AnodeByronGenesisFile%3ACardanoNodeArgs"><span class="hs-identifier hs-var hs-var">nodeByronGenesisFile</span></a></span><span> </span><span class="annot"><span class="annottext">CardanoNodeArgs
</span><a href="#local-6989586621679327934"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-165"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; IO ByteString
</span><a href="Hydra.Cluster.Util.html#readConfigFile"><span class="hs-identifier hs-var">readConfigFile</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;devnet&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
</span><span class="hs-operator hs-var">&lt;/&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;genesis-shelley.json&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-166"></span><span>      </span><span class="annot"><span class="annottext">IO ByteString -&gt; (ByteString -&gt; IO ()) -&gt; IO ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ByteString -&gt; IO ()
forall (m :: * -&gt; *). MonadIO m =&gt; String -&gt; ByteString -&gt; m ()
</span><span class="hs-identifier hs-var">writeFileBS</span></span><span>
</span><span id="line-167"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679327955"><span class="hs-identifier hs-var">stateDirectory</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
</span><span class="hs-operator hs-var">&lt;/&gt;</span></span><span> </span><span class="annot"><span class="annottext">CardanoNodeArgs -&gt; String
</span><a href="CardanoNode.html#%24sel%3AnodeShelleyGenesisFile%3ACardanoNodeArgs"><span class="hs-identifier hs-var hs-var">nodeShelleyGenesisFile</span></a></span><span> </span><span class="annot"><span class="annottext">CardanoNodeArgs
</span><a href="#local-6989586621679327934"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-168"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; IO ByteString
</span><a href="Hydra.Cluster.Util.html#readConfigFile"><span class="hs-identifier hs-var">readConfigFile</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;devnet&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
</span><span class="hs-operator hs-var">&lt;/&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;genesis-alonzo.json&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-169"></span><span>      </span><span class="annot"><span class="annottext">IO ByteString -&gt; (ByteString -&gt; IO ()) -&gt; IO ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ByteString -&gt; IO ()
forall (m :: * -&gt; *). MonadIO m =&gt; String -&gt; ByteString -&gt; m ()
</span><span class="hs-identifier hs-var">writeFileBS</span></span><span>
</span><span id="line-170"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679327955"><span class="hs-identifier hs-var">stateDirectory</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
</span><span class="hs-operator hs-var">&lt;/&gt;</span></span><span> </span><span class="annot"><span class="annottext">CardanoNodeArgs -&gt; String
</span><a href="CardanoNode.html#%24sel%3AnodeAlonzoGenesisFile%3ACardanoNodeArgs"><span class="hs-identifier hs-var hs-var">nodeAlonzoGenesisFile</span></a></span><span> </span><span class="annot"><span class="annottext">CardanoNodeArgs
</span><a href="#local-6989586621679327934"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-171"></span><span>
</span><span id="line-172"></span><span>  </span><span id="local-6989586621679327943"><span class="annot"><span class="annottext">writeTopology :: [Int] -&gt; CardanoNodeArgs -&gt; IO ()
</span><a href="#local-6989586621679327943"><span class="hs-identifier hs-var hs-var">writeTopology</span></a></span></span><span> </span><span id="local-6989586621679327933"><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679327933"><span class="hs-identifier hs-var">peers</span></a></span></span><span> </span><span id="local-6989586621679327932"><span class="annot"><span class="annottext">CardanoNodeArgs
</span><a href="#local-6989586621679327932"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-173"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; Value -&gt; IO ()
forall a. ToJSON a =&gt; String -&gt; a -&gt; IO ()
</span><span class="hs-identifier hs-var">Aeson.encodeFile</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679327955"><span class="hs-identifier hs-var">stateDirectory</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
</span><span class="hs-operator hs-var">&lt;/&gt;</span></span><span> </span><span class="annot"><span class="annottext">CardanoNodeArgs -&gt; String
</span><a href="CardanoNode.html#%24sel%3AnodeTopologyFile%3ACardanoNodeArgs"><span class="hs-identifier hs-var hs-var">nodeTopologyFile</span></a></span><span> </span><span class="annot"><span class="annottext">CardanoNodeArgs
</span><a href="#local-6989586621679327932"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Value -&gt; IO ()) -&gt; Value -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-174"></span><span>      </span><span class="annot"><span class="annottext">[Int] -&gt; Value
</span><a href="CardanoNode.html#mkTopology"><span class="hs-identifier hs-var">mkTopology</span></a></span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679327933"><span class="hs-identifier hs-var">peers</span></a></span><span>
</span><span id="line-175"></span><span>
</span><span id="line-176"></span><span class="hs-comment">-- | Run a cardano-node as normal network participant on a known network.</span><span>
</span><span id="line-177"></span><span class="annot"><a href="CardanoNode.html#withCardanoNodeOnKnownNetwork"><span class="hs-identifier hs-type">withCardanoNodeOnKnownNetwork</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-178"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Tracer</span></span><span> </span><span class="annot"><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="CardanoNode.html#NodeLog"><span class="hs-identifier hs-type">NodeLog</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-179"></span><span>  </span><span class="hs-comment">-- | State directory in which node db &amp; logs are persisted.</span><span>
</span><span id="line-180"></span><span>  </span><span class="annot"><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">FilePath</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-181"></span><span>  </span><span class="hs-comment">-- | A well-known Cardano network to connect to.</span><span>
</span><span id="line-182"></span><span>  </span><span class="annot"><a href="Hydra.Cluster.Fixture.html#KnownNetwork"><span class="hs-identifier hs-type">KnownNetwork</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-183"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="CardanoNode.html#RunningNode"><span class="hs-identifier hs-type">RunningNode</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-184"></span><span>  </span><span class="annot"><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-185"></span><span id="withCardanoNodeOnKnownNetwork"><span class="annot"><span class="annottext">withCardanoNodeOnKnownNetwork :: Tracer IO NodeLog
-&gt; String -&gt; KnownNetwork -&gt; (RunningNode -&gt; IO ()) -&gt; IO ()
</span><a href="CardanoNode.html#withCardanoNodeOnKnownNetwork"><span class="hs-identifier hs-var hs-var">withCardanoNodeOnKnownNetwork</span></a></span></span><span> </span><span id="local-6989586621679327928"><span class="annot"><span class="annottext">Tracer IO NodeLog
</span><a href="#local-6989586621679327928"><span class="hs-identifier hs-var">tracer</span></a></span></span><span> </span><span id="local-6989586621679327927"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679327927"><span class="hs-identifier hs-var">workDir</span></a></span></span><span> </span><span id="local-6989586621679327926"><span class="annot"><span class="annottext">KnownNetwork
</span><a href="#local-6989586621679327926"><span class="hs-identifier hs-var">knownNetwork</span></a></span></span><span> </span><span id="local-6989586621679327925"><span class="annot"><span class="annottext">RunningNode -&gt; IO ()
</span><a href="#local-6989586621679327925"><span class="hs-identifier hs-var">action</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-186"></span><span>  </span><span id="local-6989586621679327924"><span class="annot"><span class="annottext">NetworkId
</span><a href="#local-6989586621679327924"><span class="hs-identifier hs-var">networkId</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO NetworkId
</span><a href="#local-6989586621679327923"><span class="hs-identifier hs-var">readNetworkId</span></a></span><span>
</span><span id="line-187"></span><span>  </span><span class="annot"><span class="annottext">IO ()
</span><a href="#local-6989586621679327922"><span class="hs-identifier hs-var">copyKnownNetworkFiles</span></a></span><span>
</span><span id="line-188"></span><span>  </span><span class="annot"><span class="annottext">Tracer IO NodeLog
-&gt; NetworkId
-&gt; String
-&gt; CardanoNodeArgs
-&gt; (RunningNode -&gt; IO ())
-&gt; IO ()
forall a.
Tracer IO NodeLog
-&gt; NetworkId
-&gt; String
-&gt; CardanoNodeArgs
-&gt; (RunningNode -&gt; IO a)
-&gt; IO a
</span><a href="CardanoNode.html#withCardanoNode"><span class="hs-identifier hs-var">withCardanoNode</span></a></span><span> </span><span class="annot"><span class="annottext">Tracer IO NodeLog
</span><a href="#local-6989586621679327928"><span class="hs-identifier hs-var">tracer</span></a></span><span> </span><span class="annot"><span class="annottext">NetworkId
</span><a href="#local-6989586621679327924"><span class="hs-identifier hs-var">networkId</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679327927"><span class="hs-identifier hs-var">workDir</span></a></span><span> </span><span class="annot"><span class="annottext">CardanoNodeArgs
</span><a href="#local-6989586621679327921"><span class="hs-identifier hs-var">args</span></a></span><span> </span><span class="annot"><span class="annottext">((RunningNode -&gt; IO ()) -&gt; IO ())
-&gt; (RunningNode -&gt; IO ()) -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679327920"><span class="annot"><span class="annottext">RunningNode
</span><a href="#local-6989586621679327920"><span class="hs-identifier hs-var">node</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-189"></span><span>    </span><span class="annot"><span class="annottext">Tracer IO NodeLog -&gt; NodeLog -&gt; IO ()
forall (m :: * -&gt; *) a. Tracer m a -&gt; a -&gt; m ()
</span><span class="hs-identifier hs-var">traceWith</span></span><span> </span><span class="annot"><span class="annottext">Tracer IO NodeLog
</span><a href="#local-6989586621679327928"><span class="hs-identifier hs-var">tracer</span></a></span><span> </span><span class="annot"><span class="annottext">NodeLog
</span><a href="CardanoNode.html#MsgNodeIsReady"><span class="hs-identifier hs-var">MsgNodeIsReady</span></a></span><span>
</span><span id="line-190"></span><span>    </span><span class="annot"><span class="annottext">RunningNode -&gt; IO ()
</span><a href="#local-6989586621679327925"><span class="hs-identifier hs-var">action</span></a></span><span> </span><span class="annot"><span class="annottext">RunningNode
</span><a href="#local-6989586621679327920"><span class="hs-identifier hs-var">node</span></a></span><span>
</span><span id="line-191"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-192"></span><span>  </span><span id="local-6989586621679327921"><span class="annot"><span class="annottext">args :: CardanoNodeArgs
</span><a href="#local-6989586621679327921"><span class="hs-identifier hs-var hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-193"></span><span>    </span><span class="annot"><span class="annottext">CardanoNodeArgs
</span><a href="CardanoNode.html#defaultCardanoNodeArgs"><span class="hs-identifier hs-var">defaultCardanoNodeArgs</span></a></span><span>
</span><span id="line-194"></span><span>      </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">$sel:nodeConfigFile:CardanoNodeArgs :: String
</span><a href="CardanoNode.html#%24sel%3AnodeConfigFile%3ACardanoNodeArgs"><span class="hs-identifier hs-var">nodeConfigFile</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;cardano-node/config.json&quot;</span></span><span>
</span><span id="line-195"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:nodeTopologyFile:CardanoNodeArgs :: String
</span><a href="CardanoNode.html#%24sel%3AnodeTopologyFile%3ACardanoNodeArgs"><span class="hs-identifier hs-var">nodeTopologyFile</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;cardano-node/topology.json&quot;</span></span><span>
</span><span id="line-196"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:nodeByronGenesisFile:CardanoNodeArgs :: String
</span><a href="CardanoNode.html#%24sel%3AnodeByronGenesisFile%3ACardanoNodeArgs"><span class="hs-identifier hs-var">nodeByronGenesisFile</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;genesis/byron.json&quot;</span></span><span>
</span><span id="line-197"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:nodeShelleyGenesisFile:CardanoNodeArgs :: String
</span><a href="CardanoNode.html#%24sel%3AnodeShelleyGenesisFile%3ACardanoNodeArgs"><span class="hs-identifier hs-var">nodeShelleyGenesisFile</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;genesis/shelley.json&quot;</span></span><span>
</span><span id="line-198"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">$sel:nodeAlonzoGenesisFile:CardanoNodeArgs :: String
</span><a href="CardanoNode.html#%24sel%3AnodeAlonzoGenesisFile%3ACardanoNodeArgs"><span class="hs-identifier hs-var">nodeAlonzoGenesisFile</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;genesis/alonzo.json&quot;</span></span><span>
</span><span id="line-199"></span><span>      </span><span class="hs-special">}</span><span>
</span><span id="line-200"></span><span>
</span><span id="line-201"></span><span>  </span><span class="hs-comment">-- Read 'NetworkId' from shelley genesis</span><span>
</span><span id="line-202"></span><span>  </span><span id="local-6989586621679327923"><span class="annot"><span class="annottext">readNetworkId :: IO NetworkId
</span><a href="#local-6989586621679327923"><span class="hs-identifier hs-var hs-var">readNetworkId</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-203"></span><span>    </span><span id="local-6989586621679327919"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679327919"><span class="hs-identifier hs-var">shelleyGenesis</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Aeson.Value</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; IO Value
forall a. FromJSON a =&gt; ByteString -&gt; IO a
</span><a href="CardanoNode.html#unsafeDecodeJson"><span class="hs-identifier hs-var">unsafeDecodeJson</span></a></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; IO Value) -&gt; IO ByteString -&gt; IO Value
forall (m :: * -&gt; *) a b. Monad m =&gt; (a -&gt; m b) -&gt; m a -&gt; m b
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">=&lt;&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; IO ByteString
</span><a href="Hydra.Cluster.Util.html#readConfigFile"><span class="hs-identifier hs-var">readConfigFile</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679327916"><span class="hs-identifier hs-var">knownNetworkPath</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
</span><span class="hs-operator hs-var">&lt;/&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;genesis&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
</span><span class="hs-operator hs-var">&lt;/&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;shelley.json&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-204"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679327919"><span class="hs-identifier hs-var">shelleyGenesis</span></a></span><span> </span><span class="annot"><span class="annottext">Value -&gt; Getting (Endo Value) Value Value -&gt; Value
forall s a. HasCallStack =&gt; s -&gt; Getting (Endo a) s a -&gt; a
</span><span class="hs-operator hs-var">^?!</span></span><span> </span><span class="annot"><span class="annottext">Key -&gt; Traversal' Value Value
forall t. AsValue t =&gt; Key -&gt; Traversal' t Value
</span><span class="hs-identifier hs-var">key</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;networkId&quot;</span></span><span> </span><span class="annot"><span class="annottext">Value -&gt; Value -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Value
</span><span class="hs-string">&quot;Mainnet&quot;</span></span><span>
</span><span id="line-205"></span><span>      </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">NetworkId -&gt; IO NetworkId
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(NetworkId -&gt; IO NetworkId) -&gt; NetworkId -&gt; IO NetworkId
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">NetworkId
</span><span class="hs-identifier hs-var">Api.Mainnet</span></span><span>
</span><span id="line-206"></span><span>      </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-207"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679327914"><span class="annot"><span class="annottext">magic :: Scientific
</span><a href="#local-6989586621679327914"><span class="hs-identifier hs-var hs-var">magic</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679327919"><span class="hs-identifier hs-var">shelleyGenesis</span></a></span><span> </span><span class="annot"><span class="annottext">Value -&gt; Getting (Endo Scientific) Value Scientific -&gt; Scientific
forall s a. HasCallStack =&gt; s -&gt; Getting (Endo a) s a -&gt; a
</span><span class="hs-operator hs-var">^?!</span></span><span> </span><span class="annot"><span class="annottext">Key -&gt; Traversal' Value Value
forall t. AsValue t =&gt; Key -&gt; Traversal' t Value
</span><span class="hs-identifier hs-var">key</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;networkMagic&quot;</span></span><span> </span><span class="annot"><span class="annottext">((Value -&gt; Const (Endo Scientific) Value)
 -&gt; Value -&gt; Const (Endo Scientific) Value)
-&gt; Getting (Endo Scientific) Value Scientific
-&gt; Getting (Endo Scientific) Value Scientific
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Getting (Endo Scientific) Value Scientific
forall t. AsNumber t =&gt; Prism' t Scientific
</span><span class="hs-identifier hs-var">_Number</span></span><span>
</span><span id="line-208"></span><span>        </span><span class="annot"><span class="annottext">NetworkId -&gt; IO NetworkId
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(NetworkId -&gt; IO NetworkId) -&gt; NetworkId -&gt; IO NetworkId
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">NetworkMagic -&gt; NetworkId
</span><span class="hs-identifier hs-var">Api.Testnet</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word32 -&gt; NetworkMagic
</span><span class="hs-identifier hs-var">Api.NetworkMagic</span></span><span> </span><span class="annot"><span class="annottext">(Word32 -&gt; NetworkMagic) -&gt; Word32 -&gt; NetworkMagic
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Scientific -&gt; Word32
forall a b. (RealFrac a, Integral b) =&gt; a -&gt; b
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">truncate</span></a></span><span> </span><span class="annot"><span class="annottext">Scientific
</span><a href="#local-6989586621679327914"><span class="hs-identifier hs-var">magic</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-209"></span><span>
</span><span id="line-210"></span><span>  </span><span id="local-6989586621679327922"><span class="annot"><span class="annottext">copyKnownNetworkFiles :: IO ()
</span><a href="#local-6989586621679327922"><span class="hs-identifier hs-var hs-var">copyKnownNetworkFiles</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-211"></span><span>    </span><span class="annot"><span class="annottext">[String] -&gt; (String -&gt; IO ()) -&gt; IO ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m ()
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">forM_</span></a></span><span>
</span><span id="line-212"></span><span>      </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;cardano-node&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
</span><span class="hs-operator hs-var">&lt;/&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;config.json&quot;</span></span><span>
</span><span id="line-213"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;cardano-node&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
</span><span class="hs-operator hs-var">&lt;/&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;topology.json&quot;</span></span><span>
</span><span id="line-214"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;genesis&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
</span><span class="hs-operator hs-var">&lt;/&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;byron.json&quot;</span></span><span>
</span><span id="line-215"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;genesis&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
</span><span class="hs-operator hs-var">&lt;/&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;shelley.json&quot;</span></span><span>
</span><span id="line-216"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;genesis&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
</span><span class="hs-operator hs-var">&lt;/&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;alonzo.json&quot;</span></span><span>
</span><span id="line-217"></span><span>      </span><span class="hs-special">]</span><span>
</span><span id="line-218"></span><span>      </span><span class="annot"><span class="annottext">((String -&gt; IO ()) -&gt; IO ()) -&gt; (String -&gt; IO ()) -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679327908"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679327908"><span class="hs-identifier hs-var">fn</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IO Bool -&gt; IO () -&gt; IO ()
forall (m :: * -&gt; *). Monad m =&gt; m Bool -&gt; m () -&gt; m ()
</span><span class="hs-identifier hs-var">unlessM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; IO Bool
</span><span class="hs-identifier hs-var">doesFileExist</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO Bool) -&gt; String -&gt; IO Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679327927"><span class="hs-identifier hs-var">workDir</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
</span><span class="hs-operator hs-var">&lt;/&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679327908"><span class="hs-identifier hs-var">fn</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ()) -&gt; IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-219"></span><span>        </span><span class="annot"><span class="annottext">Bool -&gt; String -&gt; IO ()
</span><span class="hs-identifier hs-var">createDirectoryIfMissing</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">True</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679327927"><span class="hs-identifier hs-var">workDir</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
</span><span class="hs-operator hs-var">&lt;/&gt;</span></span><span> </span><span class="annot"><span class="annottext">ShowS
</span><span class="hs-identifier hs-var">takeDirectory</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679327908"><span class="hs-identifier hs-var">fn</span></a></span><span>
</span><span id="line-220"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; IO ByteString
</span><a href="Hydra.Cluster.Util.html#readConfigFile"><span class="hs-identifier hs-var">readConfigFile</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679327916"><span class="hs-identifier hs-var">knownNetworkPath</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
</span><span class="hs-operator hs-var">&lt;/&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679327908"><span class="hs-identifier hs-var">fn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-221"></span><span>          </span><span class="annot"><span class="annottext">IO ByteString -&gt; (ByteString -&gt; IO ()) -&gt; IO ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ByteString -&gt; IO ()
forall (m :: * -&gt; *). MonadIO m =&gt; String -&gt; ByteString -&gt; m ()
</span><span class="hs-identifier hs-var">writeFileBS</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679327927"><span class="hs-identifier hs-var">workDir</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
</span><span class="hs-operator hs-var">&lt;/&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679327908"><span class="hs-identifier hs-var">fn</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-222"></span><span>
</span><span id="line-223"></span><span>  </span><span class="hs-comment">-- Folder name in config/cardano-configurations/network</span><span>
</span><span id="line-224"></span><span>  </span><span id="local-6989586621679327907"><span class="annot"><span class="annottext">knownNetworkName :: String
</span><a href="#local-6989586621679327907"><span class="hs-identifier hs-var hs-var">knownNetworkName</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">KnownNetwork
</span><a href="#local-6989586621679327926"><span class="hs-identifier hs-var">knownNetwork</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-225"></span><span>    </span><span class="annot"><span class="annottext">KnownNetwork
</span><a href="Hydra.Cluster.Fixture.html#Preview"><span class="hs-identifier hs-var">Preview</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;preview&quot;</span></span><span>
</span><span id="line-226"></span><span>    </span><span class="annot"><span class="annottext">KnownNetwork
</span><a href="Hydra.Cluster.Fixture.html#Preproduction"><span class="hs-identifier hs-var">Preproduction</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;preprod&quot;</span></span><span>
</span><span id="line-227"></span><span>    </span><span class="annot"><span class="annottext">KnownNetwork
</span><a href="Hydra.Cluster.Fixture.html#Mainnet"><span class="hs-identifier hs-var">Mainnet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;mainnet&quot;</span></span><span>
</span><span id="line-228"></span><span>
</span><span id="line-229"></span><span>  </span><span id="local-6989586621679327916"><span class="annot"><span class="annottext">knownNetworkPath :: String
</span><a href="#local-6989586621679327916"><span class="hs-identifier hs-var hs-var">knownNetworkPath</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-230"></span><span>    </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;cardano-configurations&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
</span><span class="hs-operator hs-var">&lt;/&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;network&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
</span><span class="hs-operator hs-var">&lt;/&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679327907"><span class="hs-identifier hs-var">knownNetworkName</span></a></span><span>
</span><span id="line-231"></span><span>
</span><span id="line-232"></span><span id="local-6989586621679328236"><span class="annot"><a href="CardanoNode.html#withCardanoNode"><span class="hs-identifier hs-type">withCardanoNode</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-233"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Tracer</span></span><span> </span><span class="annot"><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="CardanoNode.html#NodeLog"><span class="hs-identifier hs-type">NodeLog</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-234"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">NetworkId</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-235"></span><span>  </span><span class="annot"><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">FilePath</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-236"></span><span>  </span><span class="annot"><a href="CardanoNode.html#CardanoNodeArgs"><span class="hs-identifier hs-type">CardanoNodeArgs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-237"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="CardanoNode.html#RunningNode"><span class="hs-identifier hs-type">RunningNode</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679328236"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-238"></span><span>  </span><span class="annot"><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679328236"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-239"></span><span id="withCardanoNode"><span class="annot"><span class="annottext">withCardanoNode :: Tracer IO NodeLog
-&gt; NetworkId
-&gt; String
-&gt; CardanoNodeArgs
-&gt; (RunningNode -&gt; IO a)
-&gt; IO a
</span><a href="CardanoNode.html#withCardanoNode"><span class="hs-identifier hs-var hs-var">withCardanoNode</span></a></span></span><span> </span><span id="local-6989586621679327906"><span class="annot"><span class="annottext">Tracer IO NodeLog
</span><a href="#local-6989586621679327906"><span class="hs-identifier hs-var">tr</span></a></span></span><span> </span><span id="local-6989586621679327905"><span class="annot"><span class="annottext">NetworkId
</span><a href="#local-6989586621679327905"><span class="hs-identifier hs-var">networkId</span></a></span></span><span> </span><span id="local-6989586621679327904"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679327904"><span class="hs-identifier hs-var">stateDirectory</span></a></span></span><span> </span><span id="local-6989586621679327903"><span class="annot"><span class="annottext">args :: CardanoNodeArgs
</span><a href="#local-6989586621679327903"><span class="hs-identifier hs-var">args</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="CardanoNode.html#CardanoNodeArgs"><span class="hs-identifier hs-type">CardanoNodeArgs</span></a></span><span class="hs-special">{</span><span id="local-6989586621679327902"><span class="annot"><span class="annottext">String
nodeSocket :: String
$sel:nodeSocket:CardanoNodeArgs :: CardanoNodeArgs -&gt; String
</span><a href="#local-6989586621679327902"><span class="hs-identifier hs-var hs-var">nodeSocket</span></a></span></span><span class="hs-special">}</span><span> </span><span id="local-6989586621679327901"><span class="annot"><span class="annottext">RunningNode -&gt; IO a
</span><a href="#local-6989586621679327901"><span class="hs-identifier hs-var">action</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-240"></span><span>  </span><span class="annot"><span class="annottext">Tracer IO NodeLog -&gt; NodeLog -&gt; IO ()
forall (m :: * -&gt; *) a. Tracer m a -&gt; a -&gt; m ()
</span><span class="hs-identifier hs-var">traceWith</span></span><span> </span><span class="annot"><span class="annottext">Tracer IO NodeLog
</span><a href="#local-6989586621679327906"><span class="hs-identifier hs-var">tr</span></a></span><span> </span><span class="annot"><span class="annottext">(NodeLog -&gt; IO ()) -&gt; NodeLog -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; NodeLog
</span><a href="CardanoNode.html#MsgNodeCmdSpec"><span class="hs-identifier hs-var">MsgNodeCmdSpec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CmdSpec -&gt; Text
forall b a. (Show a, IsString b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">(CmdSpec -&gt; Text) -&gt; CmdSpec -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">CreateProcess -&gt; CmdSpec
</span><span class="hs-identifier hs-var hs-var">cmdspec</span></span><span> </span><span class="annot"><span class="annottext">CreateProcess
</span><a href="#local-6989586621679327897"><span class="hs-identifier hs-var">process</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-241"></span><span>  </span><span class="annot"><span class="annottext">Tracer IO NodeLog -&gt; NodeLog -&gt; IO ()
forall (m :: * -&gt; *) a. Tracer m a -&gt; a -&gt; m ()
</span><span class="hs-identifier hs-var">traceWith</span></span><span> </span><span class="annot"><span class="annottext">Tracer IO NodeLog
</span><a href="#local-6989586621679327906"><span class="hs-identifier hs-var">tr</span></a></span><span> </span><span class="annot"><span class="annottext">(NodeLog -&gt; IO ()) -&gt; NodeLog -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">MsgNodeStarting :: String -&gt; NodeLog
</span><a href="CardanoNode.html#MsgNodeStarting"><span class="hs-identifier hs-type">MsgNodeStarting</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">String
$sel:stateDirectory:MsgNodeCmdSpec :: String
stateDirectory :: String
</span><a href="CardanoNode.html#%24sel%3AstateDirectory%3AMsgNodeCmdSpec"><span class="hs-identifier hs-var hs-var">stateDirectory</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-242"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; (Handle -&gt; IO a) -&gt; IO a
forall a. String -&gt; (Handle -&gt; IO a) -&gt; IO a
</span><span class="hs-identifier hs-var">withLogFile</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679327893"><span class="hs-identifier hs-var">logFilePath</span></a></span><span> </span><span class="annot"><span class="annottext">((Handle -&gt; IO a) -&gt; IO a) -&gt; (Handle -&gt; IO a) -&gt; IO a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679327892"><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679327892"><span class="hs-identifier hs-var">out</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-243"></span><span>    </span><span class="annot"><span class="annottext">Handle -&gt; BufferMode -&gt; IO ()
forall (m :: * -&gt; *). MonadIO m =&gt; Handle -&gt; BufferMode -&gt; m ()
</span><span class="hs-identifier hs-var">hSetBuffering</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679327892"><span class="hs-identifier hs-var">out</span></a></span><span> </span><span class="annot"><span class="annottext">BufferMode
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">NoBuffering</span></a></span><span>
</span><span id="line-244"></span><span>    </span><span class="annot"><span class="annottext">CreateProcess
-&gt; (Maybe Handle
    -&gt; Maybe Handle -&gt; Maybe Handle -&gt; ProcessHandle -&gt; IO a)
-&gt; IO a
forall a.
CreateProcess
-&gt; (Maybe Handle
    -&gt; Maybe Handle -&gt; Maybe Handle -&gt; ProcessHandle -&gt; IO a)
-&gt; IO a
</span><span class="hs-identifier hs-var">withCreateProcess</span></span><span> </span><span class="annot"><span class="annottext">CreateProcess
</span><a href="#local-6989586621679327897"><span class="hs-identifier hs-var">process</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">std_out :: StdStream
</span><a href="#local-6989586621679327889"><span class="hs-identifier hs-var">std_out</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Handle -&gt; StdStream
</span><span class="hs-identifier hs-var">UseHandle</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679327892"><span class="hs-identifier hs-var">out</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">std_err :: StdStream
</span><a href="#local-6989586621679327888"><span class="hs-identifier hs-var">std_err</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Handle -&gt; StdStream
</span><span class="hs-identifier hs-var">UseHandle</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679327892"><span class="hs-identifier hs-var">out</span></a></span><span class="hs-special">}</span><span> </span><span class="annot"><span class="annottext">((Maybe Handle
  -&gt; Maybe Handle -&gt; Maybe Handle -&gt; ProcessHandle -&gt; IO a)
 -&gt; IO a)
-&gt; (Maybe Handle
    -&gt; Maybe Handle -&gt; Maybe Handle -&gt; ProcessHandle -&gt; IO a)
-&gt; IO a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-245"></span><span>      </span><span class="hs-glyph">\</span><span id="local-6989586621679327887"><span class="annot"><span class="annottext">Maybe Handle
</span><a href="#local-6989586621679327887"><span class="hs-identifier hs-var">_stdin</span></a></span></span><span> </span><span id="local-6989586621679327886"><span class="annot"><span class="annottext">Maybe Handle
</span><a href="#local-6989586621679327886"><span class="hs-identifier hs-var">_stdout</span></a></span></span><span> </span><span id="local-6989586621679327885"><span class="annot"><span class="annottext">Maybe Handle
</span><a href="#local-6989586621679327885"><span class="hs-identifier hs-var">_stderr</span></a></span></span><span> </span><span id="local-6989586621679327884"><span class="annot"><span class="annottext">ProcessHandle
</span><a href="#local-6989586621679327884"><span class="hs-identifier hs-var">processHandle</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-246"></span><span>        </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">IO Void -&gt; IO a -&gt; IO (Either Void a)
forall (m :: * -&gt; *) a b.
MonadAsync m =&gt;
m a -&gt; m b -&gt; m (Either a b)
</span><span class="hs-identifier hs-var">race</span></span><span>
</span><span id="line-247"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text -&gt; ProcessHandle -&gt; IO Void
</span><span class="hs-identifier hs-var">checkProcessHasNotDied</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;cardano-node&quot;</span></span><span> </span><span class="annot"><span class="annottext">ProcessHandle
</span><a href="#local-6989586621679327884"><span class="hs-identifier hs-var">processHandle</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-248"></span><span>            </span><span class="annot"><span class="annottext">IO a
</span><a href="#local-6989586621679327881"><span class="hs-identifier hs-var">waitForNode</span></a></span><span>
</span><span id="line-249"></span><span>            </span><span class="annot"><span class="annottext">IO (Either Void a) -&gt; (Either Void a -&gt; IO a) -&gt; IO a
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-250"></span><span>              </span><span class="annot"><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Left</span></a></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Text -&gt; IO a
forall a t. (HasCallStack, IsText t) =&gt; t -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;should never been reached&quot;</span></span><span>
</span><span id="line-251"></span><span>              </span><span class="annot"><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span id="local-6989586621679327879"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679327879"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679327879"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-252"></span><span>        </span><span class="hs-special">)</span><span>
</span><span id="line-253"></span><span>          </span><span class="annot"><span class="annottext">IO a -&gt; IO () -&gt; IO a
forall (m :: * -&gt; *) a b. MonadThrow m =&gt; m a -&gt; m b -&gt; m a
</span><span class="hs-operator hs-var">`finally`</span></span><span> </span><span class="annot"><span class="annottext">IO ()
</span><a href="#local-6989586621679327877"><span class="hs-identifier hs-var">cleanupSocketFile</span></a></span><span>
</span><span id="line-254"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-255"></span><span>  </span><span id="local-6989586621679327897"><span class="annot"><span class="annottext">process :: CreateProcess
</span><a href="#local-6989586621679327897"><span class="hs-identifier hs-var hs-var">process</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe String -&gt; CardanoNodeArgs -&gt; CreateProcess
</span><a href="CardanoNode.html#cardanoNodeProcess"><span class="hs-identifier hs-var">cardanoNodeProcess</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Maybe String
forall a. a -&gt; Maybe a
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679327904"><span class="hs-identifier hs-var">stateDirectory</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CardanoNodeArgs
</span><a href="#local-6989586621679327903"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-256"></span><span>
</span><span id="line-257"></span><span>  </span><span id="local-6989586621679327893"><span class="annot"><span class="annottext">logFilePath :: String
</span><a href="#local-6989586621679327893"><span class="hs-identifier hs-var hs-var">logFilePath</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679327904"><span class="hs-identifier hs-var">stateDirectory</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
</span><span class="hs-operator hs-var">&lt;/&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;logs&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
</span><span class="hs-operator hs-var">&lt;/&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;cardano-node.log&quot;</span></span><span>
</span><span id="line-258"></span><span>
</span><span id="line-259"></span><span>  </span><span id="local-6989586621679327875"><span class="annot"><span class="annottext">socketPath :: String
</span><a href="#local-6989586621679327875"><span class="hs-identifier hs-var hs-var">socketPath</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679327904"><span class="hs-identifier hs-var">stateDirectory</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
</span><span class="hs-operator hs-var">&lt;/&gt;</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679327902"><span class="hs-identifier hs-var">nodeSocket</span></a></span><span>
</span><span id="line-260"></span><span>
</span><span id="line-261"></span><span>  </span><span id="local-6989586621679327881"><span class="annot"><span class="annottext">waitForNode :: IO a
</span><a href="#local-6989586621679327881"><span class="hs-identifier hs-var hs-var">waitForNode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-262"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679327874"><span class="annot"><span class="annottext">rn :: RunningNode
</span><a href="#local-6989586621679327874"><span class="hs-identifier hs-var hs-var">rn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">RunningNode :: String -&gt; NetworkId -&gt; RunningNode
</span><a href="CardanoNode.html#RunningNode"><span class="hs-identifier hs-type">RunningNode</span></a></span><span class="hs-special">{</span><span class="annot"><span class="annottext">$sel:nodeSocket:RunningNode :: String
</span><a href="CardanoNode.html#%24sel%3AnodeSocket%3ARunningNode"><span class="hs-identifier hs-var">nodeSocket</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679327875"><span class="hs-identifier hs-var">socketPath</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NetworkId
networkId :: NetworkId
$sel:networkId:RunningNode :: NetworkId
</span><a href="#local-6989586621679327905"><span class="hs-identifier hs-var hs-var">networkId</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-263"></span><span>    </span><span class="annot"><span class="annottext">RunningNode -&gt; IO ()
</span><a href="CardanoNode.html#waitForSocket"><span class="hs-identifier hs-var">waitForSocket</span></a></span><span> </span><span class="annot"><span class="annottext">RunningNode
</span><a href="#local-6989586621679327874"><span class="hs-identifier hs-var">rn</span></a></span><span>
</span><span id="line-264"></span><span>    </span><span class="annot"><span class="annottext">Tracer IO NodeLog -&gt; NodeLog -&gt; IO ()
forall (m :: * -&gt; *) a. Tracer m a -&gt; a -&gt; m ()
</span><span class="hs-identifier hs-var">traceWith</span></span><span> </span><span class="annot"><span class="annottext">Tracer IO NodeLog
</span><a href="#local-6989586621679327906"><span class="hs-identifier hs-var">tr</span></a></span><span> </span><span class="annot"><span class="annottext">(NodeLog -&gt; IO ()) -&gt; NodeLog -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; NodeLog
</span><a href="CardanoNode.html#MsgSocketIsReady"><span class="hs-identifier hs-var">MsgSocketIsReady</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679327875"><span class="hs-identifier hs-var">socketPath</span></a></span><span>
</span><span id="line-265"></span><span>    </span><span class="annot"><span class="annottext">RunningNode -&gt; IO a
</span><a href="#local-6989586621679327901"><span class="hs-identifier hs-var">action</span></a></span><span> </span><span class="annot"><span class="annottext">RunningNode
</span><a href="#local-6989586621679327874"><span class="hs-identifier hs-var">rn</span></a></span><span>
</span><span id="line-266"></span><span>
</span><span id="line-267"></span><span>  </span><span id="local-6989586621679327877"><span class="annot"><span class="annottext">cleanupSocketFile :: IO ()
</span><a href="#local-6989586621679327877"><span class="hs-identifier hs-var hs-var">cleanupSocketFile</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-268"></span><span>    </span><span class="annot"><span class="annottext">IO Bool -&gt; IO () -&gt; IO ()
forall (m :: * -&gt; *). Monad m =&gt; m Bool -&gt; m () -&gt; m ()
</span><span class="hs-identifier hs-var">whenM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; IO Bool
</span><span class="hs-identifier hs-var">doesFileExist</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679327875"><span class="hs-identifier hs-var">socketPath</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ()) -&gt; IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-269"></span><span>      </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">removeFile</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679327875"><span class="hs-identifier hs-var">socketPath</span></a></span><span>
</span><span id="line-270"></span><span>
</span><span id="line-271"></span><span class="hs-comment">-- | Wait for the node socket file to become available.</span><span>
</span><span id="line-272"></span><span class="annot"><a href="CardanoNode.html#waitForSocket"><span class="hs-identifier hs-type">waitForSocket</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="CardanoNode.html#RunningNode"><span class="hs-identifier hs-type">RunningNode</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-273"></span><span id="waitForSocket"><span class="annot"><span class="annottext">waitForSocket :: RunningNode -&gt; IO ()
</span><a href="CardanoNode.html#waitForSocket"><span class="hs-identifier hs-var hs-var">waitForSocket</span></a></span></span><span> </span><span id="local-6989586621679327870"><span class="annot"><span class="annottext">node :: RunningNode
</span><a href="#local-6989586621679327870"><span class="hs-identifier hs-var">node</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="CardanoNode.html#RunningNode"><span class="hs-identifier hs-type">RunningNode</span></a></span><span class="hs-special">{</span><span id="local-6989586621679327869"><span class="annot"><span class="annottext">String
nodeSocket :: String
$sel:nodeSocket:RunningNode :: RunningNode -&gt; String
</span><a href="#local-6989586621679327869"><span class="hs-identifier hs-var hs-var">nodeSocket</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-274"></span><span>  </span><span class="annot"><span class="annottext">IO Bool -&gt; IO () -&gt; IO ()
forall (m :: * -&gt; *). Monad m =&gt; m Bool -&gt; m () -&gt; m ()
</span><span class="hs-identifier hs-var">unlessM</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; IO Bool
</span><span class="hs-identifier hs-var">doesFileExist</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679327869"><span class="hs-identifier hs-var">nodeSocket</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; IO ()) -&gt; IO () -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-275"></span><span>    </span><span class="annot"><span class="annottext">DiffTime -&gt; IO ()
forall (m :: * -&gt; *). MonadDelay m =&gt; DiffTime -&gt; m ()
</span><span class="hs-identifier hs-var">threadDelay</span></span><span> </span><span class="annot"><span class="annottext">DiffTime
</span><span class="hs-number">0.1</span></span><span>
</span><span id="line-276"></span><span>    </span><span class="annot"><span class="annottext">RunningNode -&gt; IO ()
</span><a href="CardanoNode.html#waitForSocket"><span class="hs-identifier hs-var">waitForSocket</span></a></span><span> </span><span class="annot"><span class="annottext">RunningNode
</span><a href="#local-6989586621679327870"><span class="hs-identifier hs-var">node</span></a></span><span>
</span><span id="line-277"></span><span>
</span><span id="line-278"></span><span class="hs-comment">-- | Generate command-line arguments for launching @cardano-node@.</span><span>
</span><span id="line-279"></span><span class="annot"><a href="CardanoNode.html#cardanoNodeProcess"><span class="hs-identifier hs-type">cardanoNodeProcess</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">FilePath</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="CardanoNode.html#CardanoNodeArgs"><span class="hs-identifier hs-type">CardanoNodeArgs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">CreateProcess</span></span><span>
</span><span id="line-280"></span><span id="cardanoNodeProcess"><span class="annot"><span class="annottext">cardanoNodeProcess :: Maybe String -&gt; CardanoNodeArgs -&gt; CreateProcess
</span><a href="CardanoNode.html#cardanoNodeProcess"><span class="hs-identifier hs-var hs-var">cardanoNodeProcess</span></a></span></span><span> </span><span id="local-6989586621679327867"><span class="annot"><span class="annottext">Maybe String
</span><a href="#local-6989586621679327867"><span class="hs-identifier hs-var">cwd</span></a></span></span><span> </span><span id="local-6989586621679327866"><span class="annot"><span class="annottext">CardanoNodeArgs
</span><a href="#local-6989586621679327866"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-281"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; [String] -&gt; CreateProcess
</span><span class="hs-identifier hs-var">proc</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;cardano-node&quot;</span></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679327865"><span class="hs-identifier hs-var">strArgs</span></a></span><span class="hs-special">)</span><span class="hs-special">{</span><span class="annot"><span class="annottext">Maybe String
cwd :: Maybe String
cwd :: Maybe String
</span><span class="hs-identifier hs-var hs-var">cwd</span></span><span class="hs-special">}</span><span>
</span><span id="line-282"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-283"></span><span>  </span><span class="annot"><a href="CardanoNode.html#CardanoNodeArgs"><span class="hs-identifier hs-type">CardanoNodeArgs</span></a></span><span>
</span><span id="line-284"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="local-6989586621679327863"><span class="annot"><span class="annottext">String
nodeConfigFile :: String
$sel:nodeConfigFile:CardanoNodeArgs :: CardanoNodeArgs -&gt; String
</span><a href="#local-6989586621679327863"><span class="hs-identifier hs-var hs-var">nodeConfigFile</span></a></span></span><span>
</span><span id="line-285"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="local-6989586621679327862"><span class="annot"><span class="annottext">String
nodeTopologyFile :: String
$sel:nodeTopologyFile:CardanoNodeArgs :: CardanoNodeArgs -&gt; String
</span><a href="#local-6989586621679327862"><span class="hs-identifier hs-var hs-var">nodeTopologyFile</span></a></span></span><span>
</span><span id="line-286"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="local-6989586621679327861"><span class="annot"><span class="annottext">String
nodeDatabaseDir :: String
$sel:nodeDatabaseDir:CardanoNodeArgs :: CardanoNodeArgs -&gt; String
</span><a href="#local-6989586621679327861"><span class="hs-identifier hs-var hs-var">nodeDatabaseDir</span></a></span></span><span>
</span><span id="line-287"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="local-6989586621679327860"><span class="annot"><span class="annottext">String
nodeSocket :: String
$sel:nodeSocket:CardanoNodeArgs :: CardanoNodeArgs -&gt; String
</span><a href="#local-6989586621679327860"><span class="hs-identifier hs-var hs-var">nodeSocket</span></a></span></span><span>
</span><span id="line-288"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="local-6989586621679327859"><span class="annot"><span class="annottext">Maybe Int
nodePort :: Maybe Int
$sel:nodePort:CardanoNodeArgs :: CardanoNodeArgs -&gt; Maybe Int
</span><a href="#local-6989586621679327859"><span class="hs-identifier hs-var hs-var">nodePort</span></a></span></span><span>
</span><span id="line-289"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="local-6989586621679327858"><span class="annot"><span class="annottext">Maybe String
nodeSignKeyFile :: Maybe String
$sel:nodeSignKeyFile:CardanoNodeArgs :: CardanoNodeArgs -&gt; Maybe String
</span><a href="#local-6989586621679327858"><span class="hs-identifier hs-var hs-var">nodeSignKeyFile</span></a></span></span><span>
</span><span id="line-290"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="local-6989586621679327857"><span class="annot"><span class="annottext">Maybe String
nodeDlgCertFile :: Maybe String
$sel:nodeDlgCertFile:CardanoNodeArgs :: CardanoNodeArgs -&gt; Maybe String
</span><a href="#local-6989586621679327857"><span class="hs-identifier hs-var hs-var">nodeDlgCertFile</span></a></span></span><span>
</span><span id="line-291"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="local-6989586621679327856"><span class="annot"><span class="annottext">Maybe String
nodeOpCertFile :: Maybe String
$sel:nodeOpCertFile:CardanoNodeArgs :: CardanoNodeArgs -&gt; Maybe String
</span><a href="#local-6989586621679327856"><span class="hs-identifier hs-var hs-var">nodeOpCertFile</span></a></span></span><span>
</span><span id="line-292"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="local-6989586621679327855"><span class="annot"><span class="annottext">Maybe String
nodeKesKeyFile :: Maybe String
$sel:nodeKesKeyFile:CardanoNodeArgs :: CardanoNodeArgs -&gt; Maybe String
</span><a href="#local-6989586621679327855"><span class="hs-identifier hs-var hs-var">nodeKesKeyFile</span></a></span></span><span>
</span><span id="line-293"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="local-6989586621679327854"><span class="annot"><span class="annottext">Maybe String
nodeVrfKeyFile :: Maybe String
$sel:nodeVrfKeyFile:CardanoNodeArgs :: CardanoNodeArgs -&gt; Maybe String
</span><a href="#local-6989586621679327854"><span class="hs-identifier hs-var hs-var">nodeVrfKeyFile</span></a></span></span><span>
</span><span id="line-294"></span><span>    </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CardanoNodeArgs
</span><a href="#local-6989586621679327866"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-295"></span><span>
</span><span id="line-296"></span><span>  </span><span id="local-6989586621679327865"><span class="annot"><span class="annottext">strArgs :: [String]
</span><a href="#local-6989586621679327865"><span class="hs-identifier hs-var hs-var">strArgs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-297"></span><span>    </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;run&quot;</span></span><span>
</span><span id="line-298"></span><span>      </span><span class="annot"><span class="annottext">String -&gt; [String] -&gt; [String]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[[String]] -&gt; [String]
forall a. Monoid a =&gt; [a] -&gt; a
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">mconcat</span></a></span><span>
</span><span id="line-299"></span><span>        </span><span class="hs-special">[</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;--config&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679327863"><span class="hs-identifier hs-var">nodeConfigFile</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-300"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;--topology&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679327862"><span class="hs-identifier hs-var">nodeTopologyFile</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-301"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;--database-path&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679327861"><span class="hs-identifier hs-var">nodeDatabaseDir</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-302"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;--socket-path&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679327860"><span class="hs-identifier hs-var">nodeSocket</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-303"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Maybe String -&gt; [String]
forall a. a -&gt; Maybe a -&gt; [a]
</span><a href="#local-6989586621679327853"><span class="hs-identifier hs-var">opt</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;--port&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; String
forall b a. (Show a, IsString b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; String) -&gt; Maybe Int -&gt; Maybe String
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621679327859"><span class="hs-identifier hs-var">nodePort</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-304"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Maybe String -&gt; [String]
forall a. a -&gt; Maybe a -&gt; [a]
</span><a href="#local-6989586621679327853"><span class="hs-identifier hs-var">opt</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;--byron-signing-key&quot;</span></span><span> </span><span class="annot"><span class="annottext">Maybe String
</span><a href="#local-6989586621679327858"><span class="hs-identifier hs-var">nodeSignKeyFile</span></a></span><span>
</span><span id="line-305"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Maybe String -&gt; [String]
forall a. a -&gt; Maybe a -&gt; [a]
</span><a href="#local-6989586621679327853"><span class="hs-identifier hs-var">opt</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;--byron-delegation-certificate&quot;</span></span><span> </span><span class="annot"><span class="annottext">Maybe String
</span><a href="#local-6989586621679327857"><span class="hs-identifier hs-var">nodeDlgCertFile</span></a></span><span>
</span><span id="line-306"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Maybe String -&gt; [String]
forall a. a -&gt; Maybe a -&gt; [a]
</span><a href="#local-6989586621679327853"><span class="hs-identifier hs-var">opt</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;--shelley-operational-certificate&quot;</span></span><span> </span><span class="annot"><span class="annottext">Maybe String
</span><a href="#local-6989586621679327856"><span class="hs-identifier hs-var">nodeOpCertFile</span></a></span><span>
</span><span id="line-307"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Maybe String -&gt; [String]
forall a. a -&gt; Maybe a -&gt; [a]
</span><a href="#local-6989586621679327853"><span class="hs-identifier hs-var">opt</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;--shelley-kes-key&quot;</span></span><span> </span><span class="annot"><span class="annottext">Maybe String
</span><a href="#local-6989586621679327855"><span class="hs-identifier hs-var">nodeKesKeyFile</span></a></span><span>
</span><span id="line-308"></span><span>        </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">String -&gt; Maybe String -&gt; [String]
forall a. a -&gt; Maybe a -&gt; [a]
</span><a href="#local-6989586621679327853"><span class="hs-identifier hs-var">opt</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;--shelley-vrf-key&quot;</span></span><span> </span><span class="annot"><span class="annottext">Maybe String
</span><a href="#local-6989586621679327854"><span class="hs-identifier hs-var">nodeVrfKeyFile</span></a></span><span>
</span><span id="line-309"></span><span>        </span><span class="hs-special">]</span><span>
</span><span id="line-310"></span><span>
</span><span id="line-311"></span><span>  </span><span id="local-6989586621679328160"><span class="annot"><a href="#local-6989586621679327853"><span class="hs-identifier hs-type">opt</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679328160"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679328160"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679328160"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span></span><span>
</span><span id="line-312"></span><span>  </span><span id="local-6989586621679327853"><span class="annot"><span class="annottext">opt :: a -&gt; Maybe a -&gt; [a]
</span><a href="#local-6989586621679327853"><span class="hs-identifier hs-var hs-var">opt</span></a></span></span><span> </span><span id="local-6989586621679327851"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679327851"><span class="hs-identifier hs-var">arg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-313"></span><span>    </span><span class="annot"><span class="annottext">Maybe a
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-314"></span><span>    </span><span class="annot"><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679327850"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679327850"><span class="hs-identifier hs-var">val</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679327851"><span class="hs-identifier hs-var">arg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679327850"><span class="hs-identifier hs-var">val</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-315"></span><span>
</span><span id="line-316"></span><span class="hs-comment">-- | Initialize the system start time to now (modulo a small offset needed to</span><span>
</span><span id="line-317"></span><span class="hs-comment">-- give time to the system to bootstrap correctly).</span><span>
</span><span id="line-318"></span><span class="annot"><a href="CardanoNode.html#initSystemStart"><span class="hs-identifier hs-type">initSystemStart</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">UTCTime</span></span><span>
</span><span id="line-319"></span><span id="initSystemStart"><span class="annot"><span class="annottext">initSystemStart :: IO UTCTime
</span><a href="CardanoNode.html#initSystemStart"><span class="hs-identifier hs-var hs-var">initSystemStart</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-320"></span><span>  </span><span class="annot"><span class="annottext">NominalDiffTime -&gt; UTCTime -&gt; UTCTime
</span><span class="hs-identifier hs-var">addUTCTime</span></span><span> </span><span class="annot"><span class="annottext">NominalDiffTime
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">(UTCTime -&gt; UTCTime) -&gt; IO UTCTime -&gt; IO UTCTime
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">IO UTCTime
forall (m :: * -&gt; *). MonadTime m =&gt; m UTCTime
</span><span class="hs-identifier hs-var">getCurrentTime</span></span><span>
</span><span id="line-321"></span><span>
</span><span id="line-322"></span><span class="hs-comment">-- | Re-generate configuration and genesis files with fresh system start times.</span><span>
</span><span id="line-323"></span><span class="annot"><a href="CardanoNode.html#refreshSystemStart"><span class="hs-identifier hs-type">refreshSystemStart</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-324"></span><span>  </span><span class="hs-comment">-- | Working directory in which paths of 'CardanoNodeArgs' are resolved.</span><span>
</span><span id="line-325"></span><span>  </span><span class="annot"><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">FilePath</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-326"></span><span>  </span><span class="annot"><a href="CardanoNode.html#CardanoNodeArgs"><span class="hs-identifier hs-type">CardanoNodeArgs</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-327"></span><span>  </span><span class="annot"><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-328"></span><span id="refreshSystemStart"><span class="annot"><span class="annottext">refreshSystemStart :: String -&gt; CardanoNodeArgs -&gt; IO ()
</span><a href="CardanoNode.html#refreshSystemStart"><span class="hs-identifier hs-var hs-var">refreshSystemStart</span></a></span></span><span> </span><span id="local-6989586621679327846"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679327846"><span class="hs-identifier hs-var">stateDirectory</span></a></span></span><span> </span><span id="local-6989586621679327845"><span class="annot"><span class="annottext">CardanoNodeArgs
</span><a href="#local-6989586621679327845"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-329"></span><span>  </span><span id="local-6989586621679327844"><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679327844"><span class="hs-identifier hs-var">systemStart</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO UTCTime
</span><a href="CardanoNode.html#initSystemStart"><span class="hs-identifier hs-var">initSystemStart</span></a></span><span>
</span><span id="line-330"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679327843"><span class="annot"><span class="annottext">startTime :: Int
</span><a href="#local-6989586621679327843"><span class="hs-identifier hs-var hs-var">startTime</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integral Int =&gt; NominalDiffTime -&gt; Int
forall a b. (RealFrac a, Integral b) =&gt; a -&gt; b
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">round</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="annot"><span class="annottext">(NominalDiffTime -&gt; Int) -&gt; NominalDiffTime -&gt; Int
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">UTCTime -&gt; NominalDiffTime
</span><span class="hs-identifier hs-var">utcTimeToPOSIXSeconds</span></span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679327844"><span class="hs-identifier hs-var">systemStart</span></a></span><span>
</span><span id="line-331"></span><span>  </span><span id="local-6989586621679327841"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679327841"><span class="hs-identifier hs-var">byronGenesis</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-332"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; IO Value
forall a. FromJSON a =&gt; String -&gt; IO a
</span><a href="CardanoNode.html#unsafeDecodeJsonFile"><span class="hs-identifier hs-var">unsafeDecodeJsonFile</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679327846"><span class="hs-identifier hs-var">stateDirectory</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
</span><span class="hs-operator hs-var">&lt;/&gt;</span></span><span> </span><span class="annot"><span class="annottext">CardanoNodeArgs -&gt; String
</span><a href="CardanoNode.html#%24sel%3AnodeByronGenesisFile%3ACardanoNodeArgs"><span class="hs-identifier hs-var hs-var">nodeByronGenesisFile</span></a></span><span> </span><span class="annot"><span class="annottext">CardanoNodeArgs
</span><a href="#local-6989586621679327845"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-333"></span><span>      </span><span class="annot"><span class="annottext">IO Value -&gt; (Value -&gt; Value) -&gt; IO Value
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; (a -&gt; b) -&gt; f b
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&amp;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Key -&gt; Int -&gt; Value -&gt; Value
forall a. ToJSON a =&gt; Key -&gt; a -&gt; Value -&gt; Value
</span><a href="CardanoNode.html#addField"><span class="hs-identifier hs-var">addField</span></a></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;startTime&quot;</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679327843"><span class="hs-identifier hs-var">startTime</span></a></span><span>
</span><span id="line-334"></span><span>
</span><span id="line-335"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679327837"><span class="annot"><span class="annottext">systemStartUTC :: UTCTime
</span><a href="#local-6989586621679327837"><span class="hs-identifier hs-var hs-var">systemStartUTC</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-336"></span><span>        </span><span class="annot"><span class="annottext">NominalDiffTime -&gt; UTCTime
</span><span class="hs-identifier hs-var">posixSecondsToUTCTime</span></span><span> </span><span class="annot"><span class="annottext">(NominalDiffTime -&gt; UTCTime)
-&gt; (Int -&gt; NominalDiffTime) -&gt; Int -&gt; UTCTime
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Rational -&gt; NominalDiffTime
forall a. Fractional a =&gt; Rational -&gt; a
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fromRational</span></a></span><span> </span><span class="annot"><span class="annottext">(Rational -&gt; NominalDiffTime)
-&gt; (Int -&gt; Rational) -&gt; Int -&gt; NominalDiffTime
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Rational
forall a. Real a =&gt; a -&gt; Rational
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">toRational</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; UTCTime) -&gt; Int -&gt; UTCTime
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679327843"><span class="hs-identifier hs-var">startTime</span></a></span><span>
</span><span id="line-337"></span><span>  </span><span id="local-6989586621679327836"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679327836"><span class="hs-identifier hs-var">shelleyGenesis</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-338"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; IO Value
forall a. FromJSON a =&gt; String -&gt; IO a
</span><a href="CardanoNode.html#unsafeDecodeJsonFile"><span class="hs-identifier hs-var">unsafeDecodeJsonFile</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679327846"><span class="hs-identifier hs-var">stateDirectory</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
</span><span class="hs-operator hs-var">&lt;/&gt;</span></span><span> </span><span class="annot"><span class="annottext">CardanoNodeArgs -&gt; String
</span><a href="CardanoNode.html#%24sel%3AnodeShelleyGenesisFile%3ACardanoNodeArgs"><span class="hs-identifier hs-var hs-var">nodeShelleyGenesisFile</span></a></span><span> </span><span class="annot"><span class="annottext">CardanoNodeArgs
</span><a href="#local-6989586621679327845"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-339"></span><span>      </span><span class="annot"><span class="annottext">IO Value -&gt; (Value -&gt; Value) -&gt; IO Value
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; (a -&gt; b) -&gt; f b
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&amp;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Key -&gt; UTCTime -&gt; Value -&gt; Value
forall a. ToJSON a =&gt; Key -&gt; a -&gt; Value -&gt; Value
</span><a href="CardanoNode.html#addField"><span class="hs-identifier hs-var">addField</span></a></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;systemStart&quot;</span></span><span> </span><span class="annot"><span class="annottext">UTCTime
</span><a href="#local-6989586621679327837"><span class="hs-identifier hs-var">systemStartUTC</span></a></span><span>
</span><span id="line-340"></span><span>
</span><span id="line-341"></span><span>  </span><span id="local-6989586621679327835"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679327835"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-342"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; IO Value
forall a. FromJSON a =&gt; String -&gt; IO a
</span><a href="CardanoNode.html#unsafeDecodeJsonFile"><span class="hs-identifier hs-var">unsafeDecodeJsonFile</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679327846"><span class="hs-identifier hs-var">stateDirectory</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
</span><span class="hs-operator hs-var">&lt;/&gt;</span></span><span> </span><span class="annot"><span class="annottext">CardanoNodeArgs -&gt; String
</span><a href="CardanoNode.html#%24sel%3AnodeConfigFile%3ACardanoNodeArgs"><span class="hs-identifier hs-var hs-var">nodeConfigFile</span></a></span><span> </span><span class="annot"><span class="annottext">CardanoNodeArgs
</span><a href="#local-6989586621679327845"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-343"></span><span>      </span><span class="annot"><span class="annottext">IO Value -&gt; (Value -&gt; Value) -&gt; IO Value
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; (a -&gt; b) -&gt; f b
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&amp;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Key -&gt; String -&gt; Value -&gt; Value
forall a. ToJSON a =&gt; Key -&gt; a -&gt; Value -&gt; Value
</span><a href="CardanoNode.html#addField"><span class="hs-identifier hs-var">addField</span></a></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;ByronGenesisFile&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CardanoNodeArgs -&gt; String
</span><a href="CardanoNode.html#%24sel%3AnodeByronGenesisFile%3ACardanoNodeArgs"><span class="hs-identifier hs-var hs-var">nodeByronGenesisFile</span></a></span><span> </span><span class="annot"><span class="annottext">CardanoNodeArgs
</span><a href="#local-6989586621679327845"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-344"></span><span>      </span><span class="annot"><span class="annottext">IO Value -&gt; (Value -&gt; Value) -&gt; IO Value
forall (f :: * -&gt; *) a b. Functor f =&gt; f a -&gt; (a -&gt; b) -&gt; f b
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&amp;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Key -&gt; String -&gt; Value -&gt; Value
forall a. ToJSON a =&gt; Key -&gt; a -&gt; Value -&gt; Value
</span><a href="CardanoNode.html#addField"><span class="hs-identifier hs-var">addField</span></a></span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;ShelleyGenesisFile&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CardanoNodeArgs -&gt; String
</span><a href="CardanoNode.html#%24sel%3AnodeShelleyGenesisFile%3ACardanoNodeArgs"><span class="hs-identifier hs-var hs-var">nodeShelleyGenesisFile</span></a></span><span> </span><span class="annot"><span class="annottext">CardanoNodeArgs
</span><a href="#local-6989586621679327845"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-345"></span><span>
</span><span id="line-346"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; Value -&gt; IO ()
forall a. ToJSON a =&gt; String -&gt; a -&gt; IO ()
</span><span class="hs-identifier hs-var">Aeson.encodeFile</span></span><span>
</span><span id="line-347"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679327846"><span class="hs-identifier hs-var">stateDirectory</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
</span><span class="hs-operator hs-var">&lt;/&gt;</span></span><span> </span><span class="annot"><span class="annottext">CardanoNodeArgs -&gt; String
</span><a href="CardanoNode.html#%24sel%3AnodeByronGenesisFile%3ACardanoNodeArgs"><span class="hs-identifier hs-var hs-var">nodeByronGenesisFile</span></a></span><span> </span><span class="annot"><span class="annottext">CardanoNodeArgs
</span><a href="#local-6989586621679327845"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-348"></span><span>    </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679327841"><span class="hs-identifier hs-var">byronGenesis</span></a></span><span>
</span><span id="line-349"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; Value -&gt; IO ()
forall a. ToJSON a =&gt; String -&gt; a -&gt; IO ()
</span><span class="hs-identifier hs-var">Aeson.encodeFile</span></span><span>
</span><span id="line-350"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679327846"><span class="hs-identifier hs-var">stateDirectory</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
</span><span class="hs-operator hs-var">&lt;/&gt;</span></span><span> </span><span class="annot"><span class="annottext">CardanoNodeArgs -&gt; String
</span><a href="CardanoNode.html#%24sel%3AnodeShelleyGenesisFile%3ACardanoNodeArgs"><span class="hs-identifier hs-var hs-var">nodeShelleyGenesisFile</span></a></span><span> </span><span class="annot"><span class="annottext">CardanoNodeArgs
</span><a href="#local-6989586621679327845"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-351"></span><span>    </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679327836"><span class="hs-identifier hs-var">shelleyGenesis</span></a></span><span>
</span><span id="line-352"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; Value -&gt; IO ()
forall a. ToJSON a =&gt; String -&gt; a -&gt; IO ()
</span><span class="hs-identifier hs-var">Aeson.encodeFile</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679327846"><span class="hs-identifier hs-var">stateDirectory</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
</span><span class="hs-operator hs-var">&lt;/&gt;</span></span><span> </span><span class="annot"><span class="annottext">CardanoNodeArgs -&gt; String
</span><a href="CardanoNode.html#%24sel%3AnodeConfigFile%3ACardanoNodeArgs"><span class="hs-identifier hs-var hs-var">nodeConfigFile</span></a></span><span> </span><span class="annot"><span class="annottext">CardanoNodeArgs
</span><a href="#local-6989586621679327845"><span class="hs-identifier hs-var">args</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679327835"><span class="hs-identifier hs-var">config</span></a></span><span>
</span><span id="line-353"></span><span>
</span><span id="line-354"></span><span class="hs-comment">-- | Generate a topology file from a list of peers.</span><span>
</span><span id="line-355"></span><span class="annot"><a href="CardanoNode.html#mkTopology"><span class="hs-identifier hs-type">mkTopology</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="CardanoNode.html#Port"><span class="hs-identifier hs-type">Port</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Aeson.Value</span></span><span>
</span><span id="line-356"></span><span id="mkTopology"><span class="annot"><span class="annottext">mkTopology :: [Int] -&gt; Value
</span><a href="CardanoNode.html#mkTopology"><span class="hs-identifier hs-var hs-var">mkTopology</span></a></span></span><span> </span><span id="local-6989586621679327834"><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679327834"><span class="hs-identifier hs-var">peers</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-357"></span><span>  </span><span class="annot"><span class="annottext">[Pair] -&gt; Value
</span><span class="hs-identifier hs-var">Aeson.object</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;Producers&quot;</span></span><span> </span><span class="annot"><span class="annottext">Key -&gt; [Value] -&gt; Pair
forall kv v. (KeyValue kv, ToJSON v) =&gt; Key -&gt; v -&gt; kv
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Value) -&gt; [Int] -&gt; [Value]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Value
</span><a href="#local-6989586621679327832"><span class="hs-identifier hs-var">encodePeer</span></a></span><span> </span><span class="annot"><span class="annottext">[Int]
</span><a href="#local-6989586621679327834"><span class="hs-identifier hs-var">peers</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-358"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-359"></span><span>  </span><span class="annot"><a href="#local-6989586621679327832"><span class="hs-identifier hs-type">encodePeer</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Aeson.Value</span></span><span>
</span><span id="line-360"></span><span>  </span><span id="local-6989586621679327832"><span class="annot"><span class="annottext">encodePeer :: Int -&gt; Value
</span><a href="#local-6989586621679327832"><span class="hs-identifier hs-var hs-var">encodePeer</span></a></span></span><span> </span><span id="local-6989586621679327831"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679327831"><span class="hs-identifier hs-var">port</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-361"></span><span>    </span><span class="annot"><span class="annottext">[Pair] -&gt; Value
</span><span class="hs-identifier hs-var">Aeson.object</span></span><span>
</span><span id="line-362"></span><span>      </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;addr&quot;</span></span><span> </span><span class="annot"><span class="annottext">Key -&gt; Text -&gt; Pair
forall kv v. (KeyValue kv, ToJSON v) =&gt; Key -&gt; v -&gt; kv
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Text
</span><span class="hs-string">&quot;127.0.0.1&quot;</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;port&quot;</span></span><span> </span><span class="annot"><span class="annottext">Key -&gt; Int -&gt; Pair
forall kv v. (KeyValue kv, ToJSON v) =&gt; Key -&gt; v -&gt; kv
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679327831"><span class="hs-identifier hs-var">port</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Key
</span><span class="hs-string">&quot;valency&quot;</span></span><span> </span><span class="annot"><span class="annottext">Key -&gt; Int -&gt; Pair
forall kv v. (KeyValue kv, ToJSON v) =&gt; Key -&gt; v -&gt; kv
</span><span class="hs-operator hs-var">.=</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Int</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-363"></span><span>
</span><span id="line-364"></span><span class="annot"><a href="CardanoNode.html#generateCardanoKey"><span class="hs-identifier hs-type">generateCardanoKey</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">VerificationKey</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">PaymentKey</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">SigningKey</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">PaymentKey</span></span><span class="hs-special">)</span><span>
</span><span id="line-365"></span><span id="generateCardanoKey"><span class="annot"><span class="annottext">generateCardanoKey :: IO (VerificationKey PaymentKey, SigningKey PaymentKey)
</span><a href="CardanoNode.html#generateCardanoKey"><span class="hs-identifier hs-var hs-var">generateCardanoKey</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-366"></span><span>  </span><span id="local-6989586621679327829"><span class="annot"><span class="annottext">SigningKey PaymentKey
</span><a href="#local-6989586621679327829"><span class="hs-identifier hs-var">sk</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">AsType PaymentKey -&gt; IO (SigningKey PaymentKey)
forall keyrole.
Key keyrole =&gt;
AsType keyrole -&gt; IO (SigningKey keyrole)
</span><span class="hs-identifier hs-var">generateSigningKey</span></span><span> </span><span class="annot"><span class="annottext">AsType PaymentKey
</span><span class="hs-identifier hs-var">AsPaymentKey</span></span><span>
</span><span id="line-367"></span><span>  </span><span class="annot"><span class="annottext">(VerificationKey PaymentKey, SigningKey PaymentKey)
-&gt; IO (VerificationKey PaymentKey, SigningKey PaymentKey)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">SigningKey PaymentKey -&gt; VerificationKey PaymentKey
forall keyrole.
Key keyrole =&gt;
SigningKey keyrole -&gt; VerificationKey keyrole
</span><span class="hs-identifier hs-var">getVerificationKey</span></span><span> </span><span class="annot"><span class="annottext">SigningKey PaymentKey
</span><a href="#local-6989586621679327829"><span class="hs-identifier hs-var">sk</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">SigningKey PaymentKey
</span><a href="#local-6989586621679327829"><span class="hs-identifier hs-var">sk</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-368"></span><span>
</span><span id="line-369"></span><span class="hs-keyword">data</span><span> </span><span id="ProcessHasExited"><span class="annot"><a href="CardanoNode.html#ProcessHasExited"><span class="hs-identifier hs-var">ProcessHasExited</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="ProcessHasExited"><span class="annot"><a href="CardanoNode.html#ProcessHasExited"><span class="hs-identifier hs-var">ProcessHasExited</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="annot"><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">ExitCode</span></a></span><span>
</span><span id="line-370"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679327822"><span id="local-6989586621679327824"><span id="local-6989586621679327826"><span class="annot"><span class="annottext">Int -&gt; ProcessHasExited -&gt; ShowS
[ProcessHasExited] -&gt; ShowS
ProcessHasExited -&gt; String
(Int -&gt; ProcessHasExited -&gt; ShowS)
-&gt; (ProcessHasExited -&gt; String)
-&gt; ([ProcessHasExited] -&gt; ShowS)
-&gt; Show ProcessHasExited
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [ProcessHasExited] -&gt; ShowS
$cshowList :: [ProcessHasExited] -&gt; ShowS
show :: ProcessHasExited -&gt; String
$cshow :: ProcessHasExited -&gt; String
showsPrec :: Int -&gt; ProcessHasExited -&gt; ShowS
$cshowsPrec :: Int -&gt; ProcessHasExited -&gt; ShowS
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-371"></span><span>
</span><span id="line-372"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679327814"><span id="local-6989586621679327816"><span id="local-6989586621679327818"><span class="annot"><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Exception</span></a></span><span> </span><span class="annot"><a href="CardanoNode.html#ProcessHasExited"><span class="hs-identifier hs-type">ProcessHasExited</span></a></span></span></span></span><span>
</span><span id="line-373"></span><span>
</span><span id="line-374"></span><span class="hs-comment">-- Logging</span><span>
</span><span id="line-375"></span><span>
</span><span id="line-376"></span><span id="local-6989586621679327811"><span id="local-6989586621679327812"></span></span><span class="hs-keyword">data</span><span> </span><span id="NodeLog"><span class="annot"><a href="CardanoNode.html#NodeLog"><span class="hs-identifier hs-var">NodeLog</span></a></span></span><span>
</span><span id="line-377"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="MsgNodeCmdSpec"><span class="annot"><a href="CardanoNode.html#MsgNodeCmdSpec"><span class="hs-identifier hs-var">MsgNodeCmdSpec</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-378"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="MsgCLI"><span class="annot"><a href="CardanoNode.html#MsgCLI"><span class="hs-identifier hs-var">MsgCLI</span></a></span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span class="hs-special">]</span><span>
</span><span id="line-379"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="MsgCLIStatus"><span class="annot"><a href="CardanoNode.html#MsgCLIStatus"><span class="hs-identifier hs-var">MsgCLIStatus</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-380"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="MsgCLIRetry"><span class="annot"><a href="CardanoNode.html#MsgCLIRetry"><span class="hs-identifier hs-var">MsgCLIRetry</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span>
</span><span id="line-381"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="MsgCLIRetryResult"><span class="annot"><a href="CardanoNode.html#MsgCLIRetryResult"><span class="hs-identifier hs-var">MsgCLIRetryResult</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Text</span></span><span> </span><span class="annot"><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Int</span></a></span><span>
</span><span id="line-382"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="MsgNodeStarting"><span class="annot"><a href="CardanoNode.html#MsgNodeStarting"><span class="hs-identifier hs-var">MsgNodeStarting</span></a></span></span><span> </span><span class="hs-special">{</span><span id="%24sel%3AstateDirectory%3AMsgNodeCmdSpec"><span class="annot"><span class="annottext">NodeLog -&gt; String
</span><a href="CardanoNode.html#%24sel%3AstateDirectory%3AMsgNodeCmdSpec"><span class="hs-identifier hs-var hs-var">stateDirectory</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">FilePath</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-383"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="MsgSocketIsReady"><span class="annot"><a href="CardanoNode.html#MsgSocketIsReady"><span class="hs-identifier hs-var">MsgSocketIsReady</span></a></span></span><span> </span><span class="annot"><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">FilePath</span></a></span><span>
</span><span id="line-384"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="MsgSynchronizing"><span class="annot"><a href="CardanoNode.html#MsgSynchronizing"><span class="hs-identifier hs-var">MsgSynchronizing</span></a></span></span><span> </span><span class="hs-special">{</span><span id="%24sel%3ApercentDone%3AMsgNodeCmdSpec"><span class="annot"><span class="annottext">NodeLog -&gt; Centi
</span><a href="CardanoNode.html#%24sel%3ApercentDone%3AMsgNodeCmdSpec"><span class="hs-identifier hs-var hs-var">percentDone</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Centi</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-385"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="MsgNodeIsReady"><span class="annot"><a href="CardanoNode.html#MsgNodeIsReady"><span class="hs-identifier hs-var">MsgNodeIsReady</span></a></span></span><span>
</span><span id="line-386"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">stock</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679327801"><span id="local-6989586621679327803"><span class="annot"><span class="annottext">NodeLog -&gt; NodeLog -&gt; Bool
(NodeLog -&gt; NodeLog -&gt; Bool)
-&gt; (NodeLog -&gt; NodeLog -&gt; Bool) -&gt; Eq NodeLog
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: NodeLog -&gt; NodeLog -&gt; Bool
$c/= :: NodeLog -&gt; NodeLog -&gt; Bool
== :: NodeLog -&gt; NodeLog -&gt; Bool
$c== :: NodeLog -&gt; NodeLog -&gt; Bool
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679327795"><span id="local-6989586621679327797"><span id="local-6989586621679327799"><span class="annot"><span class="annottext">Int -&gt; NodeLog -&gt; ShowS
[NodeLog] -&gt; ShowS
NodeLog -&gt; String
(Int -&gt; NodeLog -&gt; ShowS)
-&gt; (NodeLog -&gt; String) -&gt; ([NodeLog] -&gt; ShowS) -&gt; Show NodeLog
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [NodeLog] -&gt; ShowS
$cshowList :: [NodeLog] -&gt; ShowS
show :: NodeLog -&gt; String
$cshow :: NodeLog -&gt; String
showsPrec :: Int -&gt; NodeLog -&gt; ShowS
$cshowsPrec :: Int -&gt; NodeLog -&gt; ShowS
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(forall x. NodeLog -&gt; Rep NodeLog x)
-&gt; (forall x. Rep NodeLog x -&gt; NodeLog) -&gt; Generic NodeLog
forall x. Rep NodeLog x -&gt; NodeLog
forall x. NodeLog -&gt; Rep NodeLog x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cto :: forall x. Rep NodeLog x -&gt; NodeLog
$cfrom :: forall x. NodeLog -&gt; Rep NodeLog x
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-387"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">anyclass</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679327785"><span id="local-6989586621679327787"><span id="local-6989586621679327789"><span id="local-6989586621679327791"><span class="annot"><span class="annottext">[NodeLog] -&gt; Value
[NodeLog] -&gt; Encoding
NodeLog -&gt; Value
NodeLog -&gt; Encoding
(NodeLog -&gt; Value)
-&gt; (NodeLog -&gt; Encoding)
-&gt; ([NodeLog] -&gt; Value)
-&gt; ([NodeLog] -&gt; Encoding)
-&gt; ToJSON NodeLog
forall a.
(a -&gt; Value)
-&gt; (a -&gt; Encoding)
-&gt; ([a] -&gt; Value)
-&gt; ([a] -&gt; Encoding)
-&gt; ToJSON a
toEncodingList :: [NodeLog] -&gt; Encoding
$ctoEncodingList :: [NodeLog] -&gt; Encoding
toJSONList :: [NodeLog] -&gt; Value
$ctoJSONList :: [NodeLog] -&gt; Value
toEncoding :: NodeLog -&gt; Encoding
$ctoEncoding :: NodeLog -&gt; Encoding
toJSON :: NodeLog -&gt; Value
$ctoJSON :: NodeLog -&gt; Value
</span><a href="#local-6989586621679327785"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">ToJSON</span></a></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679327781"><span id="local-6989586621679327783"><span class="annot"><span class="annottext">Value -&gt; Parser [NodeLog]
Value -&gt; Parser NodeLog
(Value -&gt; Parser NodeLog)
-&gt; (Value -&gt; Parser [NodeLog]) -&gt; FromJSON NodeLog
forall a.
(Value -&gt; Parser a) -&gt; (Value -&gt; Parser [a]) -&gt; FromJSON a
parseJSONList :: Value -&gt; Parser [NodeLog]
$cparseJSONList :: Value -&gt; Parser [NodeLog]
parseJSON :: Value -&gt; Parser NodeLog
$cparseJSON :: Value -&gt; Parser NodeLog
</span><a href="#local-6989586621679327781"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">FromJSON</span></a></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-388"></span><span>
</span><span id="line-389"></span><span class="hs-comment">--</span><span>
</span><span id="line-390"></span><span class="hs-comment">-- Helpers</span><span>
</span><span id="line-391"></span><span class="hs-comment">--</span><span>
</span><span id="line-392"></span><span>
</span><span id="line-393"></span><span id="local-6989586621679328148"><span class="annot"><a href="CardanoNode.html#addField"><span class="hs-identifier hs-type">addField</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="annot"><a href="#local-6989586621679328148"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Aeson.Key</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679328148"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Aeson.Value</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Aeson.Value</span></span></span><span>
</span><span id="line-394"></span><span id="addField"><span class="annot"><span class="annottext">addField :: Key -&gt; a -&gt; Value -&gt; Value
</span><a href="CardanoNode.html#addField"><span class="hs-identifier hs-var hs-var">addField</span></a></span></span><span> </span><span id="local-6989586621679327780"><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679327780"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span id="local-6989586621679327779"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679327779"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Object -&gt; Object) -&gt; Value -&gt; Value
</span><a href="CardanoNode.html#withObject"><span class="hs-identifier hs-var">withObject</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Key -&gt; Value -&gt; Object -&gt; Object
forall v. Key -&gt; v -&gt; KeyMap v -&gt; KeyMap v
</span><span class="hs-identifier hs-var">Aeson.KeyMap.insert</span></span><span> </span><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679327780"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Value
forall a. ToJSON a =&gt; a -&gt; Value
</span><span class="hs-identifier hs-var">toJSON</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679327779"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-395"></span><span>
</span><span id="line-396"></span><span class="hs-comment">-- | Do something with an a JSON object. Fails if the given JSON value isn't an</span><span>
</span><span id="line-397"></span><span class="hs-comment">-- object.</span><span>
</span><span id="line-398"></span><span class="annot"><a href="CardanoNode.html#withObject"><span class="hs-identifier hs-type">withObject</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Aeson.Object</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Aeson.Object</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Aeson.Value</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Aeson.Value</span></span><span>
</span><span id="line-399"></span><span id="withObject"><span class="annot"><span class="annottext">withObject :: (Object -&gt; Object) -&gt; Value -&gt; Value
</span><a href="CardanoNode.html#withObject"><span class="hs-identifier hs-var hs-var">withObject</span></a></span></span><span> </span><span id="local-6989586621679327775"><span class="annot"><span class="annottext">Object -&gt; Object
</span><a href="#local-6989586621679327775"><span class="hs-identifier hs-var">fn</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-400"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Aeson.Object</span></span><span> </span><span id="local-6989586621679327773"><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679327773"><span class="hs-identifier hs-var">m</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Object -&gt; Value
</span><span class="hs-identifier hs-var">Aeson.Object</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Object -&gt; Object
</span><a href="#local-6989586621679327775"><span class="hs-identifier hs-var">fn</span></a></span><span> </span><span class="annot"><span class="annottext">Object
</span><a href="#local-6989586621679327773"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-401"></span><span>  </span><span id="local-6989586621679327772"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679327772"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679327772"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-402"></span><span>
</span><span id="line-403"></span><span id="local-6989586621679328218"><span class="annot"><a href="CardanoNode.html#unsafeDecodeJson"><span class="hs-identifier hs-type">unsafeDecodeJson</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="annot"><a href="#local-6989586621679328218"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679328218"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-404"></span><span id="unsafeDecodeJson"><span class="annot"><span class="annottext">unsafeDecodeJson :: ByteString -&gt; IO a
</span><a href="CardanoNode.html#unsafeDecodeJson"><span class="hs-identifier hs-var hs-var">unsafeDecodeJson</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO a) -&gt; (a -&gt; IO a) -&gt; Either String a -&gt; IO a
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">either</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; IO a
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fail</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Either String a -&gt; IO a)
-&gt; (ByteString -&gt; Either String a) -&gt; ByteString -&gt; IO a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Either String a
forall a. FromJSON a =&gt; ByteString -&gt; Either String a
</span><span class="hs-identifier hs-var">Aeson.eitherDecodeStrict</span></span><span>
</span><span id="line-405"></span><span>
</span><span id="line-406"></span><span id="local-6989586621679328152"><span class="annot"><a href="CardanoNode.html#unsafeDecodeJsonFile"><span class="hs-identifier hs-type">unsafeDecodeJsonFile</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="annot"><a href="#local-6989586621679328152"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">FilePath</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679328152"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-407"></span><span id="unsafeDecodeJsonFile"><span class="annot"><span class="annottext">unsafeDecodeJsonFile :: String -&gt; IO a
</span><a href="CardanoNode.html#unsafeDecodeJsonFile"><span class="hs-identifier hs-var hs-var">unsafeDecodeJsonFile</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; IO (Either String a)
forall a. FromJSON a =&gt; String -&gt; IO (Either String a)
</span><span class="hs-identifier hs-var">Aeson.eitherDecodeFileStrict</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO (Either String a))
-&gt; (Either String a -&gt; IO a) -&gt; String -&gt; IO a
forall (m :: * -&gt; *) a b c.
Monad m =&gt;
(a -&gt; m b) -&gt; (b -&gt; m c) -&gt; a -&gt; m c
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&gt;=&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO a) -&gt; (a -&gt; IO a) -&gt; Either String a -&gt; IO a
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">either</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; IO a
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fail</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span>
</span><span id="line-408"></span></pre></body></html>