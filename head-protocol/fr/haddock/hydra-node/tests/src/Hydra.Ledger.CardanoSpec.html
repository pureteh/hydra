<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE AllowAmbiguousTypes #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE TypeApplications #-}</span><span>
</span><span id="line-3"></span><span>
</span><span id="line-4"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Hydra.Ledger.CardanoSpec</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-5"></span><span>
</span><span id="line-6"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Hydra.Cardano.Api</span></span><span>
</span><span id="line-7"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Hydra.Prelude</span></span><span>
</span><span id="line-8"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Test.Hydra.Prelude</span></span><span>
</span><span id="line-9"></span><span>
</span><span id="line-10"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.Binary</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">decodeFull</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">serialize'</span></span><span class="hs-special">)</span><span>
</span><span id="line-11"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.Ledger.Credential</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Credential</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Aeson</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">eitherDecode</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">encode</span></span><span class="hs-special">)</span><span>
</span><span id="line-13"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Aeson</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Aeson</span></span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.ByteString.Base16</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Base16</span></span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Text</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">unpack</span></span><span class="hs-special">)</span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Hydra.Cardano.Api.Pretty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">renderTx</span></span><span class="hs-special">)</span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Hydra.Chain.Direct.Fixture</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">defaultGlobals</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">defaultLedgerEnv</span></span><span class="hs-special">)</span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Hydra.Ledger</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ChainSlot</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ChainSlot</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">applyTransactions</span></span><span class="hs-special">)</span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Hydra.Ledger.Cardano</span></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-20"></span><span>  </span><span class="annot"><span class="hs-identifier">cardanoLedger</span></span><span class="hs-special">,</span><span>
</span><span id="line-21"></span><span>  </span><span class="annot"><span class="hs-identifier">genOneUTxOFor</span></span><span class="hs-special">,</span><span>
</span><span id="line-22"></span><span>  </span><span class="annot"><span class="hs-identifier">genSequenceOfSimplePaymentTransactions</span></span><span class="hs-special">,</span><span>
</span><span id="line-23"></span><span>  </span><span class="annot"><span class="hs-identifier">genTxOut</span></span><span class="hs-special">,</span><span>
</span><span id="line-24"></span><span>  </span><span class="annot"><span class="hs-identifier">genUTxOAdaOnlyOfSize</span></span><span class="hs-special">,</span><span>
</span><span id="line-25"></span><span>  </span><span class="annot"><span class="hs-identifier">genUTxOAlonzo</span></span><span class="hs-special">,</span><span>
</span><span id="line-26"></span><span>  </span><span class="annot"><span class="hs-identifier">genUTxOFor</span></span><span class="hs-special">,</span><span>
</span><span id="line-27"></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Hydra.Ledger.Cardano.Evaluate</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">slotNoFromUTCTime</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">slotNoToUTCTime</span></span><span class="hs-special">)</span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Test.Aeson.GenericSpecs</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">roundtripAndGoldenSpecs</span></span><span class="hs-special">)</span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Test.Cardano.Ledger.MaryEraGen</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Test.QuickCheck</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Property</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">checkCoverage</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">conjoin</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">counterexample</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">cover</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">forAll</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">forAllBlind</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">property</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">sized</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">vectorOf</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(.&amp;&amp;.)</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(===)</span></span><span class="hs-special">)</span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Test.Util.html"><span class="hs-identifier">Test.Util</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Test.Util.html#propCollisionResistant"><span class="hs-identifier">propCollisionResistant</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-33"></span><span>
</span><span id="line-34"></span><span class="annot"><a href="Hydra.Ledger.CardanoSpec.html#spec"><span class="hs-identifier hs-type">spec</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Spec</span></span><span>
</span><span id="line-35"></span><span id="spec"><span class="annot"><span class="annottext">spec :: Spec
</span><a href="Hydra.Ledger.CardanoSpec.html#spec"><span class="hs-identifier hs-var hs-var">spec</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-36"></span><span>  </span><span class="annot"><span class="annottext">Spec -&gt; Spec
forall a. SpecWith a -&gt; SpecWith a
</span><span class="hs-identifier hs-var">parallel</span></span><span> </span><span class="annot"><span class="annottext">(Spec -&gt; Spec) -&gt; Spec -&gt; Spec
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-37"></span><span>    </span><span class="annot"><span class="annottext">Proxy AssetName -&gt; Spec
forall a.
(Arbitrary a, ToJSON a, FromJSON a, Typeable a) =&gt;
Proxy a -&gt; Spec
</span><span class="hs-identifier hs-var">roundtripAndGoldenSpecs</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy AssetName
forall k (t :: k). Proxy t
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Proxy</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">AssetName</span></span><span class="hs-special">)</span><span>
</span><span id="line-38"></span><span>    </span><span class="hs-comment">-- FIXME: Roundtrip instances for all JSON types we depend on</span><span>
</span><span id="line-39"></span><span>    </span><span class="annot"><span class="annottext">Proxy UTxO -&gt; Spec
forall a.
(Arbitrary a, ToJSON a, FromJSON a, Typeable a) =&gt;
Proxy a -&gt; Spec
</span><span class="hs-identifier hs-var">roundtripAndGoldenSpecs</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy UTxO
forall k (t :: k). Proxy t
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Proxy</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">UTxO</span></span><span class="hs-special">)</span><span>
</span><span id="line-40"></span><span>    </span><span class="hs-comment">-- roundtripAndGoldenSpecs (Proxy @TxWitnesses)</span><span>
</span><span id="line-41"></span><span>    </span><span class="annot"><span class="annottext">Proxy Tx -&gt; Spec
forall a.
(Arbitrary a, ToJSON a, FromJSON a, Typeable a) =&gt;
Proxy a -&gt; Spec
</span><span class="hs-identifier hs-var">roundtripAndGoldenSpecs</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy Tx
forall k (t :: k). Proxy t
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Proxy</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">Tx</span></span><span class="hs-special">)</span><span>
</span><span id="line-42"></span><span>
</span><span id="line-43"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; (Tx -&gt; Property) -&gt; Spec
forall prop.
(HasCallStack, Testable prop) =&gt;
String -&gt; prop -&gt; Spec
</span><span class="hs-identifier hs-var">prop</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Same TxId before/after JSON encoding&quot;</span></span><span> </span><span class="annot"><span class="annottext">Tx -&gt; Property
</span><a href="Hydra.Ledger.CardanoSpec.html#roundtripTxId"><span class="hs-identifier hs-var">roundtripTxId</span></a></span><span>
</span><span id="line-44"></span><span>
</span><span id="line-45"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; (Tx -&gt; Property) -&gt; Spec
forall prop.
(HasCallStack, Testable prop) =&gt;
String -&gt; prop -&gt; Spec
</span><span class="hs-identifier hs-var">prop</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Roundtrip to and from Ledger&quot;</span></span><span> </span><span class="annot"><span class="annottext">Tx -&gt; Property
</span><a href="Hydra.Ledger.CardanoSpec.html#roundtripLedger"><span class="hs-identifier hs-var">roundtripLedger</span></a></span><span>
</span><span id="line-46"></span><span>
</span><span id="line-47"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; (Tx -&gt; Property) -&gt; Spec
forall prop.
(HasCallStack, Testable prop) =&gt;
String -&gt; prop -&gt; Spec
</span><span class="hs-identifier hs-var">prop</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;CBOR encoding of Tx&quot;</span></span><span> </span><span class="annot"><span class="annottext">((Tx -&gt; Property) -&gt; Spec) -&gt; (Tx -&gt; Property) -&gt; Spec
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(Eq Tx, Show Tx, ToCBOR Tx, FromCBOR Tx) =&gt; Tx -&gt; Property
forall a. (Eq a, Show a, ToCBOR a, FromCBOR a) =&gt; a -&gt; Property
</span><a href="Hydra.Ledger.CardanoSpec.html#roundtripCBOR"><span class="hs-identifier hs-var">roundtripCBOR</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">Tx</span></span><span>
</span><span id="line-48"></span><span>
</span><span id="line-49"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; Property -&gt; Spec
forall prop.
(HasCallStack, Testable prop) =&gt;
String -&gt; prop -&gt; Spec
</span><span class="hs-identifier hs-var">prop</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;applies valid transaction&quot;</span></span><span> </span><span class="annot"><span class="annottext">Property
</span><a href="Hydra.Ledger.CardanoSpec.html#appliesValidTransaction"><span class="hs-identifier hs-var">appliesValidTransaction</span></a></span><span>
</span><span id="line-50"></span><span>
</span><span id="line-51"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; Property -&gt; Spec
forall prop.
(HasCallStack, Testable prop) =&gt;
String -&gt; prop -&gt; Spec
</span><span class="hs-identifier hs-var">prop</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;applies valid transaction serialised from JSON&quot;</span></span><span> </span><span class="annot"><span class="annottext">Property
</span><a href="Hydra.Ledger.CardanoSpec.html#appliesValidTransactionFromJSON"><span class="hs-identifier hs-var">appliesValidTransactionFromJSON</span></a></span><span>
</span><span id="line-52"></span><span>
</span><span id="line-53"></span><span>    </span><span class="hs-comment">-- TODO(SN): rather ensure we use bech32 for addresses as a test</span><span>
</span><span id="line-54"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; Expectation -&gt; SpecWith (Arg Expectation)
forall a.
(HasCallStack, Example a) =&gt;
String -&gt; a -&gt; SpecWith (Arg a)
</span><span class="hs-identifier hs-var">it</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;should parse a Cardano.UTxO&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Expectation -&gt; SpecWith (Arg Expectation))
-&gt; Expectation -&gt; SpecWith (Arg Expectation)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-55"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679410378"><span class="annot"><span class="annottext">bs :: LByteString
</span><a href="#local-6989586621679410378"><span class="hs-identifier hs-var hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-56"></span><span>            </span><span class="annot"><span class="annottext">LByteString
</span><span class="hs-string">&quot;{\&quot;9fdc525c20bc00d9dfa9d14904b65e01910c0dfe3bb39865523c1e20eaeb0903#0\&quot;:\
            \  {\&quot;address\&quot;:\&quot;addr1vx35vu6aqmdw6uuc34gkpdymrpsd3lsuh6ffq6d9vja0s6spkenss\&quot;,\
            \   \&quot;value\&quot;:{\&quot;lovelace\&quot;:14}}}&quot;</span></span><span>
</span><span id="line-59"></span><span>      </span><span class="annot"><span class="annottext">LByteString -&gt; Expectation
forall a. FromJSON a =&gt; LByteString -&gt; Expectation
</span><a href="Hydra.Ledger.CardanoSpec.html#shouldParseJSONAs"><span class="hs-identifier hs-var">shouldParseJSONAs</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">UTxO</span></span><span> </span><span class="annot"><span class="annottext">LByteString
</span><a href="#local-6989586621679410378"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-60"></span><span>
</span><span id="line-61"></span><span>    </span><span class="hs-comment">-- TODO(SN): rather ensure we use the right (cardano-api's) witness format as a test</span><span>
</span><span id="line-62"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; Expectation -&gt; SpecWith (Arg Expectation)
forall a.
(HasCallStack, Example a) =&gt;
String -&gt; a -&gt; SpecWith (Arg a)
</span><span class="hs-identifier hs-var">it</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;should parse a Tx&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Expectation -&gt; SpecWith (Arg Expectation))
-&gt; Expectation -&gt; SpecWith (Arg Expectation)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-63"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679410376"><span class="annot"><span class="annottext">bs :: LByteString
</span><a href="#local-6989586621679410376"><span class="hs-identifier hs-var hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-64"></span><span>            </span><span class="annot"><span class="annottext">LByteString
</span><span class="hs-string">&quot;{\&quot;witnesses\&quot;:\
            \    {\&quot;keys\&quot;: [\&quot;8200825820db995fe25169d141cab9bbba92baa01f9f2e1ece7df4cb2ac05190f37fcc1f9d58400599ccd0028389216631446cf0f9a4b095bbed03c25537595aa5a2e107e3704a55050c4ee5198a0aa9fc88007791ef9f3847cd96f3cb9a430d1c2d81c817480c\&quot;]\
            \    },\
            \ \&quot;body\&quot;:{\&quot;outputs\&quot;:[{\&quot;address\&quot;:\&quot;addr1vx35vu6aqmdw6uuc34gkpdymrpsd3lsuh6ffq6d9vja0s6spkenss\&quot;,\&quot;value\&quot;:{\&quot;lovelace\&quot;:14}}],\
            \ \&quot;inputs\&quot;:[\&quot;9fdc525c20bc00d9dfa9d14904b65e01910c0dfe3bb39865523c1e20eaeb0903#0\&quot;]},\
            \ \&quot;auxiliaryData\&quot;:null}&quot;</span></span><span>
</span><span id="line-70"></span><span>      </span><span class="annot"><span class="annottext">LByteString -&gt; Expectation
forall a. FromJSON a =&gt; LByteString -&gt; Expectation
</span><a href="Hydra.Ledger.CardanoSpec.html#shouldParseJSONAs"><span class="hs-identifier hs-var">shouldParseJSONAs</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">Tx</span></span><span> </span><span class="annot"><span class="annottext">LByteString
</span><a href="#local-6989586621679410376"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-71"></span><span>
</span><span id="line-72"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; Spec -&gt; Spec
forall a. HasCallStack =&gt; String -&gt; SpecWith a -&gt; SpecWith a
</span><span class="hs-identifier hs-var">describe</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Generators&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Spec -&gt; Spec) -&gt; Spec -&gt; Spec
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-73"></span><span>      </span><span class="annot"><span class="annottext">String -&gt; Gen TxIn -&gt; Spec
forall a. (Show a, Eq a) =&gt; String -&gt; Gen a -&gt; Spec
</span><a href="Test.Util.html#propCollisionResistant"><span class="hs-identifier hs-var">propCollisionResistant</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;arbitrary @TxIn&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Arbitrary TxIn =&gt; Gen TxIn
forall a. Arbitrary a =&gt; Gen a
</span><span class="hs-identifier hs-var">arbitrary</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">TxIn</span></span><span class="hs-special">)</span><span>
</span><span id="line-74"></span><span>      </span><span class="annot"><span class="annottext">String -&gt; Gen TxId -&gt; Spec
forall a. (Show a, Eq a) =&gt; String -&gt; Gen a -&gt; Spec
</span><a href="Test.Util.html#propCollisionResistant"><span class="hs-identifier hs-var">propCollisionResistant</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;arbitrary @TxId&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Arbitrary TxId =&gt; Gen TxId
forall a. Arbitrary a =&gt; Gen a
</span><span class="hs-identifier hs-var">arbitrary</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">TxId</span></span><span class="hs-special">)</span><span>
</span><span id="line-75"></span><span>      </span><span class="annot"><span class="annottext">String -&gt; Gen (VerificationKey PaymentKey) -&gt; Spec
forall a. (Show a, Eq a) =&gt; String -&gt; Gen a -&gt; Spec
</span><a href="Test.Util.html#propCollisionResistant"><span class="hs-identifier hs-var">propCollisionResistant</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;arbitrary @(VerificationKey PaymentKey)&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Arbitrary (VerificationKey PaymentKey) =&gt;
Gen (VerificationKey PaymentKey)
forall a. Arbitrary a =&gt; Gen a
</span><span class="hs-identifier hs-var">arbitrary</span></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">VerificationKey</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">PaymentKey</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-76"></span><span>      </span><span class="annot"><span class="annottext">String -&gt; Gen (Hash PaymentKey) -&gt; Spec
forall a. (Show a, Eq a) =&gt; String -&gt; Gen a -&gt; Spec
</span><a href="Test.Util.html#propCollisionResistant"><span class="hs-identifier hs-var">propCollisionResistant</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;arbitrary @(Hash PaymentKey)&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Arbitrary (Hash PaymentKey) =&gt; Gen (Hash PaymentKey)
forall a. Arbitrary a =&gt; Gen a
</span><span class="hs-identifier hs-var">arbitrary</span></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Hash</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">PaymentKey</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-77"></span><span>      </span><span class="annot"><span class="annottext">String -&gt; Gen UTxO -&gt; Spec
forall (t :: * -&gt; *) a.
(Show (t a), Foldable t, Monoid (t a)) =&gt;
String -&gt; Gen (t a) -&gt; Spec
</span><a href="Hydra.Ledger.CardanoSpec.html#propDoesNotCollapse"><span class="hs-identifier hs-var">propDoesNotCollapse</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;genUTxOAlonzo&quot;</span></span><span> </span><span class="annot"><span class="annottext">Gen UTxO
</span><span class="hs-identifier hs-var">genUTxOAlonzo</span></span><span>
</span><span id="line-78"></span><span>      </span><span class="annot"><span class="annottext">String -&gt; Gen UTxO -&gt; Spec
forall (t :: * -&gt; *) a.
(Show (t a), Foldable t, Monoid (t a)) =&gt;
String -&gt; Gen (t a) -&gt; Spec
</span><a href="Hydra.Ledger.CardanoSpec.html#propDoesNotCollapse"><span class="hs-identifier hs-var">propDoesNotCollapse</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;genUTxOAdaOnlyOfSize&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Int -&gt; Gen UTxO) -&gt; Gen UTxO
forall a. (Int -&gt; Gen a) -&gt; Gen a
</span><span class="hs-identifier hs-var">sized</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Gen UTxO
</span><span class="hs-identifier hs-var">genUTxOAdaOnlyOfSize</span></span><span class="hs-special">)</span><span>
</span><span id="line-79"></span><span>      </span><span class="annot"><span class="annottext">String -&gt; Gen UTxO -&gt; Spec
forall a. (Show a, Eq a) =&gt; String -&gt; Gen a -&gt; Spec
</span><a href="Test.Util.html#propCollisionResistant"><span class="hs-identifier hs-var">propCollisionResistant</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;genUTxOFor&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VerificationKey PaymentKey -&gt; Gen UTxO
</span><span class="hs-identifier hs-var">genUTxOFor</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Gen (VerificationKey PaymentKey)
forall a. Arbitrary a =&gt; Gen a
</span><span class="hs-identifier hs-var">arbitrary</span></span><span> </span><span class="annot"><span class="annottext">Gen (VerificationKey PaymentKey)
-&gt; Int -&gt; VerificationKey PaymentKey
forall a. Gen a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">`generateWith`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">42</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-80"></span><span>      </span><span class="annot"><span class="annottext">String -&gt; Gen UTxO -&gt; Spec
forall a. (Show a, Eq a) =&gt; String -&gt; Gen a -&gt; Spec
</span><a href="Test.Util.html#propCollisionResistant"><span class="hs-identifier hs-var">propCollisionResistant</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;genOneUTxOFor&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">VerificationKey PaymentKey -&gt; Gen UTxO
</span><span class="hs-identifier hs-var">genOneUTxOFor</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Gen (VerificationKey PaymentKey)
forall a. Arbitrary a =&gt; Gen a
</span><span class="hs-identifier hs-var">arbitrary</span></span><span> </span><span class="annot"><span class="annottext">Gen (VerificationKey PaymentKey)
-&gt; Int -&gt; VerificationKey PaymentKey
forall a. Gen a -&gt; Int -&gt; a
</span><span class="hs-operator hs-var">`generateWith`</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">42</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-81"></span><span>
</span><span id="line-82"></span><span>      </span><span class="annot"><span class="annottext">String -&gt; Spec -&gt; Spec
forall a. HasCallStack =&gt; String -&gt; SpecWith a -&gt; SpecWith a
</span><span class="hs-identifier hs-var">describe</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;genTxOut&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Spec -&gt; Spec) -&gt; Spec -&gt; Spec
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-83"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; Property -&gt; SpecWith (Arg Property)
forall a.
(HasCallStack, Example a) =&gt;
String -&gt; a -&gt; SpecWith (Arg a)
</span><span class="hs-identifier hs-var">it</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;does generate good values&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Property -&gt; SpecWith (Arg Property))
-&gt; Property -&gt; SpecWith (Arg Property)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-84"></span><span>          </span><span class="annot"><span class="annottext">Gen (TxOut CtxUTxO) -&gt; (TxOut CtxUTxO -&gt; Property) -&gt; Property
forall a prop.
(Show a, Testable prop) =&gt;
Gen a -&gt; (a -&gt; prop) -&gt; Property
</span><span class="hs-identifier hs-var">forAll</span></span><span> </span><span class="annot"><span class="annottext">Gen (TxOut CtxUTxO)
forall ctx. Gen (TxOut ctx)
</span><span class="hs-identifier hs-var">genTxOut</span></span><span> </span><span class="annot"><span class="annottext">TxOut CtxUTxO -&gt; Property
</span><a href="Hydra.Ledger.CardanoSpec.html#prop_generatesGoodTxOut"><span class="hs-identifier hs-var">prop_generatesGoodTxOut</span></a></span><span>
</span><span id="line-85"></span><span>
</span><span id="line-86"></span><span>    </span><span class="annot"><span class="annottext">String -&gt; Spec -&gt; Spec
forall a. HasCallStack =&gt; String -&gt; SpecWith a -&gt; SpecWith a
</span><span class="hs-identifier hs-var">describe</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Evaluate helpers&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Spec -&gt; Spec) -&gt; Spec -&gt; Spec
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-87"></span><span>      </span><span class="annot"><span class="annottext">String -&gt; (SlotNo -&gt; Property) -&gt; Spec
forall prop.
(HasCallStack, Testable prop) =&gt;
String -&gt; prop -&gt; Spec
</span><span class="hs-identifier hs-var">prop</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;slotNoFromUTCTime . slotNoToUTCTime === id&quot;</span></span><span> </span><span class="annot"><span class="annottext">((SlotNo -&gt; Property) -&gt; Spec) -&gt; (SlotNo -&gt; Property) -&gt; Spec
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679410370"><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621679410370"><span class="hs-identifier hs-var">slot</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-88"></span><span>        </span><span class="annot"><span class="annottext">UTCTime -&gt; SlotNo
</span><span class="hs-identifier hs-var">slotNoFromUTCTime</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">HasCallStack =&gt; SlotNo -&gt; UTCTime
SlotNo -&gt; UTCTime
</span><span class="hs-identifier hs-var">slotNoToUTCTime</span></span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621679410370"><span class="hs-identifier hs-var">slot</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">SlotNo -&gt; SlotNo -&gt; Property
forall a. (Eq a, Show a) =&gt; a -&gt; a -&gt; Property
</span><span class="hs-operator hs-var">===</span></span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621679410370"><span class="hs-identifier hs-var">slot</span></a></span><span>
</span><span id="line-89"></span><span>
</span><span id="line-90"></span><span class="annot"><a href="Hydra.Ledger.CardanoSpec.html#shouldParseJSONAs"><span class="hs-identifier hs-type">shouldParseJSONAs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679410541"><span class="annot"><a href="#local-6989586621679410541"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FromJSON</span></span><span> </span><span class="annot"><a href="#local-6989586621679410541"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">LByteString</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Expectation</span></span><span>
</span><span id="line-91"></span><span id="shouldParseJSONAs"><span class="annot"><span class="annottext">shouldParseJSONAs :: LByteString -&gt; Expectation
</span><a href="Hydra.Ledger.CardanoSpec.html#shouldParseJSONAs"><span class="hs-identifier hs-var hs-var">shouldParseJSONAs</span></a></span></span><span> </span><span id="local-6989586621679410369"><span class="annot"><span class="annottext">LByteString
</span><a href="#local-6989586621679410369"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-92"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">LByteString -&gt; Either String a
forall a. FromJSON a =&gt; LByteString -&gt; Either String a
</span><span class="hs-identifier hs-var">Aeson.eitherDecode</span></span><span> </span><span class="annot"><span class="annottext">LByteString
</span><a href="#local-6989586621679410369"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-93"></span><span>    </span><span class="annot"><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Left</span></a></span><span> </span><span id="local-6989586621679410368"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679410368"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Expectation
forall (m :: * -&gt; *) a.
(HasCallStack, MonadThrow m) =&gt;
String -&gt; m a
</span><span class="hs-identifier hs-var">failure</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679410368"><span class="hs-identifier hs-var">err</span></a></span><span>
</span><span id="line-94"></span><span>    </span><span class="annot"><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679410541"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; Expectation
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-95"></span><span>
</span><span id="line-96"></span><span class="annot"><a href="Hydra.Ledger.CardanoSpec.html#roundtripTxId"><span class="hs-identifier hs-type">roundtripTxId</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Tx</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Property</span></span><span>
</span><span id="line-97"></span><span id="roundtripTxId"><span class="annot"><span class="annottext">roundtripTxId :: Tx -&gt; Property
</span><a href="Hydra.Ledger.CardanoSpec.html#roundtripTxId"><span class="hs-identifier hs-var hs-var">roundtripTxId</span></a></span></span><span> </span><span id="local-6989586621679410366"><span class="annot"><span class="annottext">tx :: Tx
</span><a href="#local-6989586621679410366"><span class="hs-identifier hs-var">tx</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Tx</span></span><span> </span><span id="local-6989586621679410364"><span class="annot"><span class="annottext">TxBody
</span><a href="#local-6989586621679410364"><span class="hs-identifier hs-var">body</span></a></span></span><span> </span><span class="annot"><span class="annottext">[KeyWitness]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-98"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">LByteString -&gt; Maybe Tx
forall a. FromJSON a =&gt; LByteString -&gt; Maybe a
</span><span class="hs-identifier hs-var">Aeson.decode</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tx -&gt; LByteString
forall a. ToJSON a =&gt; a -&gt; LByteString
</span><span class="hs-identifier hs-var">Aeson.encode</span></span><span> </span><span class="annot"><span class="annottext">Tx
</span><a href="#local-6989586621679410366"><span class="hs-identifier hs-var">tx</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-99"></span><span>    </span><span class="annot"><span class="annottext">Maybe Tx
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-100"></span><span>      </span><span class="annot"><span class="annottext">Bool -&gt; Property
forall prop. Testable prop =&gt; prop -&gt; Property
</span><span class="hs-identifier hs-var">property</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-101"></span><span>    </span><span class="annot"><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679410362"><span class="annot"><span class="annottext">tx' :: Tx
</span><a href="#local-6989586621679410362"><span class="hs-identifier hs-var">tx'</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Tx</span></span><span> </span><span id="local-6989586621679410361"><span class="annot"><span class="annottext">TxBody
</span><a href="#local-6989586621679410361"><span class="hs-identifier hs-var">body'</span></a></span></span><span> </span><span class="annot"><span class="annottext">[KeyWitness]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-102"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tx
</span><a href="#local-6989586621679410366"><span class="hs-identifier hs-var">tx</span></a></span><span> </span><span class="annot"><span class="annottext">Tx -&gt; Tx -&gt; Property
forall a. (Eq a, Show a) =&gt; a -&gt; a -&gt; Property
</span><span class="hs-operator hs-var">===</span></span><span> </span><span class="annot"><span class="annottext">Tx
</span><a href="#local-6989586621679410362"><span class="hs-identifier hs-var">tx'</span></a></span><span> </span><span class="annot"><span class="annottext">Property -&gt; Property -&gt; Property
forall prop1 prop2.
(Testable prop1, Testable prop2) =&gt;
prop1 -&gt; prop2 -&gt; Property
</span><span class="hs-operator hs-var">.&amp;&amp;.</span></span><span> </span><span class="annot"><span class="annottext">TxBody -&gt; TxId
forall era. TxBody era -&gt; TxId
</span><span class="hs-identifier hs-var">getTxId</span></span><span> </span><span class="annot"><span class="annottext">TxBody
</span><a href="#local-6989586621679410364"><span class="hs-identifier hs-var">body</span></a></span><span> </span><span class="annot"><span class="annottext">TxId -&gt; TxId -&gt; Property
forall a. (Eq a, Show a) =&gt; a -&gt; a -&gt; Property
</span><span class="hs-operator hs-var">===</span></span><span> </span><span class="annot"><span class="annottext">TxBody -&gt; TxId
forall era. TxBody era -&gt; TxId
</span><span class="hs-identifier hs-var">getTxId</span></span><span> </span><span class="annot"><span class="annottext">TxBody
</span><a href="#local-6989586621679410361"><span class="hs-identifier hs-var">body'</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-103"></span><span>        </span><span class="annot"><span class="annottext">Property -&gt; (Property -&gt; Property) -&gt; Property
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; Property -&gt; Property
forall prop. Testable prop =&gt; String -&gt; prop -&gt; Property
</span><span class="hs-identifier hs-var">counterexample</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;after:  &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; String
forall a b. ConvertUtf8 a b =&gt; b -&gt; a
</span><span class="hs-identifier hs-var">decodeUtf8</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
</span><span class="hs-identifier hs-var">Base16.encode</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; ByteString) -&gt; ByteString -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Tx -&gt; ByteString
forall a. ToCBOR a =&gt; a -&gt; ByteString
</span><span class="hs-identifier hs-var">serialize'</span></span><span> </span><span class="annot"><span class="annottext">Tx
</span><a href="#local-6989586621679410362"><span class="hs-identifier hs-var">tx'</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-104"></span><span>        </span><span class="annot"><span class="annottext">Property -&gt; (Property -&gt; Property) -&gt; Property
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; Property -&gt; Property
forall prop. Testable prop =&gt; String -&gt; prop -&gt; Property
</span><span class="hs-identifier hs-var">counterexample</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;before: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; String
forall a b. ConvertUtf8 a b =&gt; b -&gt; a
</span><span class="hs-identifier hs-var">decodeUtf8</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
</span><span class="hs-identifier hs-var">Base16.encode</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; ByteString) -&gt; ByteString -&gt; ByteString
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Tx -&gt; ByteString
forall a. ToCBOR a =&gt; a -&gt; ByteString
</span><span class="hs-identifier hs-var">serialize'</span></span><span> </span><span class="annot"><span class="annottext">Tx
</span><a href="#local-6989586621679410366"><span class="hs-identifier hs-var">tx</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-105"></span><span>
</span><span id="line-106"></span><span class="annot"><a href="Hydra.Ledger.CardanoSpec.html#roundtripLedger"><span class="hs-identifier hs-type">roundtripLedger</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Tx</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Property</span></span><span>
</span><span id="line-107"></span><span id="roundtripLedger"><span class="annot"><span class="annottext">roundtripLedger :: Tx -&gt; Property
</span><a href="Hydra.Ledger.CardanoSpec.html#roundtripLedger"><span class="hs-identifier hs-var hs-var">roundtripLedger</span></a></span></span><span> </span><span id="local-6989586621679410356"><span class="annot"><span class="annottext">Tx
</span><a href="#local-6989586621679410356"><span class="hs-identifier hs-var">tx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-108"></span><span>  </span><span class="annot"><span class="annottext">Tx (ShelleyLedgerEra Era) -&gt; Tx
</span><span class="hs-identifier hs-var">fromLedgerTx</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Tx -&gt; Tx (ShelleyLedgerEra Era)
</span><span class="hs-identifier hs-var">toLedgerTx</span></span><span> </span><span class="annot"><span class="annottext">Tx
</span><a href="#local-6989586621679410356"><span class="hs-identifier hs-var">tx</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Tx -&gt; Tx -&gt; Property
forall a. (Eq a, Show a) =&gt; a -&gt; a -&gt; Property
</span><span class="hs-operator hs-var">===</span></span><span> </span><span class="annot"><span class="annottext">Tx
</span><a href="#local-6989586621679410356"><span class="hs-identifier hs-var">tx</span></a></span><span>
</span><span id="line-109"></span><span>
</span><span id="line-110"></span><span id="local-6989586621679410547"><span class="annot"><a href="Hydra.Ledger.CardanoSpec.html#roundtripCBOR"><span class="hs-identifier hs-type">roundtripCBOR</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679410547"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679410547"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ToCBOR</span></span><span> </span><span class="annot"><a href="#local-6989586621679410547"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">FromCBOR</span></span><span> </span><span class="annot"><a href="#local-6989586621679410547"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679410547"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Property</span></span></span><span>
</span><span id="line-111"></span><span id="roundtripCBOR"><span class="annot"><span class="annottext">roundtripCBOR :: a -&gt; Property
</span><a href="Hydra.Ledger.CardanoSpec.html#roundtripCBOR"><span class="hs-identifier hs-var hs-var">roundtripCBOR</span></a></span></span><span> </span><span id="local-6989586621679410353"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679410353"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-112"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679410352"><span class="annot"><span class="annottext">encoded :: ByteString
</span><a href="#local-6989586621679410352"><span class="hs-identifier hs-var hs-var">encoded</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; ByteString
forall a. ToCBOR a =&gt; a -&gt; ByteString
</span><span class="hs-identifier hs-var">serialize'</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679410353"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-113"></span><span>      </span><span id="local-6989586621679410351"><span class="annot"><span class="annottext">decoded :: Either DecoderError a
</span><a href="#local-6989586621679410351"><span class="hs-identifier hs-var hs-var">decoded</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LByteString -&gt; Either DecoderError a
forall a. FromCBOR a =&gt; LByteString -&gt; Either DecoderError a
</span><span class="hs-identifier hs-var">decodeFull</span></span><span> </span><span class="annot"><span class="annottext">(LByteString -&gt; Either DecoderError a)
-&gt; LByteString -&gt; Either DecoderError a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; LByteString
forall l s. LazyStrict l s =&gt; s -&gt; l
</span><span class="hs-identifier hs-var">fromStrict</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679410352"><span class="hs-identifier hs-var">encoded</span></a></span><span>
</span><span id="line-114"></span><span>   </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Either DecoderError a
</span><a href="#local-6989586621679410351"><span class="hs-identifier hs-var">decoded</span></a></span><span> </span><span class="annot"><span class="annottext">Either DecoderError a -&gt; Either DecoderError a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Either DecoderError a
forall a b. b -&gt; Either a b
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Right</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679410353"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-115"></span><span>        </span><span class="annot"><span class="annottext">Bool -&gt; (Bool -&gt; Property) -&gt; Property
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; Bool -&gt; Property
forall prop. Testable prop =&gt; String -&gt; prop -&gt; Property
</span><span class="hs-identifier hs-var">counterexample</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;encoded: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; String
forall b a. (Show a, IsString b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679410352"><span class="hs-identifier hs-var">encoded</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;. decode: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Either DecoderError a -&gt; String
forall b a. (Show a, IsString b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Either DecoderError a
</span><a href="#local-6989586621679410351"><span class="hs-identifier hs-var">decoded</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-116"></span><span>
</span><span id="line-117"></span><span class="annot"><a href="Hydra.Ledger.CardanoSpec.html#appliesValidTransaction"><span class="hs-identifier hs-type">appliesValidTransaction</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Property</span></span><span>
</span><span id="line-118"></span><span id="appliesValidTransaction"><span class="annot"><span class="annottext">appliesValidTransaction :: Property
</span><a href="Hydra.Ledger.CardanoSpec.html#appliesValidTransaction"><span class="hs-identifier hs-var hs-var">appliesValidTransaction</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-119"></span><span>  </span><span class="annot"><span class="annottext">Gen (UTxO, [Tx]) -&gt; ((UTxO, [Tx]) -&gt; Property) -&gt; Property
forall prop a. Testable prop =&gt; Gen a -&gt; (a -&gt; prop) -&gt; Property
</span><span class="hs-identifier hs-var">forAllBlind</span></span><span> </span><span class="annot"><span class="annottext">Gen (UTxO, [Tx])
</span><span class="hs-identifier hs-var">genSequenceOfSimplePaymentTransactions</span></span><span> </span><span class="annot"><span class="annottext">(((UTxO, [Tx]) -&gt; Property) -&gt; Property)
-&gt; ((UTxO, [Tx]) -&gt; Property) -&gt; Property
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679410348"><span class="annot"><span class="annottext">UTxO
</span><a href="#local-6989586621679410348"><span class="hs-identifier hs-var">utxo</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679410347"><span class="annot"><span class="annottext">[Tx]
</span><a href="#local-6989586621679410347"><span class="hs-identifier hs-var">txs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-120"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679410346"><span class="annot"><span class="annottext">result :: Either (Tx, ValidationError) (UTxOType Tx)
</span><a href="#local-6989586621679410346"><span class="hs-identifier hs-var hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ledger Tx
-&gt; ChainSlot
-&gt; UTxOType Tx
-&gt; [Tx]
-&gt; Either (Tx, ValidationError) (UTxOType Tx)
forall tx.
Ledger tx
-&gt; ChainSlot
-&gt; UTxOType tx
-&gt; [tx]
-&gt; Either (tx, ValidationError) (UTxOType tx)
</span><span class="hs-identifier hs-var hs-var">applyTransactions</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Globals -&gt; LedgerEnv LedgerEra -&gt; Ledger Tx
</span><span class="hs-identifier hs-var">cardanoLedger</span></span><span> </span><span class="annot"><span class="annottext">Globals
</span><span class="hs-identifier hs-var">defaultGlobals</span></span><span> </span><span class="annot"><span class="annottext">LedgerEnv LedgerEra
</span><span class="hs-identifier hs-var">defaultLedgerEnv</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Natural -&gt; ChainSlot
</span><span class="hs-identifier hs-var">ChainSlot</span></span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">UTxOType Tx
UTxO
</span><a href="#local-6989586621679410348"><span class="hs-identifier hs-var">utxo</span></a></span><span> </span><span class="annot"><span class="annottext">[Tx]
</span><a href="#local-6989586621679410347"><span class="hs-identifier hs-var">txs</span></a></span><span>
</span><span id="line-121"></span><span>     </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either (Tx, ValidationError) (UTxOType Tx)
</span><a href="#local-6989586621679410346"><span class="hs-identifier hs-var">result</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-122"></span><span>          </span><span class="annot"><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span class="annot"><span class="annottext">UTxOType Tx
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Property
forall prop. Testable prop =&gt; prop -&gt; Property
</span><span class="hs-identifier hs-var">property</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-123"></span><span>          </span><span class="annot"><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Left</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679410345"><span class="annot"><span class="annottext">Tx
</span><a href="#local-6989586621679410345"><span class="hs-identifier hs-var">tx</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679410344"><span class="annot"><span class="annottext">ValidationError
</span><a href="#local-6989586621679410344"><span class="hs-identifier hs-var">err</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-124"></span><span>            </span><span class="annot"><span class="annottext">Bool -&gt; Property
forall prop. Testable prop =&gt; prop -&gt; Property
</span><span class="hs-identifier hs-var">property</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-125"></span><span>              </span><span class="annot"><span class="annottext">Property -&gt; (Property -&gt; Property) -&gt; Property
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; Property -&gt; Property
forall prop. Testable prop =&gt; String -&gt; prop -&gt; Property
</span><span class="hs-identifier hs-var">counterexample</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Error: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">ValidationError -&gt; String
forall b a. (Show a, IsString b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">ValidationError
</span><a href="#local-6989586621679410344"><span class="hs-identifier hs-var">err</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-126"></span><span>              </span><span class="annot"><span class="annottext">Property -&gt; (Property -&gt; Property) -&gt; Property
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; Property -&gt; Property
forall prop. Testable prop =&gt; String -&gt; prop -&gt; Property
</span><span class="hs-identifier hs-var">counterexample</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Failing tx: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Tx -&gt; String
</span><span class="hs-identifier hs-var">renderTx</span></span><span> </span><span class="annot"><span class="annottext">Tx
</span><a href="#local-6989586621679410345"><span class="hs-identifier hs-var">tx</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-127"></span><span>              </span><span class="annot"><span class="annottext">Property -&gt; (Property -&gt; Property) -&gt; Property
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; Property -&gt; Property
forall prop. Testable prop =&gt; String -&gt; prop -&gt; Property
</span><span class="hs-identifier hs-var">counterexample</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;All txs: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; String
</span><span class="hs-identifier hs-var">unpack</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">OnDecodeError -&gt; ByteString -&gt; Text
</span><span class="hs-identifier hs-var">decodeUtf8With</span></span><span> </span><span class="annot"><span class="annottext">OnDecodeError
</span><span class="hs-identifier hs-var">lenientDecode</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Text) -&gt; ByteString -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Tx] -&gt; ByteString
forall a. ToJSON a =&gt; a -&gt; ByteString
</span><span class="hs-identifier hs-var">prettyPrintJSON</span></span><span> </span><span class="annot"><span class="annottext">[Tx]
</span><a href="#local-6989586621679410347"><span class="hs-identifier hs-var">txs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-128"></span><span>              </span><span class="annot"><span class="annottext">Property -&gt; (Property -&gt; Property) -&gt; Property
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; Property -&gt; Property
forall prop. Testable prop =&gt; String -&gt; prop -&gt; Property
</span><span class="hs-identifier hs-var">counterexample</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Initial UTxO: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; String
</span><span class="hs-identifier hs-var">unpack</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">OnDecodeError -&gt; ByteString -&gt; Text
</span><span class="hs-identifier hs-var">decodeUtf8With</span></span><span> </span><span class="annot"><span class="annottext">OnDecodeError
</span><span class="hs-identifier hs-var">lenientDecode</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Text) -&gt; ByteString -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">UTxO -&gt; ByteString
forall a. ToJSON a =&gt; a -&gt; ByteString
</span><span class="hs-identifier hs-var">prettyPrintJSON</span></span><span> </span><span class="annot"><span class="annottext">UTxO
</span><a href="#local-6989586621679410348"><span class="hs-identifier hs-var">utxo</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-129"></span><span>
</span><span id="line-130"></span><span class="annot"><a href="Hydra.Ledger.CardanoSpec.html#appliesValidTransactionFromJSON"><span class="hs-identifier hs-type">appliesValidTransactionFromJSON</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Property</span></span><span>
</span><span id="line-131"></span><span id="appliesValidTransactionFromJSON"><span class="annot"><span class="annottext">appliesValidTransactionFromJSON :: Property
</span><a href="Hydra.Ledger.CardanoSpec.html#appliesValidTransactionFromJSON"><span class="hs-identifier hs-var hs-var">appliesValidTransactionFromJSON</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-132"></span><span>  </span><span class="annot"><span class="annottext">Gen (UTxO, [Tx]) -&gt; ((UTxO, [Tx]) -&gt; Property) -&gt; Property
forall prop a. Testable prop =&gt; Gen a -&gt; (a -&gt; prop) -&gt; Property
</span><span class="hs-identifier hs-var">forAllBlind</span></span><span> </span><span class="annot"><span class="annottext">Gen (UTxO, [Tx])
</span><span class="hs-identifier hs-var">genSequenceOfSimplePaymentTransactions</span></span><span> </span><span class="annot"><span class="annottext">(((UTxO, [Tx]) -&gt; Property) -&gt; Property)
-&gt; ((UTxO, [Tx]) -&gt; Property) -&gt; Property
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679410340"><span class="annot"><span class="annottext">UTxO
</span><a href="#local-6989586621679410340"><span class="hs-identifier hs-var">utxo</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679410339"><span class="annot"><span class="annottext">[Tx]
</span><a href="#local-6989586621679410339"><span class="hs-identifier hs-var">txs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-133"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679410338"><span class="annot"><span class="annottext">encoded :: LByteString
</span><a href="#local-6989586621679410338"><span class="hs-identifier hs-var hs-var">encoded</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Tx] -&gt; LByteString
forall a. ToJSON a =&gt; a -&gt; LByteString
</span><span class="hs-identifier hs-var">encode</span></span><span> </span><span class="annot"><span class="annottext">[Tx]
</span><a href="#local-6989586621679410339"><span class="hs-identifier hs-var">txs</span></a></span><span>
</span><span id="line-134"></span><span>        </span><span id="local-6989586621679410337"><span class="annot"><span class="annottext">result :: Either String UTxO
</span><a href="#local-6989586621679410337"><span class="hs-identifier hs-var hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LByteString -&gt; Either String [Tx]
forall a. FromJSON a =&gt; LByteString -&gt; Either String a
</span><span class="hs-identifier hs-var">eitherDecode</span></span><span> </span><span class="annot"><span class="annottext">LByteString
</span><a href="#local-6989586621679410338"><span class="hs-identifier hs-var">encoded</span></a></span><span> </span><span class="annot"><span class="annottext">Either String [Tx]
-&gt; ([Tx] -&gt; Either String UTxO) -&gt; Either String UTxO
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">((Tx, ValidationError) -&gt; String)
-&gt; Either (Tx, ValidationError) UTxO -&gt; Either String UTxO
forall (p :: * -&gt; * -&gt; *) a b c.
Bifunctor p =&gt;
(a -&gt; b) -&gt; p a c -&gt; p b c
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">first</span></a></span><span> </span><span class="annot"><span class="annottext">(Tx, ValidationError) -&gt; String
forall b a. (Show a, IsString b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">(Either (Tx, ValidationError) UTxO -&gt; Either String UTxO)
-&gt; ([Tx] -&gt; Either (Tx, ValidationError) UTxO)
-&gt; [Tx]
-&gt; Either String UTxO
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Ledger Tx
-&gt; ChainSlot
-&gt; UTxOType Tx
-&gt; [Tx]
-&gt; Either (Tx, ValidationError) (UTxOType Tx)
forall tx.
Ledger tx
-&gt; ChainSlot
-&gt; UTxOType tx
-&gt; [tx]
-&gt; Either (tx, ValidationError) (UTxOType tx)
</span><span class="hs-identifier hs-var hs-var">applyTransactions</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Globals -&gt; LedgerEnv LedgerEra -&gt; Ledger Tx
</span><span class="hs-identifier hs-var">cardanoLedger</span></span><span> </span><span class="annot"><span class="annottext">Globals
</span><span class="hs-identifier hs-var">defaultGlobals</span></span><span> </span><span class="annot"><span class="annottext">LedgerEnv LedgerEra
</span><span class="hs-identifier hs-var">defaultLedgerEnv</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Natural -&gt; ChainSlot
</span><span class="hs-identifier hs-var">ChainSlot</span></span><span> </span><span class="annot"><span class="annottext">Natural
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">UTxOType Tx
UTxO
</span><a href="#local-6989586621679410340"><span class="hs-identifier hs-var">utxo</span></a></span><span>
</span><span id="line-135"></span><span>     </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Either String UTxO -&gt; Bool
forall a b. Either a b -&gt; Bool
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">isRight</span></a></span><span> </span><span class="annot"><span class="annottext">Either String UTxO
</span><a href="#local-6989586621679410337"><span class="hs-identifier hs-var">result</span></a></span><span>
</span><span id="line-136"></span><span>          </span><span class="annot"><span class="annottext">Bool -&gt; (Bool -&gt; Property) -&gt; Property
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; Bool -&gt; Property
forall prop. Testable prop =&gt; String -&gt; prop -&gt; Property
</span><span class="hs-identifier hs-var">counterexample</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Result: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Either String UTxO -&gt; String
forall b a. (Show a, IsString b) =&gt; a -&gt; b
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">Either String UTxO
</span><a href="#local-6989586621679410337"><span class="hs-identifier hs-var">result</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-137"></span><span>          </span><span class="annot"><span class="annottext">Property -&gt; (Property -&gt; Property) -&gt; Property
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; Property -&gt; Property
forall prop. Testable prop =&gt; String -&gt; prop -&gt; Property
</span><span class="hs-identifier hs-var">counterexample</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;All txs: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; String
</span><span class="hs-identifier hs-var">unpack</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">OnDecodeError -&gt; ByteString -&gt; Text
</span><span class="hs-identifier hs-var">decodeUtf8With</span></span><span> </span><span class="annot"><span class="annottext">OnDecodeError
</span><span class="hs-identifier hs-var">lenientDecode</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Text) -&gt; ByteString -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Tx] -&gt; ByteString
forall a. ToJSON a =&gt; a -&gt; ByteString
</span><span class="hs-identifier hs-var">prettyPrintJSON</span></span><span> </span><span class="annot"><span class="annottext">[Tx]
</span><a href="#local-6989586621679410339"><span class="hs-identifier hs-var">txs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-138"></span><span>          </span><span class="annot"><span class="annottext">Property -&gt; (Property -&gt; Property) -&gt; Property
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; Property -&gt; Property
forall prop. Testable prop =&gt; String -&gt; prop -&gt; Property
</span><span class="hs-identifier hs-var">counterexample</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Initial UTxO: &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; String
</span><span class="hs-identifier hs-var">unpack</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">OnDecodeError -&gt; ByteString -&gt; Text
</span><span class="hs-identifier hs-var">decodeUtf8With</span></span><span> </span><span class="annot"><span class="annottext">OnDecodeError
</span><span class="hs-identifier hs-var">lenientDecode</span></span><span> </span><span class="annot"><span class="annottext">(ByteString -&gt; Text) -&gt; ByteString -&gt; Text
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">UTxO -&gt; ByteString
forall a. ToJSON a =&gt; a -&gt; ByteString
</span><span class="hs-identifier hs-var">prettyPrintJSON</span></span><span> </span><span class="annot"><span class="annottext">UTxO
</span><a href="#local-6989586621679410340"><span class="hs-identifier hs-var">utxo</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-139"></span><span>
</span><span id="line-140"></span><span id="local-6989586621679410530"><span id="local-6989586621679410531"><span class="annot"><a href="Hydra.Ledger.CardanoSpec.html#propDoesNotCollapse"><span class="hs-identifier hs-type">propDoesNotCollapse</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679410531"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679410530"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Foldable</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679410531"><span class="hs-identifier hs-type">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Monoid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679410531"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679410530"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">String</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Gen</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679410531"><span class="hs-identifier hs-type">t</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679410530"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Spec</span></span></span></span><span>
</span><span id="line-141"></span><span id="propDoesNotCollapse"><span class="annot"><span class="annottext">propDoesNotCollapse :: String -&gt; Gen (t a) -&gt; Spec
</span><a href="Hydra.Ledger.CardanoSpec.html#propDoesNotCollapse"><span class="hs-identifier hs-var hs-var">propDoesNotCollapse</span></a></span></span><span> </span><span id="local-6989586621679410333"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679410333"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679410332"><span class="annot"><span class="annottext">Gen (t a)
</span><a href="#local-6989586621679410332"><span class="hs-identifier hs-var">gen</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-142"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; Property -&gt; Spec
forall prop.
(HasCallStack, Testable prop) =&gt;
String -&gt; prop -&gt; Spec
</span><span class="hs-identifier hs-var">prop</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679410333"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; does not generate collapsing values&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Property -&gt; Spec) -&gt; Property -&gt; Spec
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-143"></span><span>    </span><span class="annot"><span class="annottext">Gen [t a] -&gt; ([t a] -&gt; Property) -&gt; Property
forall a prop.
(Show a, Testable prop) =&gt;
Gen a -&gt; (a -&gt; prop) -&gt; Property
</span><span class="hs-identifier hs-var">forAll</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Gen (t a) -&gt; Gen [t a]
forall a. Int -&gt; Gen a -&gt; Gen [a]
</span><span class="hs-identifier hs-var">vectorOf</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">100</span></span><span> </span><span class="annot"><span class="annottext">Gen (t a)
</span><a href="#local-6989586621679410332"><span class="hs-identifier hs-var">gen</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(([t a] -&gt; Property) -&gt; Property)
-&gt; ([t a] -&gt; Property) -&gt; Property
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679410331"><span class="annot"><span class="annottext">[t a]
</span><a href="#local-6989586621679410331"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-144"></span><span>      </span><span class="annot"><span class="annottext">[Int] -&gt; Int
forall a (f :: * -&gt; *). (Foldable f, Num a) =&gt; f a -&gt; a
</span><span class="hs-identifier hs-var">sum</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">t a -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">length</span></a></span><span> </span><span class="annot"><span class="annottext">(t a -&gt; Int) -&gt; [t a] -&gt; [Int]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">[t a]
</span><a href="#local-6989586621679410331"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Property
forall a. (Eq a, Show a) =&gt; a -&gt; a -&gt; Property
</span><span class="hs-operator hs-var">===</span></span><span> </span><span class="annot"><span class="annottext">t a -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">length</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[t a] -&gt; t a
forall (t :: * -&gt; *) m. (Foldable t, Monoid m) =&gt; t m -&gt; m
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fold</span></a></span><span> </span><span class="annot"><span class="annottext">[t a]
</span><a href="#local-6989586621679410331"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-145"></span><span>
</span><span id="line-146"></span><span class="hs-comment">-- | Check that the given 'TxOut' fulfills several requirements and does not use</span><span>
</span><span id="line-147"></span><span class="hs-comment">-- unsupported features. See 'genTxOut' for rationale.</span><span>
</span><span id="line-148"></span><span class="annot"><a href="Hydra.Ledger.CardanoSpec.html#prop_generatesGoodTxOut"><span class="hs-identifier hs-type">prop_generatesGoodTxOut</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TxOut</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">CtxUTxO</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Property</span></span><span>
</span><span id="line-149"></span><span id="prop_generatesGoodTxOut"><span class="annot"><span class="annottext">prop_generatesGoodTxOut :: TxOut CtxUTxO -&gt; Property
</span><a href="Hydra.Ledger.CardanoSpec.html#prop_generatesGoodTxOut"><span class="hs-identifier hs-var hs-var">prop_generatesGoodTxOut</span></a></span></span><span> </span><span id="local-6989586621679410326"><span class="annot"><span class="annottext">TxOut CtxUTxO
</span><a href="#local-6989586621679410326"><span class="hs-identifier hs-var">txOut</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-150"></span><span>  </span><span class="annot"><span class="annottext">Property -&gt; Property
forall prop. Testable prop =&gt; prop -&gt; Property
</span><span class="hs-identifier hs-var">checkCoverage</span></span><span> </span><span class="annot"><span class="annottext">(Property -&gt; Property) -&gt; Property -&gt; Property
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-151"></span><span>    </span><span class="annot"><span class="annottext">[Property] -&gt; Property
forall prop. Testable prop =&gt; [prop] -&gt; Property
</span><span class="hs-identifier hs-var">conjoin</span></span><span>
</span><span id="line-152"></span><span>      </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Property
</span><a href="#local-6989586621679410325"><span class="hs-identifier hs-var">propNoReferenceScript</span></a></span><span>
</span><span id="line-153"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Property
</span><a href="#local-6989586621679410324"><span class="hs-identifier hs-var">propNoByronAddress</span></a></span><span>
</span><span id="line-154"></span><span>      </span><span class="hs-special">]</span><span>
</span><span id="line-155"></span><span>      </span><span class="annot"><span class="annottext">Property -&gt; (Property -&gt; Property) -&gt; Property
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Bool -&gt; String -&gt; Property -&gt; Property
forall prop.
Testable prop =&gt;
Double -&gt; Bool -&gt; String -&gt; prop -&gt; Property
</span><span class="hs-identifier hs-var">cover</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">5</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679410323"><span class="hs-identifier hs-var">hasDatum</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;has datum&quot;</span></span><span>
</span><span id="line-156"></span><span>      </span><span class="annot"><span class="annottext">Property -&gt; (Property -&gt; Property) -&gt; Property
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Bool -&gt; String -&gt; Property -&gt; Property
forall prop.
Testable prop =&gt;
Double -&gt; Bool -&gt; String -&gt; prop -&gt; Property
</span><span class="hs-identifier hs-var">cover</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">5</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679410322"><span class="hs-identifier hs-var">isVKOutput</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;is VK output&quot;</span></span><span>
</span><span id="line-157"></span><span>      </span><span class="annot"><span class="annottext">Property -&gt; (Property -&gt; Property) -&gt; Property
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Bool -&gt; String -&gt; Property -&gt; Property
forall prop.
Testable prop =&gt;
Double -&gt; Bool -&gt; String -&gt; prop -&gt; Property
</span><span class="hs-identifier hs-var">cover</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">5</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679410321"><span class="hs-identifier hs-var">isScriptOutput</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;is Script output&quot;</span></span><span>
</span><span id="line-158"></span><span>      </span><span class="annot"><span class="annottext">Property -&gt; (Property -&gt; Property) -&gt; Property
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Bool -&gt; String -&gt; Property -&gt; Property
forall prop.
Testable prop =&gt;
Double -&gt; Bool -&gt; String -&gt; prop -&gt; Property
</span><span class="hs-identifier hs-var">cover</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679410320"><span class="hs-identifier hs-var">hasOnlyADA</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;has only ADA&quot;</span></span><span>
</span><span id="line-159"></span><span>      </span><span class="annot"><span class="annottext">Property -&gt; (Property -&gt; Property) -&gt; Property
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Bool -&gt; String -&gt; Property -&gt; Property
forall prop.
Testable prop =&gt;
Double -&gt; Bool -&gt; String -&gt; prop -&gt; Property
</span><span class="hs-identifier hs-var">cover</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679410319"><span class="hs-identifier hs-var">hasMultiAssets</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;has multiple assets &quot;</span></span><span>
</span><span id="line-160"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-161"></span><span>  </span><span id="local-6989586621679410325"><span class="annot"><span class="annottext">propNoReferenceScript :: Property
</span><a href="#local-6989586621679410325"><span class="hs-identifier hs-var hs-var">propNoReferenceScript</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-162"></span><span>    </span><span class="annot"><span class="annottext">TxOut CtxUTxO -&gt; ReferenceScript
forall ctx. TxOut ctx -&gt; ReferenceScript
</span><span class="hs-identifier hs-var">txOutReferenceScript</span></span><span> </span><span class="annot"><span class="annottext">TxOut CtxUTxO
</span><a href="#local-6989586621679410326"><span class="hs-identifier hs-var">txOut</span></a></span><span>
</span><span id="line-163"></span><span>      </span><span class="annot"><span class="annottext">ReferenceScript -&gt; ReferenceScript -&gt; Property
forall a. (Eq a, Show a) =&gt; a -&gt; a -&gt; Property
</span><span class="hs-operator hs-var">===</span></span><span> </span><span class="annot"><span class="annottext">ReferenceScript
</span><span class="hs-identifier hs-var">ReferenceScriptNone</span></span><span>
</span><span id="line-164"></span><span>      </span><span class="annot"><span class="annottext">Property -&gt; (Property -&gt; Property) -&gt; Property
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; Property -&gt; Property
forall prop. Testable prop =&gt; String -&gt; prop -&gt; Property
</span><span class="hs-identifier hs-var">counterexample</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;generated reference script&quot;</span></span><span>
</span><span id="line-165"></span><span>
</span><span id="line-166"></span><span>  </span><span id="local-6989586621679410324"><span class="annot"><span class="annottext">propNoByronAddress :: Property
</span><a href="#local-6989586621679410324"><span class="hs-identifier hs-var hs-var">propNoByronAddress</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">TxOut CtxUTxO -&gt; AddressInEra
forall ctx. TxOut ctx -&gt; AddressInEra
</span><span class="hs-identifier hs-var">txOutAddress</span></span><span> </span><span class="annot"><span class="annottext">TxOut CtxUTxO
</span><a href="#local-6989586621679410326"><span class="hs-identifier hs-var">txOut</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-167"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">ByronAddressInEra</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByronAddress</span></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Property
forall prop. Testable prop =&gt; prop -&gt; Property
</span><span class="hs-identifier hs-var">property</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">False</span></a></span><span> </span><span class="annot"><span class="annottext">Property -&gt; (Property -&gt; Property) -&gt; Property
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; Property -&gt; Property
forall prop. Testable prop =&gt; String -&gt; prop -&gt; Property
</span><span class="hs-identifier hs-var">counterexample</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;generated byron address&quot;</span></span><span>
</span><span id="line-168"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">ShelleyAddressInEra</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ShelleyAddress</span></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Property
forall prop. Testable prop =&gt; prop -&gt; Property
</span><span class="hs-identifier hs-var">property</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-169"></span><span>
</span><span id="line-170"></span><span>  </span><span id="local-6989586621679410323"><span class="annot"><span class="annottext">hasDatum :: Bool
</span><a href="#local-6989586621679410323"><span class="hs-identifier hs-var hs-var">hasDatum</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TxOut CtxUTxO -&gt; TxOutDatum CtxUTxO
forall ctx. TxOut ctx -&gt; TxOutDatum ctx
</span><span class="hs-identifier hs-var">txOutDatum</span></span><span> </span><span class="annot"><span class="annottext">TxOut CtxUTxO
</span><a href="#local-6989586621679410326"><span class="hs-identifier hs-var">txOut</span></a></span><span> </span><span class="annot"><span class="annottext">TxOutDatum CtxUTxO -&gt; TxOutDatum CtxUTxO -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">/=</span></a></span><span> </span><span class="annot"><span class="annottext">TxOutDatum CtxUTxO
forall ctx. TxOutDatum ctx
</span><span class="hs-identifier hs-var">TxOutDatumNone</span></span><span>
</span><span id="line-171"></span><span>
</span><span id="line-172"></span><span>  </span><span id="local-6989586621679410320"><span class="annot"><span class="annottext">hasOnlyADA :: Bool
</span><a href="#local-6989586621679410320"><span class="hs-identifier hs-var hs-var">hasOnlyADA</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((AssetId, Quantity) -&gt; Bool) -&gt; [(AssetId, Quantity)] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">all</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679410307"><span class="annot"><span class="annottext">AssetId
</span><a href="#local-6989586621679410307"><span class="hs-identifier hs-var">an</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Quantity
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">AssetId
</span><a href="#local-6989586621679410307"><span class="hs-identifier hs-var">an</span></a></span><span> </span><span class="annot"><span class="annottext">AssetId -&gt; AssetId -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">AssetId
</span><span class="hs-identifier hs-var">AdaAssetId</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(AssetId, Quantity)]
</span><a href="#local-6989586621679410305"><span class="hs-identifier hs-var">assets</span></a></span><span>
</span><span id="line-173"></span><span>
</span><span id="line-174"></span><span>  </span><span id="local-6989586621679410319"><span class="annot"><span class="annottext">hasMultiAssets :: Bool
</span><a href="#local-6989586621679410319"><span class="hs-identifier hs-var hs-var">hasMultiAssets</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((AssetId, Quantity) -&gt; Bool) -&gt; [(AssetId, Quantity)] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">any</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679410303"><span class="annot"><span class="annottext">AssetId
</span><a href="#local-6989586621679410303"><span class="hs-identifier hs-var">an</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Quantity
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">AssetId
</span><a href="#local-6989586621679410303"><span class="hs-identifier hs-var">an</span></a></span><span> </span><span class="annot"><span class="annottext">AssetId -&gt; AssetId -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">/=</span></a></span><span> </span><span class="annot"><span class="annottext">AssetId
</span><span class="hs-identifier hs-var">AdaAssetId</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(AssetId, Quantity)]
</span><a href="#local-6989586621679410305"><span class="hs-identifier hs-var">assets</span></a></span><span>
</span><span id="line-175"></span><span>
</span><span id="line-176"></span><span>  </span><span id="local-6989586621679410305"><span class="annot"><span class="annottext">assets :: [(AssetId, Quantity)]
</span><a href="#local-6989586621679410305"><span class="hs-identifier hs-var hs-var">assets</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Value -&gt; [(AssetId, Quantity)]
</span><span class="hs-identifier hs-var">valueToList</span></span><span> </span><span class="annot"><span class="annottext">(Value -&gt; [(AssetId, Quantity)]) -&gt; Value -&gt; [(AssetId, Quantity)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">TxOut CtxUTxO -&gt; Value
forall ctx. TxOut ctx -&gt; Value
</span><span class="hs-identifier hs-var">txOutValue</span></span><span> </span><span class="annot"><span class="annottext">TxOut CtxUTxO
</span><a href="#local-6989586621679410326"><span class="hs-identifier hs-var">txOut</span></a></span><span>
</span><span id="line-177"></span><span>
</span><span id="line-178"></span><span>  </span><span id="local-6989586621679410322"><span class="annot"><span class="annottext">isVKOutput :: Bool
</span><a href="#local-6989586621679410322"><span class="hs-identifier hs-var hs-var">isVKOutput</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">TxOut CtxUTxO -&gt; AddressInEra
forall ctx. TxOut ctx -&gt; AddressInEra
</span><span class="hs-identifier hs-var">txOutAddress</span></span><span> </span><span class="annot"><span class="annottext">TxOut CtxUTxO
</span><a href="#local-6989586621679410326"><span class="hs-identifier hs-var">txOut</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-179"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">ByronAddressInEra</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByronAddress</span></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-180"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">ShelleyAddressInEra</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ShelleyAddress</span></span><span> </span><span class="annot"><span class="annottext">Network
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679410300"><span class="annot"><span class="annottext">PaymentCredential StandardCrypto
</span><a href="#local-6989586621679410300"><span class="hs-identifier hs-var">cred</span></a></span></span><span> </span><span class="annot"><span class="annottext">StakeReference StandardCrypto
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-181"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">PaymentCredential StandardCrypto
</span><a href="#local-6989586621679410300"><span class="hs-identifier hs-var">cred</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-182"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">KeyHashObj</span></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-183"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">ScriptHashObj</span></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-184"></span><span>
</span><span id="line-185"></span><span>  </span><span id="local-6989586621679410321"><span class="annot"><span class="annottext">isScriptOutput :: Bool
</span><a href="#local-6989586621679410321"><span class="hs-identifier hs-var hs-var">isScriptOutput</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">TxOut CtxUTxO -&gt; AddressInEra
forall ctx. TxOut ctx -&gt; AddressInEra
</span><span class="hs-identifier hs-var">txOutAddress</span></span><span> </span><span class="annot"><span class="annottext">TxOut CtxUTxO
</span><a href="#local-6989586621679410326"><span class="hs-identifier hs-var">txOut</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-186"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">ByronAddressInEra</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ByronAddress</span></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-187"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">ShelleyAddressInEra</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ShelleyAddress</span></span><span> </span><span class="annot"><span class="annottext">Network
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679410297"><span class="annot"><span class="annottext">PaymentCredential StandardCrypto
</span><a href="#local-6989586621679410297"><span class="hs-identifier hs-var">cred</span></a></span></span><span> </span><span class="annot"><span class="annottext">StakeReference StandardCrypto
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-188"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">PaymentCredential StandardCrypto
</span><a href="#local-6989586621679410297"><span class="hs-identifier hs-var">cred</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-189"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">KeyHashObj</span></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-190"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">ScriptHashObj</span></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-191"></span></pre></body></html>