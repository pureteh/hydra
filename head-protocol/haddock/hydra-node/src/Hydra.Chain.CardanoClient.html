<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">-- | A basic cardano-node client that can talk to a local cardano-node.</span><span>
</span><span id="line-2"></span><span class="hs-comment">--</span><span>
</span><span id="line-3"></span><span class="hs-comment">-- The idea of this module is to provide a Haskell interface on top of</span><span>
</span><span id="line-4"></span><span class="hs-comment">-- cardano-cli's API, using cardano-api types.</span><span>
</span><span id="line-5"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Hydra.Chain.CardanoClient</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-6"></span><span>
</span><span id="line-7"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Hydra.Prelude</span></span><span>
</span><span id="line-8"></span><span>
</span><span id="line-9"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Hydra.Cardano.Api</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Block</span></span><span class="hs-special">)</span><span>
</span><span id="line-10"></span><span>
</span><span id="line-11"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.Api.UTxO</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">UTxO</span></span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Set</span></span><span>
</span><span id="line-13"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Ouroboros.Consensus.HardFork.Combinator.AcrossEras</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">EraMismatch</span></span><span class="hs-special">)</span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Test.QuickCheck</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">oneof</span></span><span class="hs-special">)</span><span>
</span><span id="line-15"></span><span>
</span><span id="line-16"></span><span class="hs-keyword">type</span><span> </span><span id="NodeSocket"><span class="annot"><a href="Hydra.Chain.CardanoClient.html#NodeSocket"><span class="hs-identifier hs-var">NodeSocket</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">FilePath</span></a></span><span>
</span><span id="line-17"></span><span>
</span><span id="line-18"></span><span class="hs-keyword">data</span><span> </span><span id="QueryException"><span class="annot"><a href="Hydra.Chain.CardanoClient.html#QueryException"><span class="hs-identifier hs-var">QueryException</span></a></span></span><span>
</span><span id="line-19"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="QueryAcquireException"><span class="annot"><a href="Hydra.Chain.CardanoClient.html#QueryAcquireException"><span class="hs-identifier hs-var">QueryAcquireException</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">AcquiringFailure</span></span><span>
</span><span id="line-20"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="QueryEraMismatchException"><span class="annot"><a href="Hydra.Chain.CardanoClient.html#QueryEraMismatchException"><span class="hs-identifier hs-var">QueryEraMismatchException</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">EraMismatch</span></span><span>
</span><span id="line-21"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679990882"><span id="local-6989586621679990884"><span id="local-6989586621679990886"><span class="annot"><span class="annottext">Int -&gt; QueryException -&gt; ShowS
[QueryException] -&gt; ShowS
QueryException -&gt; String
(Int -&gt; QueryException -&gt; ShowS)
-&gt; (QueryException -&gt; String)
-&gt; ([QueryException] -&gt; ShowS)
-&gt; Show QueryException
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [QueryException] -&gt; ShowS
$cshowList :: [QueryException] -&gt; ShowS
show :: QueryException -&gt; String
$cshow :: QueryException -&gt; String
showsPrec :: Int -&gt; QueryException -&gt; ShowS
$cshowsPrec :: Int -&gt; QueryException -&gt; ShowS
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-22"></span><span>
</span><span id="line-23"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679990878"><span class="annot"><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="annot"><a href="Hydra.Chain.CardanoClient.html#QueryException"><span class="hs-identifier hs-type">QueryException</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-24"></span><span>  </span><span id="local-6989586621679990876"><span class="annot"><span class="annottext">QueryException
</span><a href="#local-6989586621679990876"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679990875"><span class="annot"><span class="annottext">== :: QueryException -&gt; QueryException -&gt; Bool
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var hs-var hs-var hs-var">==</span></a></span></span><span> </span><span id="local-6989586621679990874"><span class="annot"><span class="annottext">QueryException
</span><a href="#local-6989586621679990874"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QueryException
</span><a href="#local-6989586621679990876"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">QueryException
</span><a href="#local-6989586621679990874"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-25"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Hydra.Chain.CardanoClient.html#QueryAcquireException"><span class="hs-identifier hs-type">QueryAcquireException</span></a></span><span> </span><span id="local-6989586621679990873"><span class="annot"><span class="annottext">AcquiringFailure
</span><a href="#local-6989586621679990873"><span class="hs-identifier hs-var">af1</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hydra.Chain.CardanoClient.html#QueryAcquireException"><span class="hs-identifier hs-type">QueryAcquireException</span></a></span><span> </span><span id="local-6989586621679990872"><span class="annot"><span class="annottext">AcquiringFailure
</span><a href="#local-6989586621679990872"><span class="hs-identifier hs-var">af2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AcquiringFailure
</span><a href="#local-6989586621679990873"><span class="hs-identifier hs-var">af1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">AcquiringFailure
</span><a href="#local-6989586621679990872"><span class="hs-identifier hs-var">af2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-26"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AcquiringFailure
</span><span class="hs-identifier hs-var">AFPointTooOld</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">AcquiringFailure
</span><span class="hs-identifier hs-var">AFPointTooOld</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-27"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">AcquiringFailure
</span><span class="hs-identifier hs-var">AFPointNotOnChain</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">AcquiringFailure
</span><span class="hs-identifier hs-var">AFPointNotOnChain</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-28"></span><span>      </span><span class="annot"><span class="annottext">(AcquiringFailure, AcquiringFailure)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-29"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Hydra.Chain.CardanoClient.html#QueryEraMismatchException"><span class="hs-identifier hs-type">QueryEraMismatchException</span></a></span><span> </span><span id="local-6989586621679990869"><span class="annot"><span class="annottext">EraMismatch
</span><a href="#local-6989586621679990869"><span class="hs-identifier hs-var">em1</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Hydra.Chain.CardanoClient.html#QueryEraMismatchException"><span class="hs-identifier hs-type">QueryEraMismatchException</span></a></span><span> </span><span id="local-6989586621679990868"><span class="annot"><span class="annottext">EraMismatch
</span><a href="#local-6989586621679990868"><span class="hs-identifier hs-var">em2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">EraMismatch
</span><a href="#local-6989586621679990869"><span class="hs-identifier hs-var">em1</span></a></span><span> </span><span class="annot"><span class="annottext">EraMismatch -&gt; EraMismatch -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">EraMismatch
</span><a href="#local-6989586621679990868"><span class="hs-identifier hs-var">em2</span></a></span><span>
</span><span id="line-30"></span><span>    </span><span class="annot"><span class="annottext">(QueryException, QueryException)
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-31"></span><span>
</span><span id="line-32"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679990860"><span id="local-6989586621679990862"><span id="local-6989586621679990864"><span class="annot"><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Exception</span></a></span><span> </span><span class="annot"><a href="Hydra.Chain.CardanoClient.html#QueryException"><span class="hs-identifier hs-type">QueryException</span></a></span></span></span></span><span>
</span><span id="line-33"></span><span>
</span><span id="line-34"></span><span class="hs-comment">-- * CardanoClient handle</span><span>
</span><span id="line-35"></span><span>
</span><span id="line-36"></span><span class="hs-comment">-- | Handle interface for abstract querying of a cardano node.</span><span>
</span><span id="line-37"></span><span class="hs-keyword">data</span><span> </span><span id="CardanoClient"><span class="annot"><a href="Hydra.Chain.CardanoClient.html#CardanoClient"><span class="hs-identifier hs-var">CardanoClient</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="CardanoClient"><span class="annot"><a href="Hydra.Chain.CardanoClient.html#CardanoClient"><span class="hs-identifier hs-var">CardanoClient</span></a></span></span><span>
</span><span id="line-38"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="queryUTxOByAddress"><span class="annot"><span class="annottext">CardanoClient -&gt; [Address ShelleyAddr] -&gt; IO UTxO
</span><a href="Hydra.Chain.CardanoClient.html#queryUTxOByAddress"><span class="hs-identifier hs-var hs-var">queryUTxOByAddress</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Address</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ShelleyAddr</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">UTxO</span></span><span>
</span><span id="line-39"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="networkId"><span class="annot"><span class="annottext">CardanoClient -&gt; NetworkId
</span><a href="Hydra.Chain.CardanoClient.html#networkId"><span class="hs-identifier hs-var hs-var">networkId</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NetworkId</span></span><span>
</span><span id="line-40"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-41"></span><span>
</span><span id="line-42"></span><span class="hs-comment">-- | Construct a 'CardanoClient' handle.</span><span>
</span><span id="line-43"></span><span class="annot"><a href="Hydra.Chain.CardanoClient.html#mkCardanoClient"><span class="hs-identifier hs-type">mkCardanoClient</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NetworkId</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Hydra.Chain.CardanoClient.html#NodeSocket"><span class="hs-identifier hs-type">NodeSocket</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Hydra.Chain.CardanoClient.html#CardanoClient"><span class="hs-identifier hs-type">CardanoClient</span></a></span><span>
</span><span id="line-44"></span><span id="mkCardanoClient"><span class="annot"><span class="annottext">mkCardanoClient :: NetworkId -&gt; String -&gt; CardanoClient
</span><a href="Hydra.Chain.CardanoClient.html#mkCardanoClient"><span class="hs-identifier hs-var hs-var">mkCardanoClient</span></a></span></span><span> </span><span id="local-6989586621679990854"><span class="annot"><span class="annottext">NetworkId
</span><a href="#local-6989586621679990854"><span class="hs-identifier hs-var">networkId</span></a></span></span><span> </span><span id="local-6989586621679990853"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679990853"><span class="hs-identifier hs-var">nodeSocket</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-45"></span><span>  </span><span class="annot"><span class="annottext">CardanoClient :: ([Address ShelleyAddr] -&gt; IO UTxO) -&gt; NetworkId -&gt; CardanoClient
</span><a href="Hydra.Chain.CardanoClient.html#CardanoClient"><span class="hs-identifier hs-type">CardanoClient</span></a></span><span>
</span><span id="line-46"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">queryUTxOByAddress :: [Address ShelleyAddr] -&gt; IO UTxO
</span><a href="Hydra.Chain.CardanoClient.html#queryUTxOByAddress"><span class="hs-identifier hs-var">queryUTxOByAddress</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">NetworkId
-&gt; String -&gt; QueryPoint -&gt; [Address ShelleyAddr] -&gt; IO UTxO
</span><a href="Hydra.Chain.CardanoClient.html#queryUTxO"><span class="hs-identifier hs-var">queryUTxO</span></a></span><span> </span><span class="annot"><span class="annottext">NetworkId
</span><a href="#local-6989586621679990854"><span class="hs-identifier hs-var">networkId</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679990853"><span class="hs-identifier hs-var">nodeSocket</span></a></span><span> </span><span class="annot"><span class="annottext">QueryPoint
</span><a href="Hydra.Chain.CardanoClient.html#QueryTip"><span class="hs-identifier hs-var">QueryTip</span></a></span><span>
</span><span id="line-47"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NetworkId
networkId :: NetworkId
networkId :: NetworkId
</span><a href="#local-6989586621679990854"><span class="hs-identifier hs-var hs-var">networkId</span></a></span><span>
</span><span id="line-48"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-49"></span><span>
</span><span id="line-50"></span><span class="hs-comment">-- * Tx Construction / Submission</span><span>
</span><span id="line-51"></span><span>
</span><span id="line-52"></span><span class="hs-comment">-- | Construct a simple payment consuming some inputs and producing some</span><span>
</span><span id="line-53"></span><span class="hs-comment">-- outputs (no certificates or withdrawals involved).</span><span>
</span><span id="line-54"></span><span class="hs-comment">--</span><span>
</span><span id="line-55"></span><span class="hs-comment">-- On success, the returned transaction is fully balanced. On error, return</span><span>
</span><span id="line-56"></span><span class="hs-comment">-- `TxBodyErrorAutoBalance`.</span><span>
</span><span id="line-57"></span><span class="annot"><a href="Hydra.Chain.CardanoClient.html#buildTransaction"><span class="hs-identifier hs-type">buildTransaction</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-58"></span><span>  </span><span class="hs-comment">-- | Current network identifier</span><span>
</span><span id="line-59"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">NetworkId</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-60"></span><span>  </span><span class="hs-comment">-- | Filepath to the cardano-node's domain socket</span><span>
</span><span id="line-61"></span><span>  </span><span class="annot"><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">FilePath</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-62"></span><span>  </span><span class="hs-comment">-- | Change address to send</span><span>
</span><span id="line-63"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">AddressInEra</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-64"></span><span>  </span><span class="hs-comment">-- | Unspent transaction outputs to spend.</span><span>
</span><span id="line-65"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">UTxO</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-66"></span><span>  </span><span class="hs-comment">-- | Collateral inputs.</span><span>
</span><span id="line-67"></span><span>  </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">TxIn</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-68"></span><span>  </span><span class="hs-comment">-- | Outputs to create.</span><span>
</span><span id="line-69"></span><span>  </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">TxOut</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">CtxTx</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-70"></span><span>  </span><span class="annot"><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">TxBodyErrorAutoBalance</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">TxBody</span></span><span class="hs-special">)</span><span>
</span><span id="line-71"></span><span id="buildTransaction"><span class="annot"><span class="annottext">buildTransaction :: NetworkId
-&gt; String
-&gt; AddressInEra
-&gt; UTxO
-&gt; [TxIn]
-&gt; [TxOut CtxTx]
-&gt; IO (Either TxBodyErrorAutoBalance TxBody)
</span><a href="Hydra.Chain.CardanoClient.html#buildTransaction"><span class="hs-identifier hs-var hs-var">buildTransaction</span></a></span></span><span> </span><span id="local-6989586621679990849"><span class="annot"><span class="annottext">NetworkId
</span><a href="#local-6989586621679990849"><span class="hs-identifier hs-var">networkId</span></a></span></span><span> </span><span id="local-6989586621679990848"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679990848"><span class="hs-identifier hs-var">socket</span></a></span></span><span> </span><span id="local-6989586621679990847"><span class="annot"><span class="annottext">AddressInEra
</span><a href="#local-6989586621679990847"><span class="hs-identifier hs-var">changeAddress</span></a></span></span><span> </span><span id="local-6989586621679990846"><span class="annot"><span class="annottext">UTxO
</span><a href="#local-6989586621679990846"><span class="hs-identifier hs-var">utxoToSpend</span></a></span></span><span> </span><span id="local-6989586621679990845"><span class="annot"><span class="annottext">[TxIn]
</span><a href="#local-6989586621679990845"><span class="hs-identifier hs-var">collateral</span></a></span></span><span> </span><span id="local-6989586621679990844"><span class="annot"><span class="annottext">[TxOut CtxTx]
</span><a href="#local-6989586621679990844"><span class="hs-identifier hs-var">outs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-72"></span><span>  </span><span id="local-6989586621679990843"><span class="annot"><span class="annottext">ProtocolParameters
</span><a href="#local-6989586621679990843"><span class="hs-identifier hs-var">pparams</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NetworkId -&gt; String -&gt; QueryPoint -&gt; IO ProtocolParameters
</span><a href="Hydra.Chain.CardanoClient.html#queryProtocolParameters"><span class="hs-identifier hs-var">queryProtocolParameters</span></a></span><span> </span><span class="annot"><span class="annottext">NetworkId
</span><a href="#local-6989586621679990849"><span class="hs-identifier hs-var">networkId</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679990848"><span class="hs-identifier hs-var">socket</span></a></span><span> </span><span class="annot"><span class="annottext">QueryPoint
</span><a href="Hydra.Chain.CardanoClient.html#QueryTip"><span class="hs-identifier hs-var">QueryTip</span></a></span><span>
</span><span id="line-73"></span><span>  </span><span id="local-6989586621679990841"><span class="annot"><span class="annottext">SystemStart
</span><a href="#local-6989586621679990841"><span class="hs-identifier hs-var">systemStart</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NetworkId -&gt; String -&gt; QueryPoint -&gt; IO SystemStart
</span><a href="Hydra.Chain.CardanoClient.html#querySystemStart"><span class="hs-identifier hs-var">querySystemStart</span></a></span><span> </span><span class="annot"><span class="annottext">NetworkId
</span><a href="#local-6989586621679990849"><span class="hs-identifier hs-var">networkId</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679990848"><span class="hs-identifier hs-var">socket</span></a></span><span> </span><span class="annot"><span class="annottext">QueryPoint
</span><a href="Hydra.Chain.CardanoClient.html#QueryTip"><span class="hs-identifier hs-var">QueryTip</span></a></span><span>
</span><span id="line-74"></span><span>  </span><span id="local-6989586621679990839"><span class="annot"><span class="annottext">EraHistory CardanoMode
</span><a href="#local-6989586621679990839"><span class="hs-identifier hs-var">eraHistory</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NetworkId -&gt; String -&gt; QueryPoint -&gt; IO (EraHistory CardanoMode)
</span><a href="Hydra.Chain.CardanoClient.html#queryEraHistory"><span class="hs-identifier hs-var">queryEraHistory</span></a></span><span> </span><span class="annot"><span class="annottext">NetworkId
</span><a href="#local-6989586621679990849"><span class="hs-identifier hs-var">networkId</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679990848"><span class="hs-identifier hs-var">socket</span></a></span><span> </span><span class="annot"><span class="annottext">QueryPoint
</span><a href="Hydra.Chain.CardanoClient.html#QueryTip"><span class="hs-identifier hs-var">QueryTip</span></a></span><span>
</span><span id="line-75"></span><span>  </span><span id="local-6989586621679990837"><span class="annot"><span class="annottext">Set PoolId
</span><a href="#local-6989586621679990837"><span class="hs-identifier hs-var">stakePools</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NetworkId -&gt; String -&gt; QueryPoint -&gt; IO (Set PoolId)
</span><a href="Hydra.Chain.CardanoClient.html#queryStakePools"><span class="hs-identifier hs-var">queryStakePools</span></a></span><span> </span><span class="annot"><span class="annottext">NetworkId
</span><a href="#local-6989586621679990849"><span class="hs-identifier hs-var">networkId</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679990848"><span class="hs-identifier hs-var">socket</span></a></span><span> </span><span class="annot"><span class="annottext">QueryPoint
</span><a href="Hydra.Chain.CardanoClient.html#QueryTip"><span class="hs-identifier hs-var">QueryTip</span></a></span><span>
</span><span id="line-76"></span><span>  </span><span class="annot"><span class="annottext">Either TxBodyErrorAutoBalance TxBody
-&gt; IO (Either TxBodyErrorAutoBalance TxBody)
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Either TxBodyErrorAutoBalance TxBody
 -&gt; IO (Either TxBodyErrorAutoBalance TxBody))
-&gt; Either TxBodyErrorAutoBalance TxBody
-&gt; IO (Either TxBodyErrorAutoBalance TxBody)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-77"></span><span>    </span><span class="annot"><span class="annottext">(BalancedTxBody -&gt; TxBody)
-&gt; Either TxBodyErrorAutoBalance BalancedTxBody
-&gt; Either TxBodyErrorAutoBalance TxBody
forall (p :: * -&gt; * -&gt; *) b c a.
Bifunctor p =&gt;
(b -&gt; c) -&gt; p a b -&gt; p a c
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">second</span></a></span><span> </span><span class="annot"><span class="annottext">BalancedTxBody -&gt; TxBody
</span><span class="hs-identifier hs-var">balancedTxBody</span></span><span> </span><span class="annot"><span class="annottext">(Either TxBodyErrorAutoBalance BalancedTxBody
 -&gt; Either TxBodyErrorAutoBalance TxBody)
-&gt; Either TxBodyErrorAutoBalance BalancedTxBody
-&gt; Either TxBodyErrorAutoBalance TxBody
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-78"></span><span>      </span><span class="annot"><span class="annottext">SystemStart
-&gt; LedgerEpochInfo
-&gt; ProtocolParameters
-&gt; Set PoolId
-&gt; UTxO Era
-&gt; TxBodyContent BuildTx Era
-&gt; AddressInEra
-&gt; Maybe Word
-&gt; Either TxBodyErrorAutoBalance BalancedTxBody
forall era.
IsShelleyBasedEra era =&gt;
SystemStart
-&gt; LedgerEpochInfo
-&gt; ProtocolParameters
-&gt; Set PoolId
-&gt; UTxO era
-&gt; TxBodyContent BuildTx era
-&gt; AddressInEra era
-&gt; Maybe Word
-&gt; Either TxBodyErrorAutoBalance (BalancedTxBody era)
</span><span class="hs-identifier hs-var">makeTransactionBodyAutoBalance</span></span><span>
</span><span id="line-79"></span><span>        </span><span class="annot"><span class="annottext">SystemStart
</span><a href="#local-6989586621679990841"><span class="hs-identifier hs-var">systemStart</span></a></span><span>
</span><span id="line-80"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EraHistory CardanoMode -&gt; LedgerEpochInfo
forall mode. EraHistory mode -&gt; LedgerEpochInfo
</span><span class="hs-identifier hs-var">toLedgerEpochInfo</span></span><span> </span><span class="annot"><span class="annottext">EraHistory CardanoMode
</span><a href="#local-6989586621679990839"><span class="hs-identifier hs-var">eraHistory</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-81"></span><span>        </span><span class="annot"><span class="annottext">ProtocolParameters
</span><a href="#local-6989586621679990843"><span class="hs-identifier hs-var">pparams</span></a></span><span>
</span><span id="line-82"></span><span>        </span><span class="annot"><span class="annottext">Set PoolId
</span><a href="#local-6989586621679990837"><span class="hs-identifier hs-var">stakePools</span></a></span><span>
</span><span id="line-83"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UTxO -&gt; UTxO Era
</span><span class="hs-identifier hs-var">UTxO.toApi</span></span><span> </span><span class="annot"><span class="annottext">UTxO
</span><a href="#local-6989586621679990846"><span class="hs-identifier hs-var">utxoToSpend</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-84"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ProtocolParameters -&gt; TxBodyContent BuildTx Era
</span><a href="#local-6989586621679990830"><span class="hs-identifier hs-var">bodyContent</span></a></span><span> </span><span class="annot"><span class="annottext">ProtocolParameters
</span><a href="#local-6989586621679990843"><span class="hs-identifier hs-var">pparams</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-85"></span><span>        </span><span class="annot"><span class="annottext">AddressInEra
</span><a href="#local-6989586621679990847"><span class="hs-identifier hs-var">changeAddress</span></a></span><span>
</span><span id="line-86"></span><span>        </span><span class="annot"><span class="annottext">Maybe Word
forall a. Maybe a
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-87"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-88"></span><span>  </span><span class="hs-comment">-- NOTE: 'makeTransactionBodyAutoBalance' overwrites this.</span><span>
</span><span id="line-89"></span><span>  </span><span id="local-6989586621679990829"><span class="annot"><span class="annottext">dummyFeeForBalancing :: TxFee
</span><a href="#local-6989586621679990829"><span class="hs-identifier hs-var hs-var">dummyFeeForBalancing</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Lovelace -&gt; TxFee
</span><span class="hs-identifier hs-var">TxFeeExplicit</span></span><span> </span><span class="annot"><span class="annottext">Lovelace
</span><span class="hs-number">0</span></span><span>
</span><span id="line-90"></span><span>
</span><span id="line-91"></span><span>  </span><span id="local-6989586621679990830"><span class="annot"><span class="annottext">bodyContent :: ProtocolParameters -&gt; TxBodyContent BuildTx Era
</span><a href="#local-6989586621679990830"><span class="hs-identifier hs-var hs-var">bodyContent</span></a></span></span><span> </span><span id="local-6989586621679990827"><span class="annot"><span class="annottext">ProtocolParameters
</span><a href="#local-6989586621679990827"><span class="hs-identifier hs-var">pparams</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-92"></span><span>    </span><span class="annot"><span class="annottext">TxIns BuildTx
-&gt; TxInsCollateral
-&gt; TxInsReference BuildTx
-&gt; [TxOut CtxTx]
-&gt; TxTotalCollateral Era
-&gt; TxReturnCollateral CtxTx Era
-&gt; TxFee
-&gt; (TxValidityLowerBound, TxValidityUpperBound)
-&gt; TxMetadataInEra
-&gt; TxAuxScripts
-&gt; TxExtraKeyWitnesses
-&gt; BuildTxWith BuildTx (Maybe ProtocolParameters)
-&gt; TxWithdrawals BuildTx Era
-&gt; TxCertificates BuildTx Era
-&gt; TxUpdateProposal Era
-&gt; TxMintValue BuildTx
-&gt; TxScriptValidity
-&gt; TxBodyContent BuildTx Era
forall build.
TxIns build
-&gt; TxInsCollateral
-&gt; TxInsReference build
-&gt; [TxOut CtxTx]
-&gt; TxTotalCollateral Era
-&gt; TxReturnCollateral CtxTx Era
-&gt; TxFee
-&gt; (TxValidityLowerBound, TxValidityUpperBound)
-&gt; TxMetadataInEra
-&gt; TxAuxScripts
-&gt; TxExtraKeyWitnesses
-&gt; BuildTxWith build (Maybe ProtocolParameters)
-&gt; TxWithdrawals build Era
-&gt; TxCertificates build Era
-&gt; TxUpdateProposal Era
-&gt; TxMintValue build
-&gt; TxScriptValidity
-&gt; TxBodyContent build
</span><span class="hs-identifier hs-var">TxBodyContent</span></span><span>
</span><span id="line-93"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxIn -&gt; (TxIn, BuildTxWith BuildTx (Witness WitCtxTxIn Era))
</span><span class="hs-identifier hs-var">withWitness</span></span><span> </span><span class="annot"><span class="annottext">(TxIn -&gt; (TxIn, BuildTxWith BuildTx (Witness WitCtxTxIn Era)))
-&gt; [TxIn] -&gt; TxIns BuildTx
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Set TxIn -&gt; [TxIn]
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; [a]
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">toList</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UTxO -&gt; Set TxIn
forall out. UTxO' out -&gt; Set TxIn
</span><span class="hs-identifier hs-var">UTxO.inputSet</span></span><span> </span><span class="annot"><span class="annottext">UTxO
</span><a href="#local-6989586621679990846"><span class="hs-identifier hs-var">utxoToSpend</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-94"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[TxIn] -&gt; TxInsCollateral
</span><span class="hs-identifier hs-var">TxInsCollateral</span></span><span> </span><span class="annot"><span class="annottext">[TxIn]
</span><a href="#local-6989586621679990845"><span class="hs-identifier hs-var">collateral</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-95"></span><span>      </span><span class="annot"><span class="annottext">TxInsReference BuildTx
forall buidl. TxInsReference buidl
</span><span class="hs-identifier hs-var">TxInsReferenceNone</span></span><span>
</span><span id="line-96"></span><span>      </span><span class="annot"><span class="annottext">[TxOut CtxTx]
</span><a href="#local-6989586621679990844"><span class="hs-identifier hs-var">outs</span></a></span><span>
</span><span id="line-97"></span><span>      </span><span class="annot"><span class="annottext">TxTotalCollateral Era
forall era. TxTotalCollateral era
</span><span class="hs-identifier hs-var">TxTotalCollateralNone</span></span><span>
</span><span id="line-98"></span><span>      </span><span class="annot"><span class="annottext">TxReturnCollateral CtxTx Era
forall ctx era. TxReturnCollateral ctx era
</span><span class="hs-identifier hs-var">TxReturnCollateralNone</span></span><span>
</span><span id="line-99"></span><span>      </span><span class="annot"><span class="annottext">TxFee
</span><a href="#local-6989586621679990829"><span class="hs-identifier hs-var">dummyFeeForBalancing</span></a></span><span>
</span><span id="line-100"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxValidityLowerBound
</span><span class="hs-identifier hs-var">TxValidityNoLowerBound</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TxValidityUpperBound
</span><span class="hs-identifier hs-var">TxValidityNoUpperBound</span></span><span class="hs-special">)</span><span>
</span><span id="line-101"></span><span>      </span><span class="annot"><span class="annottext">TxMetadataInEra
</span><span class="hs-identifier hs-var">TxMetadataNone</span></span><span>
</span><span id="line-102"></span><span>      </span><span class="annot"><span class="annottext">TxAuxScripts
</span><span class="hs-identifier hs-var">TxAuxScriptsNone</span></span><span>
</span><span id="line-103"></span><span>      </span><span class="annot"><span class="annottext">TxExtraKeyWitnesses
</span><span class="hs-identifier hs-var">TxExtraKeyWitnessesNone</span></span><span>
</span><span id="line-104"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe ProtocolParameters
-&gt; BuildTxWith BuildTx (Maybe ProtocolParameters)
forall a. a -&gt; BuildTxWith BuildTx a
</span><span class="hs-identifier hs-var">BuildTxWith</span></span><span> </span><span class="annot"><span class="annottext">(Maybe ProtocolParameters
 -&gt; BuildTxWith BuildTx (Maybe ProtocolParameters))
-&gt; Maybe ProtocolParameters
-&gt; BuildTxWith BuildTx (Maybe ProtocolParameters)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ProtocolParameters -&gt; Maybe ProtocolParameters
forall a. a -&gt; Maybe a
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">ProtocolParameters
</span><a href="#local-6989586621679990827"><span class="hs-identifier hs-var">pparams</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-105"></span><span>      </span><span class="annot"><span class="annottext">TxWithdrawals BuildTx Era
forall build era. TxWithdrawals build era
</span><span class="hs-identifier hs-var">TxWithdrawalsNone</span></span><span>
</span><span id="line-106"></span><span>      </span><span class="annot"><span class="annottext">TxCertificates BuildTx Era
forall build era. TxCertificates build era
</span><span class="hs-identifier hs-var">TxCertificatesNone</span></span><span>
</span><span id="line-107"></span><span>      </span><span class="annot"><span class="annottext">TxUpdateProposal Era
forall era. TxUpdateProposal era
</span><span class="hs-identifier hs-var">TxUpdateProposalNone</span></span><span>
</span><span id="line-108"></span><span>      </span><span class="annot"><span class="annottext">TxMintValue BuildTx
forall build. TxMintValue build
</span><span class="hs-identifier hs-var">TxMintValueNone</span></span><span>
</span><span id="line-109"></span><span>      </span><span class="annot"><span class="annottext">TxScriptValidity
</span><span class="hs-identifier hs-var">TxScriptValidityNone</span></span><span>
</span><span id="line-110"></span><span>
</span><span id="line-111"></span><span class="hs-comment">-- | Submit a (signed) transaction to the node.</span><span>
</span><span id="line-112"></span><span class="hs-comment">--</span><span>
</span><span id="line-113"></span><span class="hs-comment">-- Throws 'SubmitTransactionException' if submission fails.</span><span>
</span><span id="line-114"></span><span class="annot"><a href="Hydra.Chain.CardanoClient.html#submitTransaction"><span class="hs-identifier hs-type">submitTransaction</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-115"></span><span>  </span><span class="hs-comment">-- | Current network discriminant</span><span>
</span><span id="line-116"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">NetworkId</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-117"></span><span>  </span><span class="hs-comment">-- | Filepath to the cardano-node's domain socket</span><span>
</span><span id="line-118"></span><span>  </span><span class="annot"><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">FilePath</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-119"></span><span>  </span><span class="hs-comment">-- | A signed transaction.</span><span>
</span><span id="line-120"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Tx</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-121"></span><span>  </span><span class="annot"><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-122"></span><span id="submitTransaction"><span class="annot"><span class="annottext">submitTransaction :: NetworkId -&gt; String -&gt; Tx -&gt; IO ()
</span><a href="Hydra.Chain.CardanoClient.html#submitTransaction"><span class="hs-identifier hs-var hs-var">submitTransaction</span></a></span></span><span> </span><span id="local-6989586621679990805"><span class="annot"><span class="annottext">NetworkId
</span><a href="#local-6989586621679990805"><span class="hs-identifier hs-var">networkId</span></a></span></span><span> </span><span id="local-6989586621679990804"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679990804"><span class="hs-identifier hs-var">socket</span></a></span></span><span> </span><span id="local-6989586621679990803"><span class="annot"><span class="annottext">Tx
</span><a href="#local-6989586621679990803"><span class="hs-identifier hs-var">tx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-123"></span><span>  </span><span class="annot"><span class="annottext">LocalNodeConnectInfo CardanoMode
-&gt; TxInMode CardanoMode
-&gt; IO (SubmitResult (TxValidationErrorInMode CardanoMode))
forall mode.
LocalNodeConnectInfo mode
-&gt; TxInMode mode
-&gt; IO (SubmitResult (TxValidationErrorInMode mode))
</span><span class="hs-identifier hs-var">submitTxToNodeLocal</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NetworkId -&gt; String -&gt; LocalNodeConnectInfo CardanoMode
</span><a href="Hydra.Chain.CardanoClient.html#localNodeConnectInfo"><span class="hs-identifier hs-var">localNodeConnectInfo</span></a></span><span> </span><span class="annot"><span class="annottext">NetworkId
</span><a href="#local-6989586621679990805"><span class="hs-identifier hs-var">networkId</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679990804"><span class="hs-identifier hs-var">socket</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TxInMode CardanoMode
</span><a href="#local-6989586621679990800"><span class="hs-identifier hs-var">txInMode</span></a></span><span> </span><span class="annot"><span class="annottext">IO (SubmitResult (TxValidationErrorInMode CardanoMode))
-&gt; (SubmitResult (TxValidationErrorInMode CardanoMode) -&gt; IO ())
-&gt; IO ()
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-124"></span><span>    </span><span class="annot"><span class="annottext">SubmitResult (TxValidationErrorInMode CardanoMode)
</span><span class="hs-identifier hs-var">SubmitSuccess</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-125"></span><span>      </span><span class="annot"><span class="annottext">() -&gt; IO ()
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-126"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">SubmitFail</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TxValidationEraMismatch</span></span><span> </span><span id="local-6989586621679990796"><span class="annot"><span class="annottext">EraMismatch
</span><a href="#local-6989586621679990796"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-127"></span><span>      </span><span class="annot"><span class="annottext">SubmitTransactionException -&gt; IO ()
forall (m :: * -&gt; *) e a. (MonadThrow m, Exception e) =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwIO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">EraMismatch -&gt; SubmitTransactionException
</span><a href="Hydra.Chain.CardanoClient.html#SubmitEraMismatch"><span class="hs-identifier hs-var">SubmitEraMismatch</span></a></span><span> </span><span class="annot"><span class="annottext">EraMismatch
</span><a href="#local-6989586621679990796"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-128"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">SubmitFail</span></span><span> </span><span id="local-6989586621679990793"><span class="annot"><span class="annottext">e :: TxValidationErrorInMode CardanoMode
</span><a href="#local-6989586621679990793"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><span class="hs-identifier hs-type">TxValidationErrorInMode</span></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-129"></span><span>      </span><span class="annot"><span class="annottext">SubmitTransactionException -&gt; IO ()
forall (m :: * -&gt; *) e a. (MonadThrow m, Exception e) =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwIO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxValidationErrorInMode CardanoMode -&gt; SubmitTransactionException
</span><a href="Hydra.Chain.CardanoClient.html#SubmitTxValidationError"><span class="hs-identifier hs-var">SubmitTxValidationError</span></a></span><span> </span><span class="annot"><span class="annottext">TxValidationErrorInMode CardanoMode
</span><a href="#local-6989586621679990793"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-130"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-131"></span><span>  </span><span id="local-6989586621679990800"><span class="annot"><span class="annottext">txInMode :: TxInMode CardanoMode
</span><a href="#local-6989586621679990800"><span class="hs-identifier hs-var hs-var">txInMode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-132"></span><span>    </span><span class="annot"><span class="annottext">Tx -&gt; EraInMode Era CardanoMode -&gt; TxInMode CardanoMode
forall era mode. Tx era -&gt; EraInMode era mode -&gt; TxInMode mode
</span><span class="hs-identifier hs-var">TxInMode</span></span><span> </span><span class="annot"><span class="annottext">Tx
</span><a href="#local-6989586621679990803"><span class="hs-identifier hs-var">tx</span></a></span><span> </span><span class="annot"><span class="annottext">EraInMode Era CardanoMode
</span><span class="hs-identifier hs-var">BabbageEraInCardanoMode</span></span><span>
</span><span id="line-133"></span><span>
</span><span id="line-134"></span><span class="hs-comment">-- | Exceptions that 'can' occur during a transaction submission.</span><span>
</span><span id="line-135"></span><span class="hs-comment">--</span><span>
</span><span id="line-136"></span><span class="hs-comment">-- In principle, we can only encounter an 'EraMismatch' at era boundaries, when</span><span>
</span><span id="line-137"></span><span class="hs-comment">-- we try to submit a &quot;next era&quot; transaction as a &quot;current era&quot; transaction, or</span><span>
</span><span id="line-138"></span><span class="hs-comment">-- vice-versa.</span><span>
</span><span id="line-139"></span><span class="hs-comment">-- Similarly, 'TxValidationError' shouldn't occur given that the transaction was</span><span>
</span><span id="line-140"></span><span class="hs-comment">-- safely constructed through 'buildTransaction'.</span><span>
</span><span id="line-141"></span><span class="hs-keyword">data</span><span> </span><span id="SubmitTransactionException"><span class="annot"><a href="Hydra.Chain.CardanoClient.html#SubmitTransactionException"><span class="hs-identifier hs-var">SubmitTransactionException</span></a></span></span><span>
</span><span id="line-142"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="SubmitEraMismatch"><span class="annot"><a href="Hydra.Chain.CardanoClient.html#SubmitEraMismatch"><span class="hs-identifier hs-var">SubmitEraMismatch</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">EraMismatch</span></span><span>
</span><span id="line-143"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="SubmitTxValidationError"><span class="annot"><a href="Hydra.Chain.CardanoClient.html#SubmitTxValidationError"><span class="hs-identifier hs-var">SubmitTxValidationError</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TxValidationErrorInMode</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">CardanoMode</span></span><span class="hs-special">)</span><span>
</span><span id="line-144"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679990783"><span id="local-6989586621679990785"><span id="local-6989586621679990787"><span class="annot"><span class="annottext">Int -&gt; SubmitTransactionException -&gt; ShowS
[SubmitTransactionException] -&gt; ShowS
SubmitTransactionException -&gt; String
(Int -&gt; SubmitTransactionException -&gt; ShowS)
-&gt; (SubmitTransactionException -&gt; String)
-&gt; ([SubmitTransactionException] -&gt; ShowS)
-&gt; Show SubmitTransactionException
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [SubmitTransactionException] -&gt; ShowS
$cshowList :: [SubmitTransactionException] -&gt; ShowS
show :: SubmitTransactionException -&gt; String
$cshow :: SubmitTransactionException -&gt; String
showsPrec :: Int -&gt; SubmitTransactionException -&gt; ShowS
$cshowsPrec :: Int -&gt; SubmitTransactionException -&gt; ShowS
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-145"></span><span>
</span><span id="line-146"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679990775"><span id="local-6989586621679990777"><span id="local-6989586621679990779"><span class="annot"><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Exception</span></a></span><span> </span><span class="annot"><a href="Hydra.Chain.CardanoClient.html#SubmitTransactionException"><span class="hs-identifier hs-type">SubmitTransactionException</span></a></span></span></span></span><span>
</span><span id="line-147"></span><span>
</span><span id="line-148"></span><span class="hs-comment">-- | Await until the given transaction is visible on-chain. Returns the UTxO</span><span>
</span><span id="line-149"></span><span class="hs-comment">-- set produced by that transaction.</span><span>
</span><span id="line-150"></span><span class="hs-comment">--</span><span>
</span><span id="line-151"></span><span class="hs-comment">-- Note that this function loops forever; hence, one probably wants to couple it</span><span>
</span><span id="line-152"></span><span class="hs-comment">-- with a surrounding timeout.</span><span>
</span><span id="line-153"></span><span class="annot"><a href="Hydra.Chain.CardanoClient.html#awaitTransaction"><span class="hs-identifier hs-type">awaitTransaction</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-154"></span><span>  </span><span class="hs-comment">-- | Current network discriminant</span><span>
</span><span id="line-155"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">NetworkId</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-156"></span><span>  </span><span class="hs-comment">-- | Filepath to the cardano-node's domain socket</span><span>
</span><span id="line-157"></span><span>  </span><span class="annot"><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">FilePath</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-158"></span><span>  </span><span class="hs-comment">-- | The transaction to watch / await</span><span>
</span><span id="line-159"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Tx</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-160"></span><span>  </span><span class="annot"><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">UTxO</span></span><span>
</span><span id="line-161"></span><span id="awaitTransaction"><span class="annot"><span class="annottext">awaitTransaction :: NetworkId -&gt; String -&gt; Tx -&gt; IO UTxO
</span><a href="Hydra.Chain.CardanoClient.html#awaitTransaction"><span class="hs-identifier hs-var hs-var">awaitTransaction</span></a></span></span><span> </span><span id="local-6989586621679990773"><span class="annot"><span class="annottext">NetworkId
</span><a href="#local-6989586621679990773"><span class="hs-identifier hs-var">networkId</span></a></span></span><span> </span><span id="local-6989586621679990772"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679990772"><span class="hs-identifier hs-var">socket</span></a></span></span><span> </span><span id="local-6989586621679990771"><span class="annot"><span class="annottext">Tx
</span><a href="#local-6989586621679990771"><span class="hs-identifier hs-var">tx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-162"></span><span>  </span><span class="annot"><span class="annottext">IO UTxO
</span><a href="#local-6989586621679990770"><span class="hs-identifier hs-var">go</span></a></span><span>
</span><span id="line-163"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-164"></span><span>  </span><span id="local-6989586621679990769"><span class="annot"><span class="annottext">ins :: [TxIn]
</span><a href="#local-6989586621679990769"><span class="hs-identifier hs-var hs-var">ins</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map TxIn (TxOut CtxUTxO Era) -&gt; [TxIn]
forall t a b. (IsList t, Item t ~ (a, b)) =&gt; t -&gt; [a]
</span><span class="hs-identifier hs-var">keys</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">UTxO -&gt; Map TxIn (TxOut CtxUTxO Era)
forall out. UTxO' out -&gt; Map TxIn out
</span><span class="hs-identifier hs-var hs-var">UTxO.toMap</span></span><span> </span><span class="annot"><span class="annottext">(UTxO -&gt; Map TxIn (TxOut CtxUTxO Era))
-&gt; UTxO -&gt; Map TxIn (TxOut CtxUTxO Era)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Tx -&gt; UTxO
</span><span class="hs-identifier hs-var">utxoFromTx</span></span><span> </span><span class="annot"><span class="annottext">Tx
</span><a href="#local-6989586621679990771"><span class="hs-identifier hs-var">tx</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-165"></span><span>  </span><span id="local-6989586621679990770"><span class="annot"><span class="annottext">go :: IO UTxO
</span><a href="#local-6989586621679990770"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-166"></span><span>    </span><span id="local-6989586621679990765"><span class="annot"><span class="annottext">UTxO
</span><a href="#local-6989586621679990765"><span class="hs-identifier hs-var">utxo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">NetworkId -&gt; String -&gt; QueryPoint -&gt; [TxIn] -&gt; IO UTxO
</span><a href="Hydra.Chain.CardanoClient.html#queryUTxOByTxIn"><span class="hs-identifier hs-var">queryUTxOByTxIn</span></a></span><span> </span><span class="annot"><span class="annottext">NetworkId
</span><a href="#local-6989586621679990773"><span class="hs-identifier hs-var">networkId</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679990772"><span class="hs-identifier hs-var">socket</span></a></span><span> </span><span class="annot"><span class="annottext">QueryPoint
</span><a href="Hydra.Chain.CardanoClient.html#QueryTip"><span class="hs-identifier hs-var">QueryTip</span></a></span><span> </span><span class="annot"><span class="annottext">[TxIn]
</span><a href="#local-6989586621679990769"><span class="hs-identifier hs-var">ins</span></a></span><span>
</span><span id="line-167"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">UTxO -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">null</span></a></span><span> </span><span class="annot"><span class="annottext">UTxO
</span><a href="#local-6989586621679990765"><span class="hs-identifier hs-var">utxo</span></a></span><span>
</span><span id="line-168"></span><span>      </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">IO UTxO
</span><a href="#local-6989586621679990770"><span class="hs-identifier hs-var">go</span></a></span><span>
</span><span id="line-169"></span><span>      </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">UTxO -&gt; IO UTxO
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">UTxO
</span><a href="#local-6989586621679990765"><span class="hs-identifier hs-var">utxo</span></a></span><span>
</span><span id="line-170"></span><span>
</span><span id="line-171"></span><span class="hs-comment">-- * Local state query</span><span>
</span><span id="line-172"></span><span>
</span><span id="line-173"></span><span class="hs-comment">-- | Describes whether to query at the tip or at a specific point.</span><span>
</span><span id="line-174"></span><span id="local-6989586621679990761"><span id="local-6989586621679990762"></span></span><span class="hs-keyword">data</span><span> </span><span id="QueryPoint"><span class="annot"><a href="Hydra.Chain.CardanoClient.html#QueryPoint"><span class="hs-identifier hs-var">QueryPoint</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="QueryTip"><span class="annot"><a href="Hydra.Chain.CardanoClient.html#QueryTip"><span class="hs-identifier hs-var">QueryTip</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="QueryAt"><span class="annot"><a href="Hydra.Chain.CardanoClient.html#QueryAt"><span class="hs-identifier hs-var">QueryAt</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ChainPoint</span></span><span>
</span><span id="line-175"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679990756"><span id="local-6989586621679990758"><span class="annot"><span class="annottext">QueryPoint -&gt; QueryPoint -&gt; Bool
(QueryPoint -&gt; QueryPoint -&gt; Bool)
-&gt; (QueryPoint -&gt; QueryPoint -&gt; Bool) -&gt; Eq QueryPoint
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: QueryPoint -&gt; QueryPoint -&gt; Bool
$c/= :: QueryPoint -&gt; QueryPoint -&gt; Bool
== :: QueryPoint -&gt; QueryPoint -&gt; Bool
$c== :: QueryPoint -&gt; QueryPoint -&gt; Bool
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679990750"><span id="local-6989586621679990752"><span id="local-6989586621679990754"><span class="annot"><span class="annottext">Int -&gt; QueryPoint -&gt; ShowS
[QueryPoint] -&gt; ShowS
QueryPoint -&gt; String
(Int -&gt; QueryPoint -&gt; ShowS)
-&gt; (QueryPoint -&gt; String)
-&gt; ([QueryPoint] -&gt; ShowS)
-&gt; Show QueryPoint
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [QueryPoint] -&gt; ShowS
$cshowList :: [QueryPoint] -&gt; ShowS
show :: QueryPoint -&gt; String
$cshow :: QueryPoint -&gt; String
showsPrec :: Int -&gt; QueryPoint -&gt; ShowS
$cshowsPrec :: Int -&gt; QueryPoint -&gt; ShowS
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">(forall x. QueryPoint -&gt; Rep QueryPoint x)
-&gt; (forall x. Rep QueryPoint x -&gt; QueryPoint) -&gt; Generic QueryPoint
forall x. Rep QueryPoint x -&gt; QueryPoint
forall x. QueryPoint -&gt; Rep QueryPoint x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cto :: forall x. Rep QueryPoint x -&gt; QueryPoint
$cfrom :: forall x. QueryPoint -&gt; Rep QueryPoint x
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-176"></span><span>
</span><span id="line-177"></span><span id="local-6989586621679990739"><span id="local-6989586621679990741"><span id="local-6989586621679990743"><span id="local-6989586621679990745"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ToJSON</span></span><span> </span><span class="annot"><a href="Hydra.Chain.CardanoClient.html#QueryPoint"><span class="hs-identifier hs-type">QueryPoint</span></a></span></span></span></span></span><span>
</span><span id="line-178"></span><span>
</span><span id="line-179"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679990735"><span class="annot"><span class="hs-identifier hs-type">Arbitrary</span></span><span> </span><span class="annot"><a href="Hydra.Chain.CardanoClient.html#QueryPoint"><span class="hs-identifier hs-type">QueryPoint</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-180"></span><span>  </span><span class="hs-comment">-- XXX: This is not complete as we lack an 'Arbitrary ChainPoint' and we have</span><span>
</span><span id="line-181"></span><span>  </span><span class="hs-comment">-- not bothered about it yet.</span><span>
</span><span id="line-182"></span><span>  </span><span id="local-6989586621679990733"><span class="annot"><span class="annottext">arbitrary :: Gen QueryPoint
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">arbitrary</span></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-183"></span><span>    </span><span class="annot"><span class="annottext">[Gen QueryPoint] -&gt; Gen QueryPoint
forall a. [Gen a] -&gt; Gen a
</span><span class="hs-identifier hs-var">oneof</span></span><span>
</span><span id="line-184"></span><span>      </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">QueryPoint -&gt; Gen QueryPoint
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">QueryPoint
</span><a href="Hydra.Chain.CardanoClient.html#QueryTip"><span class="hs-identifier hs-var">QueryTip</span></a></span><span>
</span><span id="line-185"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">QueryPoint -&gt; Gen QueryPoint
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(QueryPoint -&gt; Gen QueryPoint) -&gt; QueryPoint -&gt; Gen QueryPoint
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ChainPoint -&gt; QueryPoint
</span><a href="Hydra.Chain.CardanoClient.html#QueryAt"><span class="hs-identifier hs-var">QueryAt</span></a></span><span> </span><span class="annot"><span class="annottext">ChainPoint
</span><span class="hs-identifier hs-var">ChainPointAtGenesis</span></span><span>
</span><span id="line-186"></span><span>      </span><span class="hs-special">]</span><span>
</span><span id="line-187"></span><span>
</span><span id="line-188"></span><span class="hs-comment">-- | Query the latest chain point aka &quot;the tip&quot;.</span><span>
</span><span id="line-189"></span><span class="annot"><a href="Hydra.Chain.CardanoClient.html#queryTip"><span class="hs-identifier hs-type">queryTip</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NetworkId</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">FilePath</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ChainPoint</span></span><span>
</span><span id="line-190"></span><span id="queryTip"><span class="annot"><span class="annottext">queryTip :: NetworkId -&gt; String -&gt; IO ChainPoint
</span><a href="Hydra.Chain.CardanoClient.html#queryTip"><span class="hs-identifier hs-var hs-var">queryTip</span></a></span></span><span> </span><span id="local-6989586621679990729"><span class="annot"><span class="annottext">NetworkId
</span><a href="#local-6989586621679990729"><span class="hs-identifier hs-var">networkId</span></a></span></span><span> </span><span id="local-6989586621679990728"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679990728"><span class="hs-identifier hs-var">socket</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-191"></span><span>  </span><span class="annot"><span class="annottext">ChainTip -&gt; ChainPoint
</span><span class="hs-identifier hs-var">chainTipToChainPoint</span></span><span> </span><span class="annot"><span class="annottext">(ChainTip -&gt; ChainPoint) -&gt; IO ChainTip -&gt; IO ChainPoint
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">LocalNodeConnectInfo CardanoMode -&gt; IO ChainTip
forall mode. LocalNodeConnectInfo mode -&gt; IO ChainTip
</span><span class="hs-identifier hs-var">getLocalChainTip</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NetworkId -&gt; String -&gt; LocalNodeConnectInfo CardanoMode
</span><a href="Hydra.Chain.CardanoClient.html#localNodeConnectInfo"><span class="hs-identifier hs-var">localNodeConnectInfo</span></a></span><span> </span><span class="annot"><span class="annottext">NetworkId
</span><a href="#local-6989586621679990729"><span class="hs-identifier hs-var">networkId</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679990728"><span class="hs-identifier hs-var">socket</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-192"></span><span>
</span><span id="line-193"></span><span class="hs-comment">-- | Query the latest chain point just for the slot number.</span><span>
</span><span id="line-194"></span><span class="annot"><a href="Hydra.Chain.CardanoClient.html#queryTipSlotNo"><span class="hs-identifier hs-type">queryTipSlotNo</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NetworkId</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">FilePath</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">SlotNo</span></span><span>
</span><span id="line-195"></span><span id="queryTipSlotNo"><span class="annot"><span class="annottext">queryTipSlotNo :: NetworkId -&gt; String -&gt; IO SlotNo
</span><a href="Hydra.Chain.CardanoClient.html#queryTipSlotNo"><span class="hs-identifier hs-var hs-var">queryTipSlotNo</span></a></span></span><span> </span><span id="local-6989586621679990724"><span class="annot"><span class="annottext">NetworkId
</span><a href="#local-6989586621679990724"><span class="hs-identifier hs-var">networkId</span></a></span></span><span> </span><span id="local-6989586621679990723"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679990723"><span class="hs-identifier hs-var">socket</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-196"></span><span>  </span><span class="annot"><span class="annottext">LocalNodeConnectInfo CardanoMode -&gt; IO ChainTip
forall mode. LocalNodeConnectInfo mode -&gt; IO ChainTip
</span><span class="hs-identifier hs-var">getLocalChainTip</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NetworkId -&gt; String -&gt; LocalNodeConnectInfo CardanoMode
</span><a href="Hydra.Chain.CardanoClient.html#localNodeConnectInfo"><span class="hs-identifier hs-var">localNodeConnectInfo</span></a></span><span> </span><span class="annot"><span class="annottext">NetworkId
</span><a href="#local-6989586621679990724"><span class="hs-identifier hs-var">networkId</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679990723"><span class="hs-identifier hs-var">socket</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">IO ChainTip -&gt; (ChainTip -&gt; IO SlotNo) -&gt; IO SlotNo
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-197"></span><span>    </span><span class="annot"><span class="annottext">ChainTip
</span><span class="hs-identifier hs-var">ChainTipAtGenesis</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SlotNo -&gt; IO SlotNo
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><span class="hs-number">0</span></span><span>
</span><span id="line-198"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">ChainTip</span></span><span> </span><span id="local-6989586621679990720"><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621679990720"><span class="hs-identifier hs-var">slotNo</span></a></span></span><span> </span><span class="annot"><span class="annottext">Hash BlockHeader
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">BlockNo
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">SlotNo -&gt; IO SlotNo
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">SlotNo
</span><a href="#local-6989586621679990720"><span class="hs-identifier hs-var">slotNo</span></a></span><span>
</span><span id="line-199"></span><span>
</span><span id="line-200"></span><span class="hs-comment">-- | Query the system start parameter at given point.</span><span>
</span><span id="line-201"></span><span class="hs-comment">--</span><span>
</span><span id="line-202"></span><span class="hs-comment">-- Throws at least 'QueryException' if query fails.</span><span>
</span><span id="line-203"></span><span class="annot"><a href="Hydra.Chain.CardanoClient.html#querySystemStart"><span class="hs-identifier hs-type">querySystemStart</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NetworkId</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">FilePath</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Hydra.Chain.CardanoClient.html#QueryPoint"><span class="hs-identifier hs-type">QueryPoint</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">SystemStart</span></span><span>
</span><span id="line-204"></span><span id="querySystemStart"><span class="annot"><span class="annottext">querySystemStart :: NetworkId -&gt; String -&gt; QueryPoint -&gt; IO SystemStart
</span><a href="Hydra.Chain.CardanoClient.html#querySystemStart"><span class="hs-identifier hs-var hs-var">querySystemStart</span></a></span></span><span> </span><span id="local-6989586621679990719"><span class="annot"><span class="annottext">NetworkId
</span><a href="#local-6989586621679990719"><span class="hs-identifier hs-var">networkId</span></a></span></span><span> </span><span id="local-6989586621679990718"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679990718"><span class="hs-identifier hs-var">socket</span></a></span></span><span> </span><span id="local-6989586621679990717"><span class="annot"><span class="annottext">QueryPoint
</span><a href="#local-6989586621679990717"><span class="hs-identifier hs-var">queryPoint</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-205"></span><span>  </span><span class="annot"><span class="annottext">NetworkId
-&gt; String
-&gt; QueryPoint
-&gt; QueryInMode CardanoMode SystemStart
-&gt; IO SystemStart
forall a.
NetworkId
-&gt; String -&gt; QueryPoint -&gt; QueryInMode CardanoMode a -&gt; IO a
</span><a href="Hydra.Chain.CardanoClient.html#runQuery"><span class="hs-identifier hs-var">runQuery</span></a></span><span> </span><span class="annot"><span class="annottext">NetworkId
</span><a href="#local-6989586621679990719"><span class="hs-identifier hs-var">networkId</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679990718"><span class="hs-identifier hs-var">socket</span></a></span><span> </span><span class="annot"><span class="annottext">QueryPoint
</span><a href="#local-6989586621679990717"><span class="hs-identifier hs-var">queryPoint</span></a></span><span> </span><span class="annot"><span class="annottext">QueryInMode CardanoMode SystemStart
forall mode. QueryInMode mode SystemStart
</span><span class="hs-identifier hs-var">QuerySystemStart</span></span><span>
</span><span id="line-206"></span><span>
</span><span id="line-207"></span><span class="hs-comment">-- | Query the era history at given point.</span><span>
</span><span id="line-208"></span><span class="hs-comment">--</span><span>
</span><span id="line-209"></span><span class="hs-comment">-- Throws at least 'QueryException' if query fails.</span><span>
</span><span id="line-210"></span><span class="annot"><a href="Hydra.Chain.CardanoClient.html#queryEraHistory"><span class="hs-identifier hs-type">queryEraHistory</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NetworkId</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">FilePath</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Hydra.Chain.CardanoClient.html#QueryPoint"><span class="hs-identifier hs-type">QueryPoint</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">EraHistory</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">CardanoMode</span></span><span class="hs-special">)</span><span>
</span><span id="line-211"></span><span id="queryEraHistory"><span class="annot"><span class="annottext">queryEraHistory :: NetworkId -&gt; String -&gt; QueryPoint -&gt; IO (EraHistory CardanoMode)
</span><a href="Hydra.Chain.CardanoClient.html#queryEraHistory"><span class="hs-identifier hs-var hs-var">queryEraHistory</span></a></span></span><span> </span><span id="local-6989586621679990714"><span class="annot"><span class="annottext">NetworkId
</span><a href="#local-6989586621679990714"><span class="hs-identifier hs-var">networkId</span></a></span></span><span> </span><span id="local-6989586621679990713"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679990713"><span class="hs-identifier hs-var">socket</span></a></span></span><span> </span><span id="local-6989586621679990712"><span class="annot"><span class="annottext">QueryPoint
</span><a href="#local-6989586621679990712"><span class="hs-identifier hs-var">queryPoint</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-212"></span><span>  </span><span class="annot"><span class="annottext">NetworkId
-&gt; String
-&gt; QueryPoint
-&gt; QueryInMode CardanoMode (EraHistory CardanoMode)
-&gt; IO (EraHistory CardanoMode)
forall a.
NetworkId
-&gt; String -&gt; QueryPoint -&gt; QueryInMode CardanoMode a -&gt; IO a
</span><a href="Hydra.Chain.CardanoClient.html#runQuery"><span class="hs-identifier hs-var">runQuery</span></a></span><span> </span><span class="annot"><span class="annottext">NetworkId
</span><a href="#local-6989586621679990714"><span class="hs-identifier hs-var">networkId</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679990713"><span class="hs-identifier hs-var">socket</span></a></span><span> </span><span class="annot"><span class="annottext">QueryPoint
</span><a href="#local-6989586621679990712"><span class="hs-identifier hs-var">queryPoint</span></a></span><span> </span><span class="annot"><span class="annottext">(QueryInMode CardanoMode (EraHistory CardanoMode)
 -&gt; IO (EraHistory CardanoMode))
-&gt; QueryInMode CardanoMode (EraHistory CardanoMode)
-&gt; IO (EraHistory CardanoMode)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ConsensusModeIsMultiEra CardanoMode
-&gt; QueryInMode CardanoMode (EraHistory CardanoMode)
forall mode.
ConsensusModeIsMultiEra mode -&gt; QueryInMode mode (EraHistory mode)
</span><span class="hs-identifier hs-var">QueryEraHistory</span></span><span> </span><span class="annot"><span class="annottext">ConsensusModeIsMultiEra CardanoMode
</span><span class="hs-identifier hs-var">CardanoModeIsMultiEra</span></span><span>
</span><span id="line-213"></span><span>
</span><span id="line-214"></span><span class="hs-comment">-- | Query the protocol parameters at given point.</span><span>
</span><span id="line-215"></span><span class="hs-comment">--</span><span>
</span><span id="line-216"></span><span class="hs-comment">-- Throws at least 'QueryException' if query fails.</span><span>
</span><span id="line-217"></span><span class="annot"><a href="Hydra.Chain.CardanoClient.html#queryProtocolParameters"><span class="hs-identifier hs-type">queryProtocolParameters</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NetworkId</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">FilePath</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Hydra.Chain.CardanoClient.html#QueryPoint"><span class="hs-identifier hs-type">QueryPoint</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ProtocolParameters</span></span><span>
</span><span id="line-218"></span><span id="queryProtocolParameters"><span class="annot"><span class="annottext">queryProtocolParameters :: NetworkId -&gt; String -&gt; QueryPoint -&gt; IO ProtocolParameters
</span><a href="Hydra.Chain.CardanoClient.html#queryProtocolParameters"><span class="hs-identifier hs-var hs-var">queryProtocolParameters</span></a></span></span><span> </span><span id="local-6989586621679990709"><span class="annot"><span class="annottext">NetworkId
</span><a href="#local-6989586621679990709"><span class="hs-identifier hs-var">networkId</span></a></span></span><span> </span><span id="local-6989586621679990708"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679990708"><span class="hs-identifier hs-var">socket</span></a></span></span><span> </span><span id="local-6989586621679990707"><span class="annot"><span class="annottext">QueryPoint
</span><a href="#local-6989586621679990707"><span class="hs-identifier hs-var">queryPoint</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-219"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679990706"><span class="annot"><span class="annottext">query :: QueryInMode CardanoMode (Either EraMismatch ProtocolParameters)
</span><a href="#local-6989586621679990706"><span class="hs-identifier hs-var hs-var">query</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-220"></span><span>        </span><span class="annot"><span class="annottext">EraInMode Era CardanoMode
-&gt; QueryInEra Era ProtocolParameters
-&gt; QueryInMode CardanoMode (Either EraMismatch ProtocolParameters)
forall era mode result1.
EraInMode era mode
-&gt; QueryInEra era result1
-&gt; QueryInMode mode (Either EraMismatch result1)
</span><span class="hs-identifier hs-var">QueryInEra</span></span><span>
</span><span id="line-221"></span><span>          </span><span class="annot"><span class="annottext">EraInMode Era CardanoMode
</span><span class="hs-identifier hs-var">BabbageEraInCardanoMode</span></span><span>
</span><span id="line-222"></span><span>          </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">ShelleyBasedEra Era
-&gt; QueryInShelleyBasedEra Era ProtocolParameters
-&gt; QueryInEra Era ProtocolParameters
forall era result.
ShelleyBasedEra era
-&gt; QueryInShelleyBasedEra era result -&gt; QueryInEra era result
</span><span class="hs-identifier hs-var">QueryInShelleyBasedEra</span></span><span>
</span><span id="line-223"></span><span>              </span><span class="annot"><span class="annottext">ShelleyBasedEra Era
</span><span class="hs-identifier hs-var">ShelleyBasedEraBabbage</span></span><span>
</span><span id="line-224"></span><span>              </span><span class="annot"><span class="annottext">QueryInShelleyBasedEra Era ProtocolParameters
forall era. QueryInShelleyBasedEra era ProtocolParameters
</span><span class="hs-identifier hs-var">QueryProtocolParameters</span></span><span>
</span><span id="line-225"></span><span>          </span><span class="hs-special">)</span><span>
</span><span id="line-226"></span><span>   </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">NetworkId
-&gt; String
-&gt; QueryPoint
-&gt; QueryInMode CardanoMode (Either EraMismatch ProtocolParameters)
-&gt; IO (Either EraMismatch ProtocolParameters)
forall a.
NetworkId
-&gt; String -&gt; QueryPoint -&gt; QueryInMode CardanoMode a -&gt; IO a
</span><a href="Hydra.Chain.CardanoClient.html#runQuery"><span class="hs-identifier hs-var">runQuery</span></a></span><span> </span><span class="annot"><span class="annottext">NetworkId
</span><a href="#local-6989586621679990709"><span class="hs-identifier hs-var">networkId</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679990708"><span class="hs-identifier hs-var">socket</span></a></span><span> </span><span class="annot"><span class="annottext">QueryPoint
</span><a href="#local-6989586621679990707"><span class="hs-identifier hs-var">queryPoint</span></a></span><span> </span><span class="annot"><span class="annottext">QueryInMode CardanoMode (Either EraMismatch ProtocolParameters)
</span><a href="#local-6989586621679990706"><span class="hs-identifier hs-var">query</span></a></span><span> </span><span class="annot"><span class="annottext">IO (Either EraMismatch ProtocolParameters)
-&gt; (Either EraMismatch ProtocolParameters -&gt; IO ProtocolParameters)
-&gt; IO ProtocolParameters
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Either EraMismatch ProtocolParameters -&gt; IO ProtocolParameters
forall (m :: * -&gt; *) a. MonadThrow m =&gt; Either EraMismatch a -&gt; m a
</span><a href="Hydra.Chain.CardanoClient.html#throwOnEraMismatch"><span class="hs-identifier hs-var">throwOnEraMismatch</span></a></span><span>
</span><span id="line-227"></span><span>
</span><span id="line-228"></span><span class="hs-comment">-- | Query 'GenesisParameters' at a given point.</span><span>
</span><span id="line-229"></span><span class="hs-comment">--</span><span>
</span><span id="line-230"></span><span class="hs-comment">-- Throws at least 'QueryException' if query fails.</span><span>
</span><span id="line-231"></span><span class="annot"><a href="Hydra.Chain.CardanoClient.html#queryGenesisParameters"><span class="hs-identifier hs-type">queryGenesisParameters</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NetworkId</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">FilePath</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Hydra.Chain.CardanoClient.html#QueryPoint"><span class="hs-identifier hs-type">QueryPoint</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">GenesisParameters</span></span><span>
</span><span id="line-232"></span><span id="queryGenesisParameters"><span class="annot"><span class="annottext">queryGenesisParameters :: NetworkId -&gt; String -&gt; QueryPoint -&gt; IO GenesisParameters
</span><a href="Hydra.Chain.CardanoClient.html#queryGenesisParameters"><span class="hs-identifier hs-var hs-var">queryGenesisParameters</span></a></span></span><span> </span><span id="local-6989586621679990699"><span class="annot"><span class="annottext">NetworkId
</span><a href="#local-6989586621679990699"><span class="hs-identifier hs-var">networkId</span></a></span></span><span> </span><span id="local-6989586621679990698"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679990698"><span class="hs-identifier hs-var">socket</span></a></span></span><span> </span><span id="local-6989586621679990697"><span class="annot"><span class="annottext">QueryPoint
</span><a href="#local-6989586621679990697"><span class="hs-identifier hs-var">queryPoint</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-233"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679990696"><span class="annot"><span class="annottext">query :: QueryInMode CardanoMode (Either EraMismatch GenesisParameters)
</span><a href="#local-6989586621679990696"><span class="hs-identifier hs-var hs-var">query</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-234"></span><span>        </span><span class="annot"><span class="annottext">EraInMode Era CardanoMode
-&gt; QueryInEra Era GenesisParameters
-&gt; QueryInMode CardanoMode (Either EraMismatch GenesisParameters)
forall era mode result1.
EraInMode era mode
-&gt; QueryInEra era result1
-&gt; QueryInMode mode (Either EraMismatch result1)
</span><span class="hs-identifier hs-var">QueryInEra</span></span><span>
</span><span id="line-235"></span><span>          </span><span class="annot"><span class="annottext">EraInMode Era CardanoMode
</span><span class="hs-identifier hs-var">BabbageEraInCardanoMode</span></span><span>
</span><span id="line-236"></span><span>          </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">ShelleyBasedEra Era
-&gt; QueryInShelleyBasedEra Era GenesisParameters
-&gt; QueryInEra Era GenesisParameters
forall era result.
ShelleyBasedEra era
-&gt; QueryInShelleyBasedEra era result -&gt; QueryInEra era result
</span><span class="hs-identifier hs-var">QueryInShelleyBasedEra</span></span><span>
</span><span id="line-237"></span><span>              </span><span class="annot"><span class="annottext">ShelleyBasedEra Era
</span><span class="hs-identifier hs-var">ShelleyBasedEraBabbage</span></span><span>
</span><span id="line-238"></span><span>              </span><span class="annot"><span class="annottext">QueryInShelleyBasedEra Era GenesisParameters
forall era. QueryInShelleyBasedEra era GenesisParameters
</span><span class="hs-identifier hs-var">QueryGenesisParameters</span></span><span>
</span><span id="line-239"></span><span>          </span><span class="hs-special">)</span><span>
</span><span id="line-240"></span><span>   </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">NetworkId
-&gt; String
-&gt; QueryPoint
-&gt; QueryInMode CardanoMode (Either EraMismatch GenesisParameters)
-&gt; IO (Either EraMismatch GenesisParameters)
forall a.
NetworkId
-&gt; String -&gt; QueryPoint -&gt; QueryInMode CardanoMode a -&gt; IO a
</span><a href="Hydra.Chain.CardanoClient.html#runQuery"><span class="hs-identifier hs-var">runQuery</span></a></span><span> </span><span class="annot"><span class="annottext">NetworkId
</span><a href="#local-6989586621679990699"><span class="hs-identifier hs-var">networkId</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679990698"><span class="hs-identifier hs-var">socket</span></a></span><span> </span><span class="annot"><span class="annottext">QueryPoint
</span><a href="#local-6989586621679990697"><span class="hs-identifier hs-var">queryPoint</span></a></span><span> </span><span class="annot"><span class="annottext">QueryInMode CardanoMode (Either EraMismatch GenesisParameters)
</span><a href="#local-6989586621679990696"><span class="hs-identifier hs-var">query</span></a></span><span> </span><span class="annot"><span class="annottext">IO (Either EraMismatch GenesisParameters)
-&gt; (Either EraMismatch GenesisParameters -&gt; IO GenesisParameters)
-&gt; IO GenesisParameters
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Either EraMismatch GenesisParameters -&gt; IO GenesisParameters
forall (m :: * -&gt; *) a. MonadThrow m =&gt; Either EraMismatch a -&gt; m a
</span><a href="Hydra.Chain.CardanoClient.html#throwOnEraMismatch"><span class="hs-identifier hs-var">throwOnEraMismatch</span></a></span><span>
</span><span id="line-241"></span><span>
</span><span id="line-242"></span><span class="hs-comment">-- | Query UTxO for all given addresses at given point.</span><span>
</span><span id="line-243"></span><span class="hs-comment">--</span><span>
</span><span id="line-244"></span><span class="hs-comment">-- Throws at least 'QueryException' if query fails.</span><span>
</span><span id="line-245"></span><span class="annot"><a href="Hydra.Chain.CardanoClient.html#queryUTxO"><span class="hs-identifier hs-type">queryUTxO</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NetworkId</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">FilePath</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Hydra.Chain.CardanoClient.html#QueryPoint"><span class="hs-identifier hs-type">QueryPoint</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">Address</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">ShelleyAddr</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">UTxO</span></span><span>
</span><span id="line-246"></span><span id="queryUTxO"><span class="annot"><span class="annottext">queryUTxO :: NetworkId
-&gt; String -&gt; QueryPoint -&gt; [Address ShelleyAddr] -&gt; IO UTxO
</span><a href="Hydra.Chain.CardanoClient.html#queryUTxO"><span class="hs-identifier hs-var hs-var">queryUTxO</span></a></span></span><span> </span><span id="local-6989586621679990694"><span class="annot"><span class="annottext">NetworkId
</span><a href="#local-6989586621679990694"><span class="hs-identifier hs-var">networkId</span></a></span></span><span> </span><span id="local-6989586621679990693"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679990693"><span class="hs-identifier hs-var">socket</span></a></span></span><span> </span><span id="local-6989586621679990692"><span class="annot"><span class="annottext">QueryPoint
</span><a href="#local-6989586621679990692"><span class="hs-identifier hs-var">queryPoint</span></a></span></span><span> </span><span id="local-6989586621679990691"><span class="annot"><span class="annottext">[Address ShelleyAddr]
</span><a href="#local-6989586621679990691"><span class="hs-identifier hs-var">addresses</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-247"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679990690"><span class="annot"><span class="annottext">query :: QueryInMode CardanoMode (Either EraMismatch (UTxO Era))
</span><a href="#local-6989586621679990690"><span class="hs-identifier hs-var hs-var">query</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-248"></span><span>        </span><span class="annot"><span class="annottext">EraInMode Era CardanoMode
-&gt; QueryInEra Era (UTxO Era)
-&gt; QueryInMode CardanoMode (Either EraMismatch (UTxO Era))
forall era mode result1.
EraInMode era mode
-&gt; QueryInEra era result1
-&gt; QueryInMode mode (Either EraMismatch result1)
</span><span class="hs-identifier hs-var">QueryInEra</span></span><span>
</span><span id="line-249"></span><span>          </span><span class="annot"><span class="annottext">EraInMode Era CardanoMode
</span><span class="hs-identifier hs-var">BabbageEraInCardanoMode</span></span><span>
</span><span id="line-250"></span><span>          </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">ShelleyBasedEra Era
-&gt; QueryInShelleyBasedEra Era (UTxO Era)
-&gt; QueryInEra Era (UTxO Era)
forall era result.
ShelleyBasedEra era
-&gt; QueryInShelleyBasedEra era result -&gt; QueryInEra era result
</span><span class="hs-identifier hs-var">QueryInShelleyBasedEra</span></span><span>
</span><span id="line-251"></span><span>              </span><span class="annot"><span class="annottext">ShelleyBasedEra Era
</span><span class="hs-identifier hs-var">ShelleyBasedEraBabbage</span></span><span>
</span><span id="line-252"></span><span>              </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">QueryUTxOFilter -&gt; QueryInShelleyBasedEra Era (UTxO Era)
forall era.
QueryUTxOFilter -&gt; QueryInShelleyBasedEra era (UTxO era)
</span><span class="hs-identifier hs-var">QueryUTxO</span></span><span>
</span><span id="line-253"></span><span>                  </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set AddressAny -&gt; QueryUTxOFilter
</span><span class="hs-identifier hs-var">QueryUTxOByAddress</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[AddressAny] -&gt; Set AddressAny
forall a. Ord a =&gt; [a] -&gt; Set a
</span><span class="hs-identifier hs-var">Set.fromList</span></span><span> </span><span class="annot"><span class="annottext">([AddressAny] -&gt; Set AddressAny) -&gt; [AddressAny] -&gt; Set AddressAny
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(Address ShelleyAddr -&gt; AddressAny)
-&gt; [Address ShelleyAddr] -&gt; [AddressAny]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">Address ShelleyAddr -&gt; AddressAny
</span><span class="hs-identifier hs-var">AddressShelley</span></span><span> </span><span class="annot"><span class="annottext">[Address ShelleyAddr]
</span><a href="#local-6989586621679990691"><span class="hs-identifier hs-var">addresses</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-254"></span><span>              </span><span class="hs-special">)</span><span>
</span><span id="line-255"></span><span>          </span><span class="hs-special">)</span><span>
</span><span id="line-256"></span><span>   </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">UTxO Era -&gt; UTxO
</span><span class="hs-identifier hs-var">UTxO.fromApi</span></span><span> </span><span class="annot"><span class="annottext">(UTxO Era -&gt; UTxO) -&gt; IO (UTxO Era) -&gt; IO UTxO
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NetworkId
-&gt; String
-&gt; QueryPoint
-&gt; QueryInMode CardanoMode (Either EraMismatch (UTxO Era))
-&gt; IO (Either EraMismatch (UTxO Era))
forall a.
NetworkId
-&gt; String -&gt; QueryPoint -&gt; QueryInMode CardanoMode a -&gt; IO a
</span><a href="Hydra.Chain.CardanoClient.html#runQuery"><span class="hs-identifier hs-var">runQuery</span></a></span><span> </span><span class="annot"><span class="annottext">NetworkId
</span><a href="#local-6989586621679990694"><span class="hs-identifier hs-var">networkId</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679990693"><span class="hs-identifier hs-var">socket</span></a></span><span> </span><span class="annot"><span class="annottext">QueryPoint
</span><a href="#local-6989586621679990692"><span class="hs-identifier hs-var">queryPoint</span></a></span><span> </span><span class="annot"><span class="annottext">QueryInMode CardanoMode (Either EraMismatch (UTxO Era))
</span><a href="#local-6989586621679990690"><span class="hs-identifier hs-var">query</span></a></span><span> </span><span class="annot"><span class="annottext">IO (Either EraMismatch (UTxO Era))
-&gt; (Either EraMismatch (UTxO Era) -&gt; IO (UTxO Era))
-&gt; IO (UTxO Era)
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Either EraMismatch (UTxO Era) -&gt; IO (UTxO Era)
forall (m :: * -&gt; *) a. MonadThrow m =&gt; Either EraMismatch a -&gt; m a
</span><a href="Hydra.Chain.CardanoClient.html#throwOnEraMismatch"><span class="hs-identifier hs-var">throwOnEraMismatch</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-257"></span><span>
</span><span id="line-258"></span><span class="hs-comment">-- | Query UTxO for given tx inputs at given point.</span><span>
</span><span id="line-259"></span><span class="hs-comment">--</span><span>
</span><span id="line-260"></span><span class="hs-comment">-- Throws at least 'QueryException' if query fails.</span><span>
</span><span id="line-261"></span><span class="annot"><a href="Hydra.Chain.CardanoClient.html#queryUTxOByTxIn"><span class="hs-identifier hs-type">queryUTxOByTxIn</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NetworkId</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">FilePath</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Hydra.Chain.CardanoClient.html#QueryPoint"><span class="hs-identifier hs-type">QueryPoint</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">TxIn</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">UTxO</span></span><span>
</span><span id="line-262"></span><span id="queryUTxOByTxIn"><span class="annot"><span class="annottext">queryUTxOByTxIn :: NetworkId -&gt; String -&gt; QueryPoint -&gt; [TxIn] -&gt; IO UTxO
</span><a href="Hydra.Chain.CardanoClient.html#queryUTxOByTxIn"><span class="hs-identifier hs-var hs-var">queryUTxOByTxIn</span></a></span></span><span> </span><span id="local-6989586621679990684"><span class="annot"><span class="annottext">NetworkId
</span><a href="#local-6989586621679990684"><span class="hs-identifier hs-var">networkId</span></a></span></span><span> </span><span id="local-6989586621679990683"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679990683"><span class="hs-identifier hs-var">socket</span></a></span></span><span> </span><span id="local-6989586621679990682"><span class="annot"><span class="annottext">QueryPoint
</span><a href="#local-6989586621679990682"><span class="hs-identifier hs-var">queryPoint</span></a></span></span><span> </span><span id="local-6989586621679990681"><span class="annot"><span class="annottext">[TxIn]
</span><a href="#local-6989586621679990681"><span class="hs-identifier hs-var">inputs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-263"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679990680"><span class="annot"><span class="annottext">query :: QueryInMode CardanoMode (Either EraMismatch (UTxO Era))
</span><a href="#local-6989586621679990680"><span class="hs-identifier hs-var hs-var">query</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-264"></span><span>        </span><span class="annot"><span class="annottext">EraInMode Era CardanoMode
-&gt; QueryInEra Era (UTxO Era)
-&gt; QueryInMode CardanoMode (Either EraMismatch (UTxO Era))
forall era mode result1.
EraInMode era mode
-&gt; QueryInEra era result1
-&gt; QueryInMode mode (Either EraMismatch result1)
</span><span class="hs-identifier hs-var">QueryInEra</span></span><span>
</span><span id="line-265"></span><span>          </span><span class="annot"><span class="annottext">EraInMode Era CardanoMode
</span><span class="hs-identifier hs-var">BabbageEraInCardanoMode</span></span><span>
</span><span id="line-266"></span><span>          </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">ShelleyBasedEra Era
-&gt; QueryInShelleyBasedEra Era (UTxO Era)
-&gt; QueryInEra Era (UTxO Era)
forall era result.
ShelleyBasedEra era
-&gt; QueryInShelleyBasedEra era result -&gt; QueryInEra era result
</span><span class="hs-identifier hs-var">QueryInShelleyBasedEra</span></span><span>
</span><span id="line-267"></span><span>              </span><span class="annot"><span class="annottext">ShelleyBasedEra Era
</span><span class="hs-identifier hs-var">ShelleyBasedEraBabbage</span></span><span>
</span><span id="line-268"></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QueryUTxOFilter -&gt; QueryInShelleyBasedEra Era (UTxO Era)
forall era.
QueryUTxOFilter -&gt; QueryInShelleyBasedEra era (UTxO era)
</span><span class="hs-identifier hs-var">QueryUTxO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set TxIn -&gt; QueryUTxOFilter
</span><span class="hs-identifier hs-var">QueryUTxOByTxIn</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[TxIn] -&gt; Set TxIn
forall a. Ord a =&gt; [a] -&gt; Set a
</span><span class="hs-identifier hs-var">Set.fromList</span></span><span> </span><span class="annot"><span class="annottext">[TxIn]
</span><a href="#local-6989586621679990681"><span class="hs-identifier hs-var">inputs</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-269"></span><span>          </span><span class="hs-special">)</span><span>
</span><span id="line-270"></span><span>   </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">UTxO Era -&gt; UTxO
</span><span class="hs-identifier hs-var">UTxO.fromApi</span></span><span> </span><span class="annot"><span class="annottext">(UTxO Era -&gt; UTxO) -&gt; IO (UTxO Era) -&gt; IO UTxO
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NetworkId
-&gt; String
-&gt; QueryPoint
-&gt; QueryInMode CardanoMode (Either EraMismatch (UTxO Era))
-&gt; IO (Either EraMismatch (UTxO Era))
forall a.
NetworkId
-&gt; String -&gt; QueryPoint -&gt; QueryInMode CardanoMode a -&gt; IO a
</span><a href="Hydra.Chain.CardanoClient.html#runQuery"><span class="hs-identifier hs-var">runQuery</span></a></span><span> </span><span class="annot"><span class="annottext">NetworkId
</span><a href="#local-6989586621679990684"><span class="hs-identifier hs-var">networkId</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679990683"><span class="hs-identifier hs-var">socket</span></a></span><span> </span><span class="annot"><span class="annottext">QueryPoint
</span><a href="#local-6989586621679990682"><span class="hs-identifier hs-var">queryPoint</span></a></span><span> </span><span class="annot"><span class="annottext">QueryInMode CardanoMode (Either EraMismatch (UTxO Era))
</span><a href="#local-6989586621679990680"><span class="hs-identifier hs-var">query</span></a></span><span> </span><span class="annot"><span class="annottext">IO (Either EraMismatch (UTxO Era))
-&gt; (Either EraMismatch (UTxO Era) -&gt; IO (UTxO Era))
-&gt; IO (UTxO Era)
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Either EraMismatch (UTxO Era) -&gt; IO (UTxO Era)
forall (m :: * -&gt; *) a. MonadThrow m =&gt; Either EraMismatch a -&gt; m a
</span><a href="Hydra.Chain.CardanoClient.html#throwOnEraMismatch"><span class="hs-identifier hs-var">throwOnEraMismatch</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-271"></span><span>
</span><span id="line-272"></span><span class="hs-comment">-- | Query the whole UTxO from node at given point. Useful for debugging, but</span><span>
</span><span id="line-273"></span><span class="hs-comment">-- should obviously not be used in production code.</span><span>
</span><span id="line-274"></span><span class="hs-comment">--</span><span>
</span><span id="line-275"></span><span class="hs-comment">-- Throws at least 'QueryException' if query fails.</span><span>
</span><span id="line-276"></span><span class="annot"><a href="Hydra.Chain.CardanoClient.html#queryUTxOWhole"><span class="hs-identifier hs-type">queryUTxOWhole</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NetworkId</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">FilePath</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Hydra.Chain.CardanoClient.html#QueryPoint"><span class="hs-identifier hs-type">QueryPoint</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">UTxO</span></span><span>
</span><span id="line-277"></span><span id="queryUTxOWhole"><span class="annot"><span class="annottext">queryUTxOWhole :: NetworkId -&gt; String -&gt; QueryPoint -&gt; IO UTxO
</span><a href="Hydra.Chain.CardanoClient.html#queryUTxOWhole"><span class="hs-identifier hs-var hs-var">queryUTxOWhole</span></a></span></span><span> </span><span id="local-6989586621679990677"><span class="annot"><span class="annottext">NetworkId
</span><a href="#local-6989586621679990677"><span class="hs-identifier hs-var">networkId</span></a></span></span><span> </span><span id="local-6989586621679990676"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679990676"><span class="hs-identifier hs-var">socket</span></a></span></span><span> </span><span id="local-6989586621679990675"><span class="annot"><span class="annottext">QueryPoint
</span><a href="#local-6989586621679990675"><span class="hs-identifier hs-var">queryPoint</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-278"></span><span>  </span><span class="annot"><span class="annottext">UTxO Era -&gt; UTxO
</span><span class="hs-identifier hs-var">UTxO.fromApi</span></span><span> </span><span class="annot"><span class="annottext">(UTxO Era -&gt; UTxO) -&gt; IO (UTxO Era) -&gt; IO UTxO
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NetworkId
-&gt; String
-&gt; QueryPoint
-&gt; QueryInMode CardanoMode (Either EraMismatch (UTxO Era))
-&gt; IO (Either EraMismatch (UTxO Era))
forall a.
NetworkId
-&gt; String -&gt; QueryPoint -&gt; QueryInMode CardanoMode a -&gt; IO a
</span><a href="Hydra.Chain.CardanoClient.html#runQuery"><span class="hs-identifier hs-var">runQuery</span></a></span><span> </span><span class="annot"><span class="annottext">NetworkId
</span><a href="#local-6989586621679990677"><span class="hs-identifier hs-var">networkId</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679990676"><span class="hs-identifier hs-var">socket</span></a></span><span> </span><span class="annot"><span class="annottext">QueryPoint
</span><a href="#local-6989586621679990675"><span class="hs-identifier hs-var">queryPoint</span></a></span><span> </span><span class="annot"><span class="annottext">QueryInMode CardanoMode (Either EraMismatch (UTxO Era))
</span><a href="#local-6989586621679990674"><span class="hs-identifier hs-var">query</span></a></span><span> </span><span class="annot"><span class="annottext">IO (Either EraMismatch (UTxO Era))
-&gt; (Either EraMismatch (UTxO Era) -&gt; IO (UTxO Era))
-&gt; IO (UTxO Era)
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Either EraMismatch (UTxO Era) -&gt; IO (UTxO Era)
forall (m :: * -&gt; *) a. MonadThrow m =&gt; Either EraMismatch a -&gt; m a
</span><a href="Hydra.Chain.CardanoClient.html#throwOnEraMismatch"><span class="hs-identifier hs-var">throwOnEraMismatch</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-279"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-280"></span><span>  </span><span id="local-6989586621679990674"><span class="annot"><span class="annottext">query :: QueryInMode CardanoMode (Either EraMismatch (UTxO Era))
</span><a href="#local-6989586621679990674"><span class="hs-identifier hs-var hs-var">query</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-281"></span><span>    </span><span class="annot"><span class="annottext">EraInMode Era CardanoMode
-&gt; QueryInEra Era (UTxO Era)
-&gt; QueryInMode CardanoMode (Either EraMismatch (UTxO Era))
forall era mode result1.
EraInMode era mode
-&gt; QueryInEra era result1
-&gt; QueryInMode mode (Either EraMismatch result1)
</span><span class="hs-identifier hs-var">QueryInEra</span></span><span>
</span><span id="line-282"></span><span>      </span><span class="annot"><span class="annottext">EraInMode Era CardanoMode
</span><span class="hs-identifier hs-var">BabbageEraInCardanoMode</span></span><span>
</span><span id="line-283"></span><span>      </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">ShelleyBasedEra Era
-&gt; QueryInShelleyBasedEra Era (UTxO Era)
-&gt; QueryInEra Era (UTxO Era)
forall era result.
ShelleyBasedEra era
-&gt; QueryInShelleyBasedEra era result -&gt; QueryInEra era result
</span><span class="hs-identifier hs-var">QueryInShelleyBasedEra</span></span><span>
</span><span id="line-284"></span><span>          </span><span class="annot"><span class="annottext">ShelleyBasedEra Era
</span><span class="hs-identifier hs-var">ShelleyBasedEraBabbage</span></span><span>
</span><span id="line-285"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">QueryUTxOFilter -&gt; QueryInShelleyBasedEra Era (UTxO Era)
forall era.
QueryUTxOFilter -&gt; QueryInShelleyBasedEra era (UTxO era)
</span><span class="hs-identifier hs-var">QueryUTxO</span></span><span> </span><span class="annot"><span class="annottext">QueryUTxOFilter
</span><span class="hs-identifier hs-var">QueryUTxOWhole</span></span><span class="hs-special">)</span><span>
</span><span id="line-286"></span><span>      </span><span class="hs-special">)</span><span>
</span><span id="line-287"></span><span>
</span><span id="line-288"></span><span class="hs-comment">-- | Query UTxO for the address of given verification key at point.</span><span>
</span><span id="line-289"></span><span class="hs-comment">--</span><span>
</span><span id="line-290"></span><span class="hs-comment">-- Throws at least 'QueryException' if query fails.</span><span>
</span><span id="line-291"></span><span class="annot"><a href="Hydra.Chain.CardanoClient.html#queryUTxOFor"><span class="hs-identifier hs-type">queryUTxOFor</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NetworkId</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">FilePath</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Hydra.Chain.CardanoClient.html#QueryPoint"><span class="hs-identifier hs-type">QueryPoint</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">VerificationKey</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">PaymentKey</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">UTxO</span></span><span>
</span><span id="line-292"></span><span id="queryUTxOFor"><span class="annot"><span class="annottext">queryUTxOFor :: NetworkId
-&gt; String -&gt; QueryPoint -&gt; VerificationKey PaymentKey -&gt; IO UTxO
</span><a href="Hydra.Chain.CardanoClient.html#queryUTxOFor"><span class="hs-identifier hs-var hs-var">queryUTxOFor</span></a></span></span><span> </span><span id="local-6989586621679990671"><span class="annot"><span class="annottext">NetworkId
</span><a href="#local-6989586621679990671"><span class="hs-identifier hs-var">networkId</span></a></span></span><span> </span><span id="local-6989586621679990670"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679990670"><span class="hs-identifier hs-var">nodeSocket</span></a></span></span><span> </span><span id="local-6989586621679990669"><span class="annot"><span class="annottext">QueryPoint
</span><a href="#local-6989586621679990669"><span class="hs-identifier hs-var">queryPoint</span></a></span></span><span> </span><span id="local-6989586621679990668"><span class="annot"><span class="annottext">VerificationKey PaymentKey
</span><a href="#local-6989586621679990668"><span class="hs-identifier hs-var">vk</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-293"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">NetworkId -&gt; VerificationKey PaymentKey -&gt; AddressInEra
forall era.
IsShelleyBasedEra era =&gt;
NetworkId -&gt; VerificationKey PaymentKey -&gt; AddressInEra era
</span><span class="hs-identifier hs-var">mkVkAddress</span></span><span> </span><span class="annot"><span class="annottext">NetworkId
</span><a href="#local-6989586621679990671"><span class="hs-identifier hs-var">networkId</span></a></span><span> </span><span class="annot"><span class="annottext">VerificationKey PaymentKey
</span><a href="#local-6989586621679990668"><span class="hs-identifier hs-var">vk</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-294"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">ShelleyAddressInEra</span></span><span> </span><span id="local-6989586621679990665"><span class="annot"><span class="annottext">Address ShelleyAddr
</span><a href="#local-6989586621679990665"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-295"></span><span>      </span><span class="annot"><span class="annottext">NetworkId
-&gt; String -&gt; QueryPoint -&gt; [Address ShelleyAddr] -&gt; IO UTxO
</span><a href="Hydra.Chain.CardanoClient.html#queryUTxO"><span class="hs-identifier hs-var">queryUTxO</span></a></span><span> </span><span class="annot"><span class="annottext">NetworkId
</span><a href="#local-6989586621679990671"><span class="hs-identifier hs-var">networkId</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679990670"><span class="hs-identifier hs-var">nodeSocket</span></a></span><span> </span><span class="annot"><span class="annottext">QueryPoint
</span><a href="#local-6989586621679990669"><span class="hs-identifier hs-var">queryPoint</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Address ShelleyAddr
</span><a href="#local-6989586621679990665"><span class="hs-identifier hs-var">addr</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-296"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">ByronAddressInEra</span></span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-297"></span><span>      </span><span class="annot"><span class="annottext">String -&gt; IO UTxO
forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">fail</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;impossible: mkVkAddress returned Byron address.&quot;</span></span><span>
</span><span id="line-298"></span><span>
</span><span id="line-299"></span><span class="hs-comment">-- | Query the current set of registered stake pools.</span><span>
</span><span id="line-300"></span><span class="hs-comment">--</span><span>
</span><span id="line-301"></span><span class="hs-comment">-- Throws at least 'QueryException' if query fails.</span><span>
</span><span id="line-302"></span><span class="annot"><a href="Hydra.Chain.CardanoClient.html#queryStakePools"><span class="hs-identifier hs-type">queryStakePools</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NetworkId</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">FilePath</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Hydra.Chain.CardanoClient.html#QueryPoint"><span class="hs-identifier hs-type">QueryPoint</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">PoolId</span></span><span class="hs-special">)</span><span>
</span><span id="line-303"></span><span id="queryStakePools"><span class="annot"><span class="annottext">queryStakePools :: NetworkId -&gt; String -&gt; QueryPoint -&gt; IO (Set PoolId)
</span><a href="Hydra.Chain.CardanoClient.html#queryStakePools"><span class="hs-identifier hs-var hs-var">queryStakePools</span></a></span></span><span> </span><span id="local-6989586621679990663"><span class="annot"><span class="annottext">NetworkId
</span><a href="#local-6989586621679990663"><span class="hs-identifier hs-var">networkId</span></a></span></span><span> </span><span id="local-6989586621679990662"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679990662"><span class="hs-identifier hs-var">socket</span></a></span></span><span> </span><span id="local-6989586621679990661"><span class="annot"><span class="annottext">QueryPoint
</span><a href="#local-6989586621679990661"><span class="hs-identifier hs-var">queryPoint</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-304"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679990660"><span class="annot"><span class="annottext">query :: QueryInMode CardanoMode (Either EraMismatch (Set PoolId))
</span><a href="#local-6989586621679990660"><span class="hs-identifier hs-var hs-var">query</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-305"></span><span>        </span><span class="annot"><span class="annottext">EraInMode Era CardanoMode
-&gt; QueryInEra Era (Set PoolId)
-&gt; QueryInMode CardanoMode (Either EraMismatch (Set PoolId))
forall era mode result1.
EraInMode era mode
-&gt; QueryInEra era result1
-&gt; QueryInMode mode (Either EraMismatch result1)
</span><span class="hs-identifier hs-var">QueryInEra</span></span><span>
</span><span id="line-306"></span><span>          </span><span class="annot"><span class="annottext">EraInMode Era CardanoMode
</span><span class="hs-identifier hs-var">BabbageEraInCardanoMode</span></span><span>
</span><span id="line-307"></span><span>          </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">ShelleyBasedEra Era
-&gt; QueryInShelleyBasedEra Era (Set PoolId)
-&gt; QueryInEra Era (Set PoolId)
forall era result.
ShelleyBasedEra era
-&gt; QueryInShelleyBasedEra era result -&gt; QueryInEra era result
</span><span class="hs-identifier hs-var">QueryInShelleyBasedEra</span></span><span>
</span><span id="line-308"></span><span>              </span><span class="annot"><span class="annottext">ShelleyBasedEra Era
</span><span class="hs-identifier hs-var">ShelleyBasedEraBabbage</span></span><span>
</span><span id="line-309"></span><span>              </span><span class="annot"><span class="annottext">QueryInShelleyBasedEra Era (Set PoolId)
forall era. QueryInShelleyBasedEra era (Set PoolId)
</span><span class="hs-identifier hs-var">QueryStakePools</span></span><span>
</span><span id="line-310"></span><span>          </span><span class="hs-special">)</span><span>
</span><span id="line-311"></span><span>   </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">NetworkId
-&gt; String
-&gt; QueryPoint
-&gt; QueryInMode CardanoMode (Either EraMismatch (Set PoolId))
-&gt; IO (Either EraMismatch (Set PoolId))
forall a.
NetworkId
-&gt; String -&gt; QueryPoint -&gt; QueryInMode CardanoMode a -&gt; IO a
</span><a href="Hydra.Chain.CardanoClient.html#runQuery"><span class="hs-identifier hs-var">runQuery</span></a></span><span> </span><span class="annot"><span class="annottext">NetworkId
</span><a href="#local-6989586621679990663"><span class="hs-identifier hs-var">networkId</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679990662"><span class="hs-identifier hs-var">socket</span></a></span><span> </span><span class="annot"><span class="annottext">QueryPoint
</span><a href="#local-6989586621679990661"><span class="hs-identifier hs-var">queryPoint</span></a></span><span> </span><span class="annot"><span class="annottext">QueryInMode CardanoMode (Either EraMismatch (Set PoolId))
</span><a href="#local-6989586621679990660"><span class="hs-identifier hs-var">query</span></a></span><span> </span><span class="annot"><span class="annottext">IO (Either EraMismatch (Set PoolId))
-&gt; (Either EraMismatch (Set PoolId) -&gt; IO (Set PoolId))
-&gt; IO (Set PoolId)
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Either EraMismatch (Set PoolId) -&gt; IO (Set PoolId)
forall (m :: * -&gt; *) a. MonadThrow m =&gt; Either EraMismatch a -&gt; m a
</span><a href="Hydra.Chain.CardanoClient.html#throwOnEraMismatch"><span class="hs-identifier hs-var">throwOnEraMismatch</span></a></span><span>
</span><span id="line-312"></span><span>
</span><span id="line-313"></span><span class="hs-comment">-- | Throws at least 'QueryException' if query fails.</span><span>
</span><span id="line-314"></span><span id="local-6989586621679990926"><span class="annot"><a href="Hydra.Chain.CardanoClient.html#runQuery"><span class="hs-identifier hs-type">runQuery</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NetworkId</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">FilePath</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Hydra.Chain.CardanoClient.html#QueryPoint"><span class="hs-identifier hs-type">QueryPoint</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">QueryInMode</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">CardanoMode</span></span><span> </span><span class="annot"><a href="#local-6989586621679990926"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/ghc-prim-0.6.1/src"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679990926"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-315"></span><span id="runQuery"><span class="annot"><span class="annottext">runQuery :: NetworkId
-&gt; String -&gt; QueryPoint -&gt; QueryInMode CardanoMode a -&gt; IO a
</span><a href="Hydra.Chain.CardanoClient.html#runQuery"><span class="hs-identifier hs-var hs-var">runQuery</span></a></span></span><span> </span><span id="local-6989586621679990658"><span class="annot"><span class="annottext">NetworkId
</span><a href="#local-6989586621679990658"><span class="hs-identifier hs-var">networkId</span></a></span></span><span> </span><span id="local-6989586621679990657"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679990657"><span class="hs-identifier hs-var">socket</span></a></span></span><span> </span><span id="local-6989586621679990656"><span class="annot"><span class="annottext">QueryPoint
</span><a href="#local-6989586621679990656"><span class="hs-identifier hs-var">point</span></a></span></span><span> </span><span id="local-6989586621679990655"><span class="annot"><span class="annottext">QueryInMode CardanoMode a
</span><a href="#local-6989586621679990655"><span class="hs-identifier hs-var">query</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-316"></span><span>  </span><span class="annot"><span class="annottext">LocalNodeConnectInfo CardanoMode
-&gt; Maybe ChainPoint
-&gt; QueryInMode CardanoMode a
-&gt; IO (Either AcquiringFailure a)
forall mode result.
LocalNodeConnectInfo mode
-&gt; Maybe ChainPoint
-&gt; QueryInMode mode result
-&gt; IO (Either AcquiringFailure result)
</span><span class="hs-identifier hs-var">queryNodeLocalState</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NetworkId -&gt; String -&gt; LocalNodeConnectInfo CardanoMode
</span><a href="Hydra.Chain.CardanoClient.html#localNodeConnectInfo"><span class="hs-identifier hs-var">localNodeConnectInfo</span></a></span><span> </span><span class="annot"><span class="annottext">NetworkId
</span><a href="#local-6989586621679990658"><span class="hs-identifier hs-var">networkId</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679990657"><span class="hs-identifier hs-var">socket</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe ChainPoint
</span><a href="#local-6989586621679990653"><span class="hs-identifier hs-var">maybePoint</span></a></span><span> </span><span class="annot"><span class="annottext">QueryInMode CardanoMode a
</span><a href="#local-6989586621679990655"><span class="hs-identifier hs-var">query</span></a></span><span> </span><span class="annot"><span class="annottext">IO (Either AcquiringFailure a)
-&gt; (Either AcquiringFailure a -&gt; IO a) -&gt; IO a
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-317"></span><span>    </span><span class="annot"><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Left</span></a></span><span> </span><span id="local-6989586621679990652"><span class="annot"><span class="annottext">AcquiringFailure
</span><a href="#local-6989586621679990652"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">QueryException -&gt; IO a
forall (m :: * -&gt; *) e a. (MonadThrow m, Exception e) =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwIO</span></span><span> </span><span class="annot"><span class="annottext">(QueryException -&gt; IO a) -&gt; QueryException -&gt; IO a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">AcquiringFailure -&gt; QueryException
</span><a href="Hydra.Chain.CardanoClient.html#QueryAcquireException"><span class="hs-identifier hs-var">QueryAcquireException</span></a></span><span> </span><span class="annot"><span class="annottext">AcquiringFailure
</span><a href="#local-6989586621679990652"><span class="hs-identifier hs-var">err</span></a></span><span>
</span><span id="line-318"></span><span>    </span><span class="annot"><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span id="local-6989586621679990651"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679990651"><span class="hs-identifier hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; IO a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679990651"><span class="hs-identifier hs-var">result</span></a></span><span>
</span><span id="line-319"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-320"></span><span>  </span><span id="local-6989586621679990653"><span class="annot"><span class="annottext">maybePoint :: Maybe ChainPoint
</span><a href="#local-6989586621679990653"><span class="hs-identifier hs-var hs-var">maybePoint</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-321"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">QueryPoint
</span><a href="#local-6989586621679990656"><span class="hs-identifier hs-var">point</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-322"></span><span>      </span><span class="annot"><span class="annottext">QueryPoint
</span><a href="Hydra.Chain.CardanoClient.html#QueryTip"><span class="hs-identifier hs-var">QueryTip</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe ChainPoint
forall a. Maybe a
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-323"></span><span>      </span><span class="annot"><a href="Hydra.Chain.CardanoClient.html#QueryAt"><span class="hs-identifier hs-type">QueryAt</span></a></span><span> </span><span id="local-6989586621679990650"><span class="annot"><span class="annottext">ChainPoint
</span><a href="#local-6989586621679990650"><span class="hs-identifier hs-var">cp</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ChainPoint -&gt; Maybe ChainPoint
forall a. a -&gt; Maybe a
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">ChainPoint
</span><a href="#local-6989586621679990650"><span class="hs-identifier hs-var">cp</span></a></span><span>
</span><span id="line-324"></span><span>
</span><span id="line-325"></span><span class="hs-comment">-- * Helpers</span><span>
</span><span id="line-326"></span><span>
</span><span id="line-327"></span><span id="local-6989586621679990914"><span id="local-6989586621679990915"><span class="annot"><a href="Hydra.Chain.CardanoClient.html#throwOnEraMismatch"><span class="hs-identifier hs-type">throwOnEraMismatch</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">MonadThrow</span></span><span> </span><span class="annot"><a href="#local-6989586621679990915"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">EraMismatch</span></span><span> </span><span class="annot"><a href="#local-6989586621679990914"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679990915"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679990914"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>
</span><span id="line-328"></span><span id="throwOnEraMismatch"><span class="annot"><span class="annottext">throwOnEraMismatch :: Either EraMismatch a -&gt; m a
</span><a href="Hydra.Chain.CardanoClient.html#throwOnEraMismatch"><span class="hs-identifier hs-var hs-var">throwOnEraMismatch</span></a></span></span><span> </span><span id="local-6989586621679990649"><span class="annot"><span class="annottext">Either EraMismatch a
</span><a href="#local-6989586621679990649"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-329"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either EraMismatch a
</span><a href="#local-6989586621679990649"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-330"></span><span>    </span><span class="annot"><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Left</span></a></span><span> </span><span id="local-6989586621679990648"><span class="annot"><span class="annottext">EraMismatch
</span><a href="#local-6989586621679990648"><span class="hs-identifier hs-var">eraMismatch</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">QueryException -&gt; m a
forall (m :: * -&gt; *) e a. (MonadThrow m, Exception e) =&gt; e -&gt; m a
</span><span class="hs-identifier hs-var">throwIO</span></span><span> </span><span class="annot"><span class="annottext">(QueryException -&gt; m a) -&gt; QueryException -&gt; m a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">EraMismatch -&gt; QueryException
</span><a href="Hydra.Chain.CardanoClient.html#QueryEraMismatchException"><span class="hs-identifier hs-var">QueryEraMismatchException</span></a></span><span> </span><span class="annot"><span class="annottext">EraMismatch
</span><a href="#local-6989586621679990648"><span class="hs-identifier hs-var">eraMismatch</span></a></span><span>
</span><span id="line-331"></span><span>    </span><span class="annot"><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span id="local-6989586621679990647"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679990647"><span class="hs-identifier hs-var">result</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; m a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679990647"><span class="hs-identifier hs-var">result</span></a></span><span>
</span><span id="line-332"></span><span>
</span><span id="line-333"></span><span class="annot"><a href="Hydra.Chain.CardanoClient.html#localNodeConnectInfo"><span class="hs-identifier hs-type">localNodeConnectInfo</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NetworkId</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">FilePath</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">LocalNodeConnectInfo</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">CardanoMode</span></span><span>
</span><span id="line-334"></span><span id="localNodeConnectInfo"><span class="annot"><span class="annottext">localNodeConnectInfo :: NetworkId -&gt; String -&gt; LocalNodeConnectInfo CardanoMode
</span><a href="Hydra.Chain.CardanoClient.html#localNodeConnectInfo"><span class="hs-identifier hs-var hs-var">localNodeConnectInfo</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ConsensusModeParams CardanoMode
-&gt; NetworkId -&gt; String -&gt; LocalNodeConnectInfo CardanoMode
forall mode.
ConsensusModeParams mode
-&gt; NetworkId -&gt; String -&gt; LocalNodeConnectInfo mode
</span><span class="hs-identifier hs-var">LocalNodeConnectInfo</span></span><span> </span><span class="annot"><span class="annottext">ConsensusModeParams CardanoMode
</span><a href="Hydra.Chain.CardanoClient.html#cardanoModeParams"><span class="hs-identifier hs-var">cardanoModeParams</span></a></span><span>
</span><span id="line-335"></span><span>
</span><span id="line-336"></span><span class="annot"><a href="Hydra.Chain.CardanoClient.html#cardanoModeParams"><span class="hs-identifier hs-type">cardanoModeParams</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ConsensusModeParams</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">CardanoMode</span></span><span>
</span><span id="line-337"></span><span id="cardanoModeParams"><span class="annot"><span class="annottext">cardanoModeParams :: ConsensusModeParams CardanoMode
</span><a href="Hydra.Chain.CardanoClient.html#cardanoModeParams"><span class="hs-identifier hs-var hs-var">cardanoModeParams</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EpochSlots -&gt; ConsensusModeParams CardanoMode
</span><span class="hs-identifier hs-var">CardanoModeParams</span></span><span> </span><span class="annot"><span class="annottext">(EpochSlots -&gt; ConsensusModeParams CardanoMode)
-&gt; EpochSlots -&gt; ConsensusModeParams CardanoMode
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; EpochSlots
</span><span class="hs-identifier hs-var">EpochSlots</span></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621679990642"><span class="hs-identifier hs-var">defaultByronEpochSlots</span></a></span><span>
</span><span id="line-338"></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-339"></span><span>  </span><span class="hs-comment">-- NOTE(AB): extracted from Parsers in cardano-cli, this is needed to run in 'cardanoMode' which</span><span>
</span><span id="line-340"></span><span>  </span><span class="hs-comment">-- is the default for cardano-cli</span><span>
</span><span id="line-341"></span><span>  </span><span id="local-6989586621679990642"><span class="annot"><span class="annottext">defaultByronEpochSlots :: Word64
</span><a href="#local-6989586621679990642"><span class="hs-identifier hs-var hs-var">defaultByronEpochSlots</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">21600</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../file:///nix/store/dfjkypyaw967idcp0h3l5kydwc5ycvlx-ghc-8.10.7-doc/share/doc/ghc/html/libraries/base-4.14.3.0/src"><span class="hs-identifier hs-type">Word64</span></a></span><span>
</span><span id="line-342"></span></pre></body></html>